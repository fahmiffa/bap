var Qe=!1,tr=!1,Lt=[],er=-1;function Wi(r){Ui(r)}function Ui(r){Lt.includes(r)||Lt.push(r),Vi()}function Hi(r){let t=Lt.indexOf(r);t!==-1&&t>er&&Lt.splice(t,1)}function Vi(){!tr&&!Qe&&(Qe=!0,queueMicrotask(Zi))}function Zi(){Qe=!1,tr=!0;for(let r=0;r<Lt.length;r++)Lt[r](),er=r;Lt.length=0,er=-1,tr=!1}var Kt,Ut,Xt,mn,rr=!0;function Gi(r){rr=!1,r(),rr=!0}function Ki(r){Kt=r.reactive,Xt=r.release,Ut=t=>r.effect(t,{scheduler:e=>{rr?Wi(e):e()}}),mn=r.raw}function Hr(r){Ut=r}function Xi(r){let t=()=>{};return[n=>{let i=Ut(n);return r._x_effects||(r._x_effects=new Set,r._x_runEffects=()=>{r._x_effects.forEach(a=>a())}),r._x_effects.add(i),t=()=>{i!==void 0&&(r._x_effects.delete(i),Xt(i))},i},()=>{t()}]}function gn(r,t){let e=!0,n,i=Ut(()=>{let a=r();JSON.stringify(a),e?n=a:queueMicrotask(()=>{t(a,n),n=a}),e=!1});return()=>Xt(i)}var bn=[],_n=[],vn=[];function qi(r){vn.push(r)}function br(r,t){typeof t=="function"?(r._x_cleanups||(r._x_cleanups=[]),r._x_cleanups.push(t)):(t=r,_n.push(t))}function yn(r){bn.push(r)}function wn(r,t,e){r._x_attributeCleanups||(r._x_attributeCleanups={}),r._x_attributeCleanups[t]||(r._x_attributeCleanups[t]=[]),r._x_attributeCleanups[t].push(e)}function kn(r,t){r._x_attributeCleanups&&Object.entries(r._x_attributeCleanups).forEach(([e,n])=>{(t===void 0||t.includes(e))&&(n.forEach(i=>i()),delete r._x_attributeCleanups[e])})}function Yi(r){for(r._x_effects?.forEach(Hi);r._x_cleanups?.length;)r._x_cleanups.pop()()}var _r=new MutationObserver(kr),vr=!1;function yr(){_r.observe(document,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0}),vr=!0}function xn(){Ji(),_r.disconnect(),vr=!1}var re=[];function Ji(){let r=_r.takeRecords();re.push(()=>r.length>0&&kr(r));let t=re.length;queueMicrotask(()=>{if(re.length===t)for(;re.length>0;)re.shift()()})}function ut(r){if(!vr)return r();xn();let t=r();return yr(),t}var wr=!1,Me=[];function Qi(){wr=!0}function ta(){wr=!1,kr(Me),Me=[]}function kr(r){if(wr){Me=Me.concat(r);return}let t=[],e=new Set,n=new Map,i=new Map;for(let a=0;a<r.length;a++)if(!r[a].target._x_ignoreMutationObserver&&(r[a].type==="childList"&&(r[a].removedNodes.forEach(s=>{s.nodeType===1&&s._x_marker&&e.add(s)}),r[a].addedNodes.forEach(s=>{if(s.nodeType===1){if(e.has(s)){e.delete(s);return}s._x_marker||t.push(s)}})),r[a].type==="attributes")){let s=r[a].target,o=r[a].attributeName,l=r[a].oldValue,h=()=>{n.has(s)||n.set(s,[]),n.get(s).push({name:o,value:s.getAttribute(o)})},b=()=>{i.has(s)||i.set(s,[]),i.get(s).push(o)};s.hasAttribute(o)&&l===null?h():s.hasAttribute(o)?(b(),h()):b()}i.forEach((a,s)=>{kn(s,a)}),n.forEach((a,s)=>{bn.forEach(o=>o(s,a))});for(let a of e)t.some(s=>s.contains(a))||_n.forEach(s=>s(a));for(let a of t)a.isConnected&&vn.forEach(s=>s(a));t=null,e=null,n=null,i=null}function Sn(r){return de(Zt(r))}function he(r,t,e){return r._x_dataStack=[t,...Zt(e||r)],()=>{r._x_dataStack=r._x_dataStack.filter(n=>n!==t)}}function Zt(r){return r._x_dataStack?r._x_dataStack:typeof ShadowRoot=="function"&&r instanceof ShadowRoot?Zt(r.host):r.parentNode?Zt(r.parentNode):[]}function de(r){return new Proxy({objects:r},ea)}var ea={ownKeys({objects:r}){return Array.from(new Set(r.flatMap(t=>Object.keys(t))))},has({objects:r},t){return t==Symbol.unscopables?!1:r.some(e=>Object.prototype.hasOwnProperty.call(e,t)||Reflect.has(e,t))},get({objects:r},t,e){return t=="toJSON"?ra:Reflect.get(r.find(n=>Reflect.has(n,t))||{},t,e)},set({objects:r},t,e,n){const i=r.find(s=>Object.prototype.hasOwnProperty.call(s,t))||r[r.length-1],a=Object.getOwnPropertyDescriptor(i,t);return a?.set&&a?.get?a.set.call(n,e)||!0:Reflect.set(i,t,e)}};function ra(){return Reflect.ownKeys(this).reduce((t,e)=>(t[e]=Reflect.get(this,e),t),{})}function En(r){let t=n=>typeof n=="object"&&!Array.isArray(n)&&n!==null,e=(n,i="")=>{Object.entries(Object.getOwnPropertyDescriptors(n)).forEach(([a,{value:s,enumerable:o}])=>{if(o===!1||s===void 0||typeof s=="object"&&s!==null&&s.__v_skip)return;let l=i===""?a:`${i}.${a}`;typeof s=="object"&&s!==null&&s._x_interceptor?n[a]=s.initialize(r,l,a):t(s)&&s!==n&&!(s instanceof Element)&&e(s,l)})};return e(r)}function Cn(r,t=()=>{}){let e={initialValue:void 0,_x_interceptor:!0,initialize(n,i,a){return r(this.initialValue,()=>na(n,i),s=>nr(n,i,s),i,a)}};return t(e),n=>{if(typeof n=="object"&&n!==null&&n._x_interceptor){let i=e.initialize.bind(e);e.initialize=(a,s,o)=>{let l=n.initialize(a,s,o);return e.initialValue=l,i(a,s,o)}}else e.initialValue=n;return e}}function na(r,t){return t.split(".").reduce((e,n)=>e[n],r)}function nr(r,t,e){if(typeof t=="string"&&(t=t.split(".")),t.length===1)r[t[0]]=e;else{if(t.length===0)throw error;return r[t[0]]||(r[t[0]]={}),nr(r[t[0]],t.slice(1),e)}}var Pn={};function Et(r,t){Pn[r]=t}function ir(r,t){let e=ia(t);return Object.entries(Pn).forEach(([n,i])=>{Object.defineProperty(r,`$${n}`,{get(){return i(t,e)},enumerable:!1})}),r}function ia(r){let[t,e]=Rn(r),n={interceptor:Cn,...t};return br(r,e),n}function aa(r,t,e,...n){try{return e(...n)}catch(i){ue(i,r,t)}}function ue(r,t,e=void 0){r=Object.assign(r??{message:"No error message given."},{el:t,expression:e}),console.warn(`Alpine Expression Error: ${r.message}

${e?'Expression: "'+e+`"

`:""}`,t),setTimeout(()=>{throw r},0)}var Ee=!0;function An(r){let t=Ee;Ee=!1;let e=r();return Ee=t,e}function Dt(r,t,e={}){let n;return vt(r,t)(i=>n=i,e),n}function vt(...r){return Mn(...r)}var Mn=Nn;function sa(r){Mn=r}function Nn(r,t){let e={};ir(e,r);let n=[e,...Zt(r)],i=typeof t=="function"?oa(n,t):ca(n,t,r);return aa.bind(null,r,t,i)}function oa(r,t){return(e=()=>{},{scope:n={},params:i=[]}={})=>{let a=t.apply(de([n,...r]),i);Ne(e,a)}}var He={};function la(r,t){if(He[r])return He[r];let e=Object.getPrototypeOf(async function(){}).constructor,n=/^[\n\s]*if.*\(.*\)/.test(r.trim())||/^(let|const)\s/.test(r.trim())?`(async()=>{ ${r} })()`:r,a=(()=>{try{let s=new e(["__self","scope"],`with (scope) { __self.result = ${n} }; __self.finished = true; return __self.result;`);return Object.defineProperty(s,"name",{value:`[Alpine] ${r}`}),s}catch(s){return ue(s,t,r),Promise.resolve()}})();return He[r]=a,a}function ca(r,t,e){let n=la(t,e);return(i=()=>{},{scope:a={},params:s=[]}={})=>{n.result=void 0,n.finished=!1;let o=de([a,...r]);if(typeof n=="function"){let l=n(n,o).catch(h=>ue(h,e,t));n.finished?(Ne(i,n.result,o,s,e),n.result=void 0):l.then(h=>{Ne(i,h,o,s,e)}).catch(h=>ue(h,e,t)).finally(()=>n.result=void 0)}}}function Ne(r,t,e,n,i){if(Ee&&typeof t=="function"){let a=t.apply(e,n);a instanceof Promise?a.then(s=>Ne(r,s,e,n)).catch(s=>ue(s,i,t)):r(a)}else typeof t=="object"&&t instanceof Promise?t.then(a=>r(a)):r(t)}var xr="x-";function qt(r=""){return xr+r}function ua(r){xr=r}var Te={};function gt(r,t){return Te[r]=t,{before(e){if(!Te[e]){console.warn(String.raw`Cannot find directive \`${e}\`. \`${r}\` will use the default order of execution`);return}const n=Ft.indexOf(e);Ft.splice(n>=0?n:Ft.indexOf("DEFAULT"),0,r)}}}function ha(r){return Object.keys(Te).includes(r)}function Sr(r,t,e){if(t=Array.from(t),r._x_virtualDirectives){let a=Object.entries(r._x_virtualDirectives).map(([o,l])=>({name:o,value:l})),s=Tn(a);a=a.map(o=>s.find(l=>l.name===o.name)?{name:`x-bind:${o.name}`,value:`"${o.value}"`}:o),t=t.concat(a)}let n={};return t.map(In((a,s)=>n[a]=s)).filter(Ln).map(pa(n,e)).sort(ma).map(a=>fa(r,a))}function Tn(r){return Array.from(r).map(In()).filter(t=>!Ln(t))}var ar=!1,oe=new Map,On=Symbol();function da(r){ar=!0;let t=Symbol();On=t,oe.set(t,[]);let e=()=>{for(;oe.get(t).length;)oe.get(t).shift()();oe.delete(t)},n=()=>{ar=!1,e()};r(e),n()}function Rn(r){let t=[],e=o=>t.push(o),[n,i]=Xi(r);return t.push(i),[{Alpine:fe,effect:n,cleanup:e,evaluateLater:vt.bind(vt,r),evaluate:Dt.bind(Dt,r)},()=>t.forEach(o=>o())]}function fa(r,t){let e=()=>{},n=Te[t.type]||e,[i,a]=Rn(r);wn(r,t.original,a);let s=()=>{r._x_ignore||r._x_ignoreSelf||(n.inline&&n.inline(r,t,i),n=n.bind(n,r,t,i),ar?oe.get(On).push(n):n())};return s.runCleanups=a,s}var Bn=(r,t)=>({name:e,value:n})=>(e.startsWith(r)&&(e=e.replace(r,t)),{name:e,value:n}),zn=r=>r;function In(r=()=>{}){return({name:t,value:e})=>{let{name:n,value:i}=Fn.reduce((a,s)=>s(a),{name:t,value:e});return n!==t&&r(n,t),{name:n,value:i}}}var Fn=[];function Er(r){Fn.push(r)}function Ln({name:r}){return Dn().test(r)}var Dn=()=>new RegExp(`^${xr}([^:^.]+)\\b`);function pa(r,t){return({name:e,value:n})=>{let i=e.match(Dn()),a=e.match(/:([a-zA-Z0-9\-_:]+)/),s=e.match(/\.[^.\]]+(?=[^\]]*$)/g)||[],o=t||r[e]||e;return{type:i?i[1]:null,value:a?a[1]:null,modifiers:s.map(l=>l.replace(".","")),expression:n,original:o}}}var sr="DEFAULT",Ft=["ignore","ref","data","id","anchor","bind","init","for","model","modelable","transition","show","if",sr,"teleport"];function ma(r,t){let e=Ft.indexOf(r.type)===-1?sr:r.type,n=Ft.indexOf(t.type)===-1?sr:t.type;return Ft.indexOf(e)-Ft.indexOf(n)}function le(r,t,e={}){r.dispatchEvent(new CustomEvent(t,{detail:e,bubbles:!0,composed:!0,cancelable:!0}))}function Wt(r,t){if(typeof ShadowRoot=="function"&&r instanceof ShadowRoot){Array.from(r.children).forEach(i=>Wt(i,t));return}let e=!1;if(t(r,()=>e=!0),e)return;let n=r.firstElementChild;for(;n;)Wt(n,t),n=n.nextElementSibling}function kt(r,...t){console.warn(`Alpine Warning: ${r}`,...t)}var Vr=!1;function ga(){Vr&&kt("Alpine has already been initialized on this page. Calling Alpine.start() more than once can cause problems."),Vr=!0,document.body||kt("Unable to initialize. Trying to load Alpine before `<body>` is available. Did you forget to add `defer` in Alpine's `<script>` tag?"),le(document,"alpine:init"),le(document,"alpine:initializing"),yr(),qi(t=>Nt(t,Wt)),br(t=>Jt(t)),yn((t,e)=>{Sr(t,e).forEach(n=>n())});let r=t=>!Ie(t.parentElement,!0);Array.from(document.querySelectorAll(Wn().join(","))).filter(r).forEach(t=>{Nt(t)}),le(document,"alpine:initialized"),setTimeout(()=>{ya()})}var Cr=[],$n=[];function jn(){return Cr.map(r=>r())}function Wn(){return Cr.concat($n).map(r=>r())}function Un(r){Cr.push(r)}function Hn(r){$n.push(r)}function Ie(r,t=!1){return Yt(r,e=>{if((t?Wn():jn()).some(i=>e.matches(i)))return!0})}function Yt(r,t){if(r){if(t(r))return r;if(r._x_teleportBack&&(r=r._x_teleportBack),!!r.parentElement)return Yt(r.parentElement,t)}}function ba(r){return jn().some(t=>r.matches(t))}var Vn=[];function _a(r){Vn.push(r)}var va=1;function Nt(r,t=Wt,e=()=>{}){Yt(r,n=>n._x_ignore)||da(()=>{t(r,(n,i)=>{n._x_marker||(e(n,i),Vn.forEach(a=>a(n,i)),Sr(n,n.attributes).forEach(a=>a()),n._x_ignore||(n._x_marker=va++),n._x_ignore&&i())})})}function Jt(r,t=Wt){t(r,e=>{Yi(e),kn(e),delete e._x_marker})}function ya(){[["ui","dialog",["[x-dialog], [x-popover]"]],["anchor","anchor",["[x-anchor]"]],["sort","sort",["[x-sort]"]]].forEach(([t,e,n])=>{ha(e)||n.some(i=>{if(document.querySelector(i))return kt(`found "${i}", but missing ${t} plugin`),!0})})}var or=[],Pr=!1;function Ar(r=()=>{}){return queueMicrotask(()=>{Pr||setTimeout(()=>{lr()})}),new Promise(t=>{or.push(()=>{r(),t()})})}function lr(){for(Pr=!1;or.length;)or.shift()()}function wa(){Pr=!0}function Mr(r,t){return Array.isArray(t)?Zr(r,t.join(" ")):typeof t=="object"&&t!==null?ka(r,t):typeof t=="function"?Mr(r,t()):Zr(r,t)}function Zr(r,t){let e=i=>i.split(" ").filter(a=>!r.classList.contains(a)).filter(Boolean),n=i=>(r.classList.add(...i),()=>{r.classList.remove(...i)});return t=t===!0?t="":t||"",n(e(t))}function ka(r,t){let e=o=>o.split(" ").filter(Boolean),n=Object.entries(t).flatMap(([o,l])=>l?e(o):!1).filter(Boolean),i=Object.entries(t).flatMap(([o,l])=>l?!1:e(o)).filter(Boolean),a=[],s=[];return i.forEach(o=>{r.classList.contains(o)&&(r.classList.remove(o),s.push(o))}),n.forEach(o=>{r.classList.contains(o)||(r.classList.add(o),a.push(o))}),()=>{s.forEach(o=>r.classList.add(o)),a.forEach(o=>r.classList.remove(o))}}function Fe(r,t){return typeof t=="object"&&t!==null?xa(r,t):Sa(r,t)}function xa(r,t){let e={};return Object.entries(t).forEach(([n,i])=>{e[n]=r.style[n],n.startsWith("--")||(n=Ea(n)),r.style.setProperty(n,i)}),setTimeout(()=>{r.style.length===0&&r.removeAttribute("style")}),()=>{Fe(r,e)}}function Sa(r,t){let e=r.getAttribute("style",t);return r.setAttribute("style",t),()=>{r.setAttribute("style",e||"")}}function Ea(r){return r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function cr(r,t=()=>{}){let e=!1;return function(){e?t.apply(this,arguments):(e=!0,r.apply(this,arguments))}}gt("transition",(r,{value:t,modifiers:e,expression:n},{evaluate:i})=>{typeof n=="function"&&(n=i(n)),n!==!1&&(!n||typeof n=="boolean"?Pa(r,e,t):Ca(r,n,t))});function Ca(r,t,e){Zn(r,Mr,""),{enter:i=>{r._x_transition.enter.during=i},"enter-start":i=>{r._x_transition.enter.start=i},"enter-end":i=>{r._x_transition.enter.end=i},leave:i=>{r._x_transition.leave.during=i},"leave-start":i=>{r._x_transition.leave.start=i},"leave-end":i=>{r._x_transition.leave.end=i}}[e](t)}function Pa(r,t,e){Zn(r,Fe);let n=!t.includes("in")&&!t.includes("out")&&!e,i=n||t.includes("in")||["enter"].includes(e),a=n||t.includes("out")||["leave"].includes(e);t.includes("in")&&!n&&(t=t.filter((m,y)=>y<t.indexOf("out"))),t.includes("out")&&!n&&(t=t.filter((m,y)=>y>t.indexOf("out")));let s=!t.includes("opacity")&&!t.includes("scale"),o=s||t.includes("opacity"),l=s||t.includes("scale"),h=o?0:1,b=l?ne(t,"scale",95)/100:1,g=ne(t,"delay",0)/1e3,v=ne(t,"origin","center"),d="opacity, transform",w=ne(t,"duration",150)/1e3,f=ne(t,"duration",75)/1e3,p="cubic-bezier(0.4, 0.0, 0.2, 1)";i&&(r._x_transition.enter.during={transformOrigin:v,transitionDelay:`${g}s`,transitionProperty:d,transitionDuration:`${w}s`,transitionTimingFunction:p},r._x_transition.enter.start={opacity:h,transform:`scale(${b})`},r._x_transition.enter.end={opacity:1,transform:"scale(1)"}),a&&(r._x_transition.leave.during={transformOrigin:v,transitionDelay:`${g}s`,transitionProperty:d,transitionDuration:`${f}s`,transitionTimingFunction:p},r._x_transition.leave.start={opacity:1,transform:"scale(1)"},r._x_transition.leave.end={opacity:h,transform:`scale(${b})`})}function Zn(r,t,e={}){r._x_transition||(r._x_transition={enter:{during:e,start:e,end:e},leave:{during:e,start:e,end:e},in(n=()=>{},i=()=>{}){ur(r,t,{during:this.enter.during,start:this.enter.start,end:this.enter.end},n,i)},out(n=()=>{},i=()=>{}){ur(r,t,{during:this.leave.during,start:this.leave.start,end:this.leave.end},n,i)}})}window.Element.prototype._x_toggleAndCascadeWithTransitions=function(r,t,e,n){const i=document.visibilityState==="visible"?requestAnimationFrame:setTimeout;let a=()=>i(e);if(t){r._x_transition&&(r._x_transition.enter||r._x_transition.leave)?r._x_transition.enter&&(Object.entries(r._x_transition.enter.during).length||Object.entries(r._x_transition.enter.start).length||Object.entries(r._x_transition.enter.end).length)?r._x_transition.in(e):a():r._x_transition?r._x_transition.in(e):a();return}r._x_hidePromise=r._x_transition?new Promise((s,o)=>{r._x_transition.out(()=>{},()=>s(n)),r._x_transitioning&&r._x_transitioning.beforeCancel(()=>o({isFromCancelledTransition:!0}))}):Promise.resolve(n),queueMicrotask(()=>{let s=Gn(r);s?(s._x_hideChildren||(s._x_hideChildren=[]),s._x_hideChildren.push(r)):i(()=>{let o=l=>{let h=Promise.all([l._x_hidePromise,...(l._x_hideChildren||[]).map(o)]).then(([b])=>b?.());return delete l._x_hidePromise,delete l._x_hideChildren,h};o(r).catch(l=>{if(!l.isFromCancelledTransition)throw l})})})};function Gn(r){let t=r.parentNode;if(t)return t._x_hidePromise?t:Gn(t)}function ur(r,t,{during:e,start:n,end:i}={},a=()=>{},s=()=>{}){if(r._x_transitioning&&r._x_transitioning.cancel(),Object.keys(e).length===0&&Object.keys(n).length===0&&Object.keys(i).length===0){a(),s();return}let o,l,h;Aa(r,{start(){o=t(r,n)},during(){l=t(r,e)},before:a,end(){o(),h=t(r,i)},after:s,cleanup(){l(),h()}})}function Aa(r,t){let e,n,i,a=cr(()=>{ut(()=>{e=!0,n||t.before(),i||(t.end(),lr()),t.after(),r.isConnected&&t.cleanup(),delete r._x_transitioning})});r._x_transitioning={beforeCancels:[],beforeCancel(s){this.beforeCancels.push(s)},cancel:cr(function(){for(;this.beforeCancels.length;)this.beforeCancels.shift()();a()}),finish:a},ut(()=>{t.start(),t.during()}),wa(),requestAnimationFrame(()=>{if(e)return;let s=Number(getComputedStyle(r).transitionDuration.replace(/,.*/,"").replace("s",""))*1e3,o=Number(getComputedStyle(r).transitionDelay.replace(/,.*/,"").replace("s",""))*1e3;s===0&&(s=Number(getComputedStyle(r).animationDuration.replace("s",""))*1e3),ut(()=>{t.before()}),n=!0,requestAnimationFrame(()=>{e||(ut(()=>{t.end()}),lr(),setTimeout(r._x_transitioning.finish,s+o),i=!0)})})}function ne(r,t,e){if(r.indexOf(t)===-1)return e;const n=r[r.indexOf(t)+1];if(!n||t==="scale"&&isNaN(n))return e;if(t==="duration"||t==="delay"){let i=n.match(/([0-9]+)ms/);if(i)return i[1]}return t==="origin"&&["top","right","left","center","bottom"].includes(r[r.indexOf(t)+2])?[n,r[r.indexOf(t)+2]].join(" "):n}var Rt=!1;function zt(r,t=()=>{}){return(...e)=>Rt?t(...e):r(...e)}function Ma(r){return(...t)=>Rt&&r(...t)}var Kn=[];function Le(r){Kn.push(r)}function Na(r,t){Kn.forEach(e=>e(r,t)),Rt=!0,Xn(()=>{Nt(t,(e,n)=>{n(e,()=>{})})}),Rt=!1}var hr=!1;function Ta(r,t){t._x_dataStack||(t._x_dataStack=r._x_dataStack),Rt=!0,hr=!0,Xn(()=>{Oa(t)}),Rt=!1,hr=!1}function Oa(r){let t=!1;Nt(r,(n,i)=>{Wt(n,(a,s)=>{if(t&&ba(a))return s();t=!0,i(a,s)})})}function Xn(r){let t=Ut;Hr((e,n)=>{let i=t(e);return Xt(i),()=>{}}),r(),Hr(t)}function qn(r,t,e,n=[]){switch(r._x_bindings||(r._x_bindings=Kt({})),r._x_bindings[t]=e,t=n.includes("camel")?$a(t):t,t){case"value":Ra(r,e);break;case"style":za(r,e);break;case"class":Ba(r,e);break;case"selected":case"checked":Ia(r,t,e);break;default:Yn(r,t,e);break}}function Ra(r,t){if(ti(r))r.attributes.value===void 0&&(r.value=t),window.fromModel&&(typeof t=="boolean"?r.checked=Ce(r.value)===t:r.checked=Gr(r.value,t));else if(Nr(r))Number.isInteger(t)?r.value=t:!Array.isArray(t)&&typeof t!="boolean"&&![null,void 0].includes(t)?r.value=String(t):Array.isArray(t)?r.checked=t.some(e=>Gr(e,r.value)):r.checked=!!t;else if(r.tagName==="SELECT")Da(r,t);else{if(r.value===t)return;r.value=t===void 0?"":t}}function Ba(r,t){r._x_undoAddedClasses&&r._x_undoAddedClasses(),r._x_undoAddedClasses=Mr(r,t)}function za(r,t){r._x_undoAddedStyles&&r._x_undoAddedStyles(),r._x_undoAddedStyles=Fe(r,t)}function Ia(r,t,e){Yn(r,t,e),La(r,t,e)}function Yn(r,t,e){[null,void 0,!1].includes(e)&&Wa(t)?r.removeAttribute(t):(Jn(t)&&(e=t),Fa(r,t,e))}function Fa(r,t,e){r.getAttribute(t)!=e&&r.setAttribute(t,e)}function La(r,t,e){r[t]!==e&&(r[t]=e)}function Da(r,t){const e=[].concat(t).map(n=>n+"");Array.from(r.options).forEach(n=>{n.selected=e.includes(n.value)})}function $a(r){return r.toLowerCase().replace(/-(\w)/g,(t,e)=>e.toUpperCase())}function Gr(r,t){return r==t}function Ce(r){return[1,"1","true","on","yes",!0].includes(r)?!0:[0,"0","false","off","no",!1].includes(r)?!1:r?!!r:null}var ja=new Set(["allowfullscreen","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","inert","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected","shadowrootclonable","shadowrootdelegatesfocus","shadowrootserializable"]);function Jn(r){return ja.has(r)}function Wa(r){return!["aria-pressed","aria-checked","aria-expanded","aria-selected"].includes(r)}function Ua(r,t,e){return r._x_bindings&&r._x_bindings[t]!==void 0?r._x_bindings[t]:Qn(r,t,e)}function Ha(r,t,e,n=!0){if(r._x_bindings&&r._x_bindings[t]!==void 0)return r._x_bindings[t];if(r._x_inlineBindings&&r._x_inlineBindings[t]!==void 0){let i=r._x_inlineBindings[t];return i.extract=n,An(()=>Dt(r,i.expression))}return Qn(r,t,e)}function Qn(r,t,e){let n=r.getAttribute(t);return n===null?typeof e=="function"?e():e:n===""?!0:Jn(t)?!![t,"true"].includes(n):n}function Nr(r){return r.type==="checkbox"||r.localName==="ui-checkbox"||r.localName==="ui-switch"}function ti(r){return r.type==="radio"||r.localName==="ui-radio"}function ei(r,t){var e;return function(){var n=this,i=arguments,a=function(){e=null,r.apply(n,i)};clearTimeout(e),e=setTimeout(a,t)}}function ri(r,t){let e;return function(){let n=this,i=arguments;e||(r.apply(n,i),e=!0,setTimeout(()=>e=!1,t))}}function ni({get:r,set:t},{get:e,set:n}){let i=!0,a,s=Ut(()=>{let o=r(),l=e();if(i)n(Ve(o)),i=!1;else{let h=JSON.stringify(o),b=JSON.stringify(l);h!==a?n(Ve(o)):h!==b&&t(Ve(l))}a=JSON.stringify(r()),JSON.stringify(e())});return()=>{Xt(s)}}function Ve(r){return typeof r=="object"?JSON.parse(JSON.stringify(r)):r}function Va(r){(Array.isArray(r)?r:[r]).forEach(e=>e(fe))}var It={},Kr=!1;function Za(r,t){if(Kr||(It=Kt(It),Kr=!0),t===void 0)return It[r];It[r]=t,En(It[r]),typeof t=="object"&&t!==null&&t.hasOwnProperty("init")&&typeof t.init=="function"&&It[r].init()}function Ga(){return It}var ii={};function Ka(r,t){let e=typeof t!="function"?()=>t:t;return r instanceof Element?ai(r,e()):(ii[r]=e,()=>{})}function Xa(r){return Object.entries(ii).forEach(([t,e])=>{Object.defineProperty(r,t,{get(){return(...n)=>e(...n)}})}),r}function ai(r,t,e){let n=[];for(;n.length;)n.pop()();let i=Object.entries(t).map(([s,o])=>({name:s,value:o})),a=Tn(i);return i=i.map(s=>a.find(o=>o.name===s.name)?{name:`x-bind:${s.name}`,value:`"${s.value}"`}:s),Sr(r,i,e).map(s=>{n.push(s.runCleanups),s()}),()=>{for(;n.length;)n.pop()()}}var si={};function qa(r,t){si[r]=t}function Ya(r,t){return Object.entries(si).forEach(([e,n])=>{Object.defineProperty(r,e,{get(){return(...i)=>n.bind(t)(...i)},enumerable:!1})}),r}var Ja={get reactive(){return Kt},get release(){return Xt},get effect(){return Ut},get raw(){return mn},version:"3.14.9",flushAndStopDeferringMutations:ta,dontAutoEvaluateFunctions:An,disableEffectScheduling:Gi,startObservingMutations:yr,stopObservingMutations:xn,setReactivityEngine:Ki,onAttributeRemoved:wn,onAttributesAdded:yn,closestDataStack:Zt,skipDuringClone:zt,onlyDuringClone:Ma,addRootSelector:Un,addInitSelector:Hn,interceptClone:Le,addScopeToNode:he,deferMutations:Qi,mapAttributes:Er,evaluateLater:vt,interceptInit:_a,setEvaluator:sa,mergeProxies:de,extractProp:Ha,findClosest:Yt,onElRemoved:br,closestRoot:Ie,destroyTree:Jt,interceptor:Cn,transition:ur,setStyles:Fe,mutateDom:ut,directive:gt,entangle:ni,throttle:ri,debounce:ei,evaluate:Dt,initTree:Nt,nextTick:Ar,prefixed:qt,prefix:ua,plugin:Va,magic:Et,store:Za,start:ga,clone:Ta,cloneNode:Na,bound:Ua,$data:Sn,watch:gn,walk:Wt,data:qa,bind:Ka},fe=Ja;function Qa(r,t){const e=Object.create(null),n=r.split(",");for(let i=0;i<n.length;i++)e[n[i]]=!0;return i=>!!e[i]}var ts=Object.freeze({}),es=Object.prototype.hasOwnProperty,De=(r,t)=>es.call(r,t),$t=Array.isArray,ce=r=>oi(r)==="[object Map]",rs=r=>typeof r=="string",Tr=r=>typeof r=="symbol",$e=r=>r!==null&&typeof r=="object",ns=Object.prototype.toString,oi=r=>ns.call(r),li=r=>oi(r).slice(8,-1),Or=r=>rs(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,is=r=>{const t=Object.create(null);return e=>t[e]||(t[e]=r(e))},as=is(r=>r.charAt(0).toUpperCase()+r.slice(1)),ci=(r,t)=>r!==t&&(r===r||t===t),dr=new WeakMap,ie=[],At,jt=Symbol("iterate"),fr=Symbol("Map key iterate");function ss(r){return r&&r._isEffect===!0}function os(r,t=ts){ss(r)&&(r=r.raw);const e=us(r,t);return t.lazy||e(),e}function ls(r){r.active&&(ui(r),r.options.onStop&&r.options.onStop(),r.active=!1)}var cs=0;function us(r,t){const e=function(){if(!e.active)return r();if(!ie.includes(e)){ui(e);try{return ds(),ie.push(e),At=e,r()}finally{ie.pop(),hi(),At=ie[ie.length-1]}}};return e.id=cs++,e.allowRecurse=!!t.allowRecurse,e._isEffect=!0,e.active=!0,e.raw=r,e.deps=[],e.options=t,e}function ui(r){const{deps:t}=r;if(t.length){for(let e=0;e<t.length;e++)t[e].delete(r);t.length=0}}var Gt=!0,Rr=[];function hs(){Rr.push(Gt),Gt=!1}function ds(){Rr.push(Gt),Gt=!0}function hi(){const r=Rr.pop();Gt=r===void 0?!0:r}function St(r,t,e){if(!Gt||At===void 0)return;let n=dr.get(r);n||dr.set(r,n=new Map);let i=n.get(e);i||n.set(e,i=new Set),i.has(At)||(i.add(At),At.deps.push(i),At.options.onTrack&&At.options.onTrack({effect:At,target:r,type:t,key:e}))}function Bt(r,t,e,n,i,a){const s=dr.get(r);if(!s)return;const o=new Set,l=b=>{b&&b.forEach(g=>{(g!==At||g.allowRecurse)&&o.add(g)})};if(t==="clear")s.forEach(l);else if(e==="length"&&$t(r))s.forEach((b,g)=>{(g==="length"||g>=n)&&l(b)});else switch(e!==void 0&&l(s.get(e)),t){case"add":$t(r)?Or(e)&&l(s.get("length")):(l(s.get(jt)),ce(r)&&l(s.get(fr)));break;case"delete":$t(r)||(l(s.get(jt)),ce(r)&&l(s.get(fr)));break;case"set":ce(r)&&l(s.get(jt));break}const h=b=>{b.options.onTrigger&&b.options.onTrigger({effect:b,target:r,key:e,type:t,newValue:n,oldValue:i,oldTarget:a}),b.options.scheduler?b.options.scheduler(b):b()};o.forEach(h)}var fs=Qa("__proto__,__v_isRef,__isVue"),di=new Set(Object.getOwnPropertyNames(Symbol).map(r=>Symbol[r]).filter(Tr)),ps=fi(),ms=fi(!0),Xr=gs();function gs(){const r={};return["includes","indexOf","lastIndexOf"].forEach(t=>{r[t]=function(...e){const n=ct(this);for(let a=0,s=this.length;a<s;a++)St(n,"get",a+"");const i=n[t](...e);return i===-1||i===!1?n[t](...e.map(ct)):i}}),["push","pop","shift","unshift","splice"].forEach(t=>{r[t]=function(...e){hs();const n=ct(this)[t].apply(this,e);return hi(),n}}),r}function fi(r=!1,t=!1){return function(n,i,a){if(i==="__v_isReactive")return!r;if(i==="__v_isReadonly")return r;if(i==="__v_raw"&&a===(r?t?Ns:bi:t?Ms:gi).get(n))return n;const s=$t(n);if(!r&&s&&De(Xr,i))return Reflect.get(Xr,i,a);const o=Reflect.get(n,i,a);return(Tr(i)?di.has(i):fs(i))||(r||St(n,"get",i),t)?o:pr(o)?!s||!Or(i)?o.value:o:$e(o)?r?_i(o):Fr(o):o}}var bs=_s();function _s(r=!1){return function(e,n,i,a){let s=e[n];if(!r&&(i=ct(i),s=ct(s),!$t(e)&&pr(s)&&!pr(i)))return s.value=i,!0;const o=$t(e)&&Or(n)?Number(n)<e.length:De(e,n),l=Reflect.set(e,n,i,a);return e===ct(a)&&(o?ci(i,s)&&Bt(e,"set",n,i,s):Bt(e,"add",n,i)),l}}function vs(r,t){const e=De(r,t),n=r[t],i=Reflect.deleteProperty(r,t);return i&&e&&Bt(r,"delete",t,void 0,n),i}function ys(r,t){const e=Reflect.has(r,t);return(!Tr(t)||!di.has(t))&&St(r,"has",t),e}function ws(r){return St(r,"iterate",$t(r)?"length":jt),Reflect.ownKeys(r)}var ks={get:ps,set:bs,deleteProperty:vs,has:ys,ownKeys:ws},xs={get:ms,set(r,t){return console.warn(`Set operation on key "${String(t)}" failed: target is readonly.`,r),!0},deleteProperty(r,t){return console.warn(`Delete operation on key "${String(t)}" failed: target is readonly.`,r),!0}},Br=r=>$e(r)?Fr(r):r,zr=r=>$e(r)?_i(r):r,Ir=r=>r,je=r=>Reflect.getPrototypeOf(r);function be(r,t,e=!1,n=!1){r=r.__v_raw;const i=ct(r),a=ct(t);t!==a&&!e&&St(i,"get",t),!e&&St(i,"get",a);const{has:s}=je(i),o=n?Ir:e?zr:Br;if(s.call(i,t))return o(r.get(t));if(s.call(i,a))return o(r.get(a));r!==i&&r.get(t)}function _e(r,t=!1){const e=this.__v_raw,n=ct(e),i=ct(r);return r!==i&&!t&&St(n,"has",r),!t&&St(n,"has",i),r===i?e.has(r):e.has(r)||e.has(i)}function ve(r,t=!1){return r=r.__v_raw,!t&&St(ct(r),"iterate",jt),Reflect.get(r,"size",r)}function qr(r){r=ct(r);const t=ct(this);return je(t).has.call(t,r)||(t.add(r),Bt(t,"add",r,r)),this}function Yr(r,t){t=ct(t);const e=ct(this),{has:n,get:i}=je(e);let a=n.call(e,r);a?mi(e,n,r):(r=ct(r),a=n.call(e,r));const s=i.call(e,r);return e.set(r,t),a?ci(t,s)&&Bt(e,"set",r,t,s):Bt(e,"add",r,t),this}function Jr(r){const t=ct(this),{has:e,get:n}=je(t);let i=e.call(t,r);i?mi(t,e,r):(r=ct(r),i=e.call(t,r));const a=n?n.call(t,r):void 0,s=t.delete(r);return i&&Bt(t,"delete",r,void 0,a),s}function Qr(){const r=ct(this),t=r.size!==0,e=ce(r)?new Map(r):new Set(r),n=r.clear();return t&&Bt(r,"clear",void 0,void 0,e),n}function ye(r,t){return function(n,i){const a=this,s=a.__v_raw,o=ct(s),l=t?Ir:r?zr:Br;return!r&&St(o,"iterate",jt),s.forEach((h,b)=>n.call(i,l(h),l(b),a))}}function we(r,t,e){return function(...n){const i=this.__v_raw,a=ct(i),s=ce(a),o=r==="entries"||r===Symbol.iterator&&s,l=r==="keys"&&s,h=i[r](...n),b=e?Ir:t?zr:Br;return!t&&St(a,"iterate",l?fr:jt),{next(){const{value:g,done:v}=h.next();return v?{value:g,done:v}:{value:o?[b(g[0]),b(g[1])]:b(g),done:v}},[Symbol.iterator](){return this}}}}function Tt(r){return function(...t){{const e=t[0]?`on key "${t[0]}" `:"";console.warn(`${as(r)} operation ${e}failed: target is readonly.`,ct(this))}return r==="delete"?!1:this}}function Ss(){const r={get(a){return be(this,a)},get size(){return ve(this)},has:_e,add:qr,set:Yr,delete:Jr,clear:Qr,forEach:ye(!1,!1)},t={get(a){return be(this,a,!1,!0)},get size(){return ve(this)},has:_e,add:qr,set:Yr,delete:Jr,clear:Qr,forEach:ye(!1,!0)},e={get(a){return be(this,a,!0)},get size(){return ve(this,!0)},has(a){return _e.call(this,a,!0)},add:Tt("add"),set:Tt("set"),delete:Tt("delete"),clear:Tt("clear"),forEach:ye(!0,!1)},n={get(a){return be(this,a,!0,!0)},get size(){return ve(this,!0)},has(a){return _e.call(this,a,!0)},add:Tt("add"),set:Tt("set"),delete:Tt("delete"),clear:Tt("clear"),forEach:ye(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(a=>{r[a]=we(a,!1,!1),e[a]=we(a,!0,!1),t[a]=we(a,!1,!0),n[a]=we(a,!0,!0)}),[r,e,t,n]}var[Es,Cs,Ml,Nl]=Ss();function pi(r,t){const e=r?Cs:Es;return(n,i,a)=>i==="__v_isReactive"?!r:i==="__v_isReadonly"?r:i==="__v_raw"?n:Reflect.get(De(e,i)&&i in n?e:n,i,a)}var Ps={get:pi(!1)},As={get:pi(!0)};function mi(r,t,e){const n=ct(e);if(n!==e&&t.call(r,n)){const i=li(r);console.warn(`Reactive ${i} contains both the raw and reactive versions of the same object${i==="Map"?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}var gi=new WeakMap,Ms=new WeakMap,bi=new WeakMap,Ns=new WeakMap;function Ts(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Os(r){return r.__v_skip||!Object.isExtensible(r)?0:Ts(li(r))}function Fr(r){return r&&r.__v_isReadonly?r:vi(r,!1,ks,Ps,gi)}function _i(r){return vi(r,!0,xs,As,bi)}function vi(r,t,e,n,i){if(!$e(r))return console.warn(`value cannot be made reactive: ${String(r)}`),r;if(r.__v_raw&&!(t&&r.__v_isReactive))return r;const a=i.get(r);if(a)return a;const s=Os(r);if(s===0)return r;const o=new Proxy(r,s===2?n:e);return i.set(r,o),o}function ct(r){return r&&ct(r.__v_raw)||r}function pr(r){return!!(r&&r.__v_isRef===!0)}Et("nextTick",()=>Ar);Et("dispatch",r=>le.bind(le,r));Et("watch",(r,{evaluateLater:t,cleanup:e})=>(n,i)=>{let a=t(n),o=gn(()=>{let l;return a(h=>l=h),l},i);e(o)});Et("store",Ga);Et("data",r=>Sn(r));Et("root",r=>Ie(r));Et("refs",r=>(r._x_refs_proxy||(r._x_refs_proxy=de(Rs(r))),r._x_refs_proxy));function Rs(r){let t=[];return Yt(r,e=>{e._x_refs&&t.push(e._x_refs)}),t}var Ze={};function yi(r){return Ze[r]||(Ze[r]=0),++Ze[r]}function Bs(r,t){return Yt(r,e=>{if(e._x_ids&&e._x_ids[t])return!0})}function zs(r,t){r._x_ids||(r._x_ids={}),r._x_ids[t]||(r._x_ids[t]=yi(t))}Et("id",(r,{cleanup:t})=>(e,n=null)=>{let i=`${e}${n?`-${n}`:""}`;return Is(r,i,t,()=>{let a=Bs(r,e),s=a?a._x_ids[e]:yi(e);return n?`${e}-${s}-${n}`:`${e}-${s}`})});Le((r,t)=>{r._x_id&&(t._x_id=r._x_id)});function Is(r,t,e,n){if(r._x_id||(r._x_id={}),r._x_id[t])return r._x_id[t];let i=n();return r._x_id[t]=i,e(()=>{delete r._x_id[t]}),i}Et("el",r=>r);wi("Focus","focus","focus");wi("Persist","persist","persist");function wi(r,t,e){Et(t,n=>kt(`You can't use [$${t}] without first installing the "${r}" plugin here: https://alpinejs.dev/plugins/${e}`,n))}gt("modelable",(r,{expression:t},{effect:e,evaluateLater:n,cleanup:i})=>{let a=n(t),s=()=>{let b;return a(g=>b=g),b},o=n(`${t} = __placeholder`),l=b=>o(()=>{},{scope:{__placeholder:b}}),h=s();l(h),queueMicrotask(()=>{if(!r._x_model)return;r._x_removeModelListeners.default();let b=r._x_model.get,g=r._x_model.set,v=ni({get(){return b()},set(d){g(d)}},{get(){return s()},set(d){l(d)}});i(v)})});gt("teleport",(r,{modifiers:t,expression:e},{cleanup:n})=>{r.tagName.toLowerCase()!=="template"&&kt("x-teleport can only be used on a <template> tag",r);let i=tn(e),a=r.content.cloneNode(!0).firstElementChild;r._x_teleport=a,a._x_teleportBack=r,r.setAttribute("data-teleport-template",!0),a.setAttribute("data-teleport-target",!0),r._x_forwardEvents&&r._x_forwardEvents.forEach(o=>{a.addEventListener(o,l=>{l.stopPropagation(),r.dispatchEvent(new l.constructor(l.type,l))})}),he(a,{},r);let s=(o,l,h)=>{h.includes("prepend")?l.parentNode.insertBefore(o,l):h.includes("append")?l.parentNode.insertBefore(o,l.nextSibling):l.appendChild(o)};ut(()=>{s(a,i,t),zt(()=>{Nt(a)})()}),r._x_teleportPutBack=()=>{let o=tn(e);ut(()=>{s(r._x_teleport,o,t)})},n(()=>ut(()=>{a.remove(),Jt(a)}))});var Fs=document.createElement("div");function tn(r){let t=zt(()=>document.querySelector(r),()=>Fs)();return t||kt(`Cannot find x-teleport element for selector: "${r}"`),t}var ki=()=>{};ki.inline=(r,{modifiers:t},{cleanup:e})=>{t.includes("self")?r._x_ignoreSelf=!0:r._x_ignore=!0,e(()=>{t.includes("self")?delete r._x_ignoreSelf:delete r._x_ignore})};gt("ignore",ki);gt("effect",zt((r,{expression:t},{effect:e})=>{e(vt(r,t))}));function mr(r,t,e,n){let i=r,a=l=>n(l),s={},o=(l,h)=>b=>h(l,b);if(e.includes("dot")&&(t=Ls(t)),e.includes("camel")&&(t=Ds(t)),e.includes("passive")&&(s.passive=!0),e.includes("capture")&&(s.capture=!0),e.includes("window")&&(i=window),e.includes("document")&&(i=document),e.includes("debounce")){let l=e[e.indexOf("debounce")+1]||"invalid-wait",h=Oe(l.split("ms")[0])?Number(l.split("ms")[0]):250;a=ei(a,h)}if(e.includes("throttle")){let l=e[e.indexOf("throttle")+1]||"invalid-wait",h=Oe(l.split("ms")[0])?Number(l.split("ms")[0]):250;a=ri(a,h)}return e.includes("prevent")&&(a=o(a,(l,h)=>{h.preventDefault(),l(h)})),e.includes("stop")&&(a=o(a,(l,h)=>{h.stopPropagation(),l(h)})),e.includes("once")&&(a=o(a,(l,h)=>{l(h),i.removeEventListener(t,a,s)})),(e.includes("away")||e.includes("outside"))&&(i=document,a=o(a,(l,h)=>{r.contains(h.target)||h.target.isConnected!==!1&&(r.offsetWidth<1&&r.offsetHeight<1||r._x_isShown!==!1&&l(h))})),e.includes("self")&&(a=o(a,(l,h)=>{h.target===r&&l(h)})),(js(t)||xi(t))&&(a=o(a,(l,h)=>{Ws(h,e)||l(h)})),i.addEventListener(t,a,s),()=>{i.removeEventListener(t,a,s)}}function Ls(r){return r.replace(/-/g,".")}function Ds(r){return r.toLowerCase().replace(/-(\w)/g,(t,e)=>e.toUpperCase())}function Oe(r){return!Array.isArray(r)&&!isNaN(r)}function $s(r){return[" ","_"].includes(r)?r:r.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[_\s]/,"-").toLowerCase()}function js(r){return["keydown","keyup"].includes(r)}function xi(r){return["contextmenu","click","mouse"].some(t=>r.includes(t))}function Ws(r,t){let e=t.filter(a=>!["window","document","prevent","stop","once","capture","self","away","outside","passive"].includes(a));if(e.includes("debounce")){let a=e.indexOf("debounce");e.splice(a,Oe((e[a+1]||"invalid-wait").split("ms")[0])?2:1)}if(e.includes("throttle")){let a=e.indexOf("throttle");e.splice(a,Oe((e[a+1]||"invalid-wait").split("ms")[0])?2:1)}if(e.length===0||e.length===1&&en(r.key).includes(e[0]))return!1;const i=["ctrl","shift","alt","meta","cmd","super"].filter(a=>e.includes(a));return e=e.filter(a=>!i.includes(a)),!(i.length>0&&i.filter(s=>((s==="cmd"||s==="super")&&(s="meta"),r[`${s}Key`])).length===i.length&&(xi(r.type)||en(r.key).includes(e[0])))}function en(r){if(!r)return[];r=$s(r);let t={ctrl:"control",slash:"/",space:" ",spacebar:" ",cmd:"meta",esc:"escape",up:"arrow-up",down:"arrow-down",left:"arrow-left",right:"arrow-right",period:".",comma:",",equal:"=",minus:"-",underscore:"_"};return t[r]=r,Object.keys(t).map(e=>{if(t[e]===r)return e}).filter(e=>e)}gt("model",(r,{modifiers:t,expression:e},{effect:n,cleanup:i})=>{let a=r;t.includes("parent")&&(a=r.parentNode);let s=vt(a,e),o;typeof e=="string"?o=vt(a,`${e} = __placeholder`):typeof e=="function"&&typeof e()=="string"?o=vt(a,`${e()} = __placeholder`):o=()=>{};let l=()=>{let v;return s(d=>v=d),rn(v)?v.get():v},h=v=>{let d;s(w=>d=w),rn(d)?d.set(v):o(()=>{},{scope:{__placeholder:v}})};typeof e=="string"&&r.type==="radio"&&ut(()=>{r.hasAttribute("name")||r.setAttribute("name",e)});var b=r.tagName.toLowerCase()==="select"||["checkbox","radio"].includes(r.type)||t.includes("lazy")?"change":"input";let g=Rt?()=>{}:mr(r,b,t,v=>{h(Ge(r,t,v,l()))});if(t.includes("fill")&&([void 0,null,""].includes(l())||Nr(r)&&Array.isArray(l())||r.tagName.toLowerCase()==="select"&&r.multiple)&&h(Ge(r,t,{target:r},l())),r._x_removeModelListeners||(r._x_removeModelListeners={}),r._x_removeModelListeners.default=g,i(()=>r._x_removeModelListeners.default()),r.form){let v=mr(r.form,"reset",[],d=>{Ar(()=>r._x_model&&r._x_model.set(Ge(r,t,{target:r},l())))});i(()=>v())}r._x_model={get(){return l()},set(v){h(v)}},r._x_forceModelUpdate=v=>{v===void 0&&typeof e=="string"&&e.match(/\./)&&(v=""),window.fromModel=!0,ut(()=>qn(r,"value",v)),delete window.fromModel},n(()=>{let v=l();t.includes("unintrusive")&&document.activeElement.isSameNode(r)||r._x_forceModelUpdate(v)})});function Ge(r,t,e,n){return ut(()=>{if(e instanceof CustomEvent&&e.detail!==void 0)return e.detail!==null&&e.detail!==void 0?e.detail:e.target.value;if(Nr(r))if(Array.isArray(n)){let i=null;return t.includes("number")?i=Ke(e.target.value):t.includes("boolean")?i=Ce(e.target.value):i=e.target.value,e.target.checked?n.includes(i)?n:n.concat([i]):n.filter(a=>!Us(a,i))}else return e.target.checked;else{if(r.tagName.toLowerCase()==="select"&&r.multiple)return t.includes("number")?Array.from(e.target.selectedOptions).map(i=>{let a=i.value||i.text;return Ke(a)}):t.includes("boolean")?Array.from(e.target.selectedOptions).map(i=>{let a=i.value||i.text;return Ce(a)}):Array.from(e.target.selectedOptions).map(i=>i.value||i.text);{let i;return ti(r)?e.target.checked?i=e.target.value:i=n:i=e.target.value,t.includes("number")?Ke(i):t.includes("boolean")?Ce(i):t.includes("trim")?i.trim():i}}})}function Ke(r){let t=r?parseFloat(r):null;return Hs(t)?t:r}function Us(r,t){return r==t}function Hs(r){return!Array.isArray(r)&&!isNaN(r)}function rn(r){return r!==null&&typeof r=="object"&&typeof r.get=="function"&&typeof r.set=="function"}gt("cloak",r=>queueMicrotask(()=>ut(()=>r.removeAttribute(qt("cloak")))));Hn(()=>`[${qt("init")}]`);gt("init",zt((r,{expression:t},{evaluate:e})=>typeof t=="string"?!!t.trim()&&e(t,{},!1):e(t,{},!1)));gt("text",(r,{expression:t},{effect:e,evaluateLater:n})=>{let i=n(t);e(()=>{i(a=>{ut(()=>{r.textContent=a})})})});gt("html",(r,{expression:t},{effect:e,evaluateLater:n})=>{let i=n(t);e(()=>{i(a=>{ut(()=>{r.innerHTML=a,r._x_ignoreSelf=!0,Nt(r),delete r._x_ignoreSelf})})})});Er(Bn(":",zn(qt("bind:"))));var Si=(r,{value:t,modifiers:e,expression:n,original:i},{effect:a,cleanup:s})=>{if(!t){let l={};Xa(l),vt(r,n)(b=>{ai(r,b,i)},{scope:l});return}if(t==="key")return Vs(r,n);if(r._x_inlineBindings&&r._x_inlineBindings[t]&&r._x_inlineBindings[t].extract)return;let o=vt(r,n);a(()=>o(l=>{l===void 0&&typeof n=="string"&&n.match(/\./)&&(l=""),ut(()=>qn(r,t,l,e))})),s(()=>{r._x_undoAddedClasses&&r._x_undoAddedClasses(),r._x_undoAddedStyles&&r._x_undoAddedStyles()})};Si.inline=(r,{value:t,modifiers:e,expression:n})=>{t&&(r._x_inlineBindings||(r._x_inlineBindings={}),r._x_inlineBindings[t]={expression:n,extract:!1})};gt("bind",Si);function Vs(r,t){r._x_keyExpression=t}Un(()=>`[${qt("data")}]`);gt("data",(r,{expression:t},{cleanup:e})=>{if(Zs(r))return;t=t===""?"{}":t;let n={};ir(n,r);let i={};Ya(i,n);let a=Dt(r,t,{scope:i});(a===void 0||a===!0)&&(a={}),ir(a,r);let s=Kt(a);En(s);let o=he(r,s);s.init&&Dt(r,s.init),e(()=>{s.destroy&&Dt(r,s.destroy),o()})});Le((r,t)=>{r._x_dataStack&&(t._x_dataStack=r._x_dataStack,t.setAttribute("data-has-alpine-state",!0))});function Zs(r){return Rt?hr?!0:r.hasAttribute("data-has-alpine-state"):!1}gt("show",(r,{modifiers:t,expression:e},{effect:n})=>{let i=vt(r,e);r._x_doHide||(r._x_doHide=()=>{ut(()=>{r.style.setProperty("display","none",t.includes("important")?"important":void 0)})}),r._x_doShow||(r._x_doShow=()=>{ut(()=>{r.style.length===1&&r.style.display==="none"?r.removeAttribute("style"):r.style.removeProperty("display")})});let a=()=>{r._x_doHide(),r._x_isShown=!1},s=()=>{r._x_doShow(),r._x_isShown=!0},o=()=>setTimeout(s),l=cr(g=>g?s():a(),g=>{typeof r._x_toggleAndCascadeWithTransitions=="function"?r._x_toggleAndCascadeWithTransitions(r,g,s,a):g?o():a()}),h,b=!0;n(()=>i(g=>{!b&&g===h||(t.includes("immediate")&&(g?o():a()),l(g),h=g,b=!1)}))});gt("for",(r,{expression:t},{effect:e,cleanup:n})=>{let i=Ks(t),a=vt(r,i.items),s=vt(r,r._x_keyExpression||"index");r._x_prevKeys=[],r._x_lookup={},e(()=>Gs(r,i,a,s)),n(()=>{Object.values(r._x_lookup).forEach(o=>ut(()=>{Jt(o),o.remove()})),delete r._x_prevKeys,delete r._x_lookup})});function Gs(r,t,e,n){let i=s=>typeof s=="object"&&!Array.isArray(s),a=r;e(s=>{Xs(s)&&s>=0&&(s=Array.from(Array(s).keys(),p=>p+1)),s===void 0&&(s=[]);let o=r._x_lookup,l=r._x_prevKeys,h=[],b=[];if(i(s))s=Object.entries(s).map(([p,m])=>{let y=nn(t,m,p,s);n(x=>{b.includes(x)&&kt("Duplicate key on x-for",r),b.push(x)},{scope:{index:p,...y}}),h.push(y)});else for(let p=0;p<s.length;p++){let m=nn(t,s[p],p,s);n(y=>{b.includes(y)&&kt("Duplicate key on x-for",r),b.push(y)},{scope:{index:p,...m}}),h.push(m)}let g=[],v=[],d=[],w=[];for(let p=0;p<l.length;p++){let m=l[p];b.indexOf(m)===-1&&d.push(m)}l=l.filter(p=>!d.includes(p));let f="template";for(let p=0;p<b.length;p++){let m=b[p],y=l.indexOf(m);if(y===-1)l.splice(p,0,m),g.push([f,p]);else if(y!==p){let x=l.splice(p,1)[0],P=l.splice(y-1,1)[0];l.splice(p,0,P),l.splice(y,0,x),v.push([x,P])}else w.push(m);f=m}for(let p=0;p<d.length;p++){let m=d[p];m in o&&(ut(()=>{Jt(o[m]),o[m].remove()}),delete o[m])}for(let p=0;p<v.length;p++){let[m,y]=v[p],x=o[m],P=o[y],A=document.createElement("div");ut(()=>{P||kt('x-for ":key" is undefined or invalid',a,y,o),P.after(A),x.after(P),P._x_currentIfEl&&P.after(P._x_currentIfEl),A.before(x),x._x_currentIfEl&&x.after(x._x_currentIfEl),A.remove()}),P._x_refreshXForScope(h[b.indexOf(y)])}for(let p=0;p<g.length;p++){let[m,y]=g[p],x=m==="template"?a:o[m];x._x_currentIfEl&&(x=x._x_currentIfEl);let P=h[y],A=b[y],F=document.importNode(a.content,!0).firstElementChild,z=Kt(P);he(F,z,a),F._x_refreshXForScope=W=>{Object.entries(W).forEach(([B,Z])=>{z[B]=Z})},ut(()=>{x.after(F),zt(()=>Nt(F))()}),typeof A=="object"&&kt("x-for key cannot be an object, it must be a string or an integer",a),o[A]=F}for(let p=0;p<w.length;p++)o[w[p]]._x_refreshXForScope(h[b.indexOf(w[p])]);a._x_prevKeys=b})}function Ks(r){let t=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,e=/^\s*\(|\)\s*$/g,n=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,i=r.match(n);if(!i)return;let a={};a.items=i[2].trim();let s=i[1].replace(e,"").trim(),o=s.match(t);return o?(a.item=s.replace(t,"").trim(),a.index=o[1].trim(),o[2]&&(a.collection=o[2].trim())):a.item=s,a}function nn(r,t,e,n){let i={};return/^\[.*\]$/.test(r.item)&&Array.isArray(t)?r.item.replace("[","").replace("]","").split(",").map(s=>s.trim()).forEach((s,o)=>{i[s]=t[o]}):/^\{.*\}$/.test(r.item)&&!Array.isArray(t)&&typeof t=="object"?r.item.replace("{","").replace("}","").split(",").map(s=>s.trim()).forEach(s=>{i[s]=t[s]}):i[r.item]=t,r.index&&(i[r.index]=e),r.collection&&(i[r.collection]=n),i}function Xs(r){return!Array.isArray(r)&&!isNaN(r)}function Ei(){}Ei.inline=(r,{expression:t},{cleanup:e})=>{let n=Ie(r);n._x_refs||(n._x_refs={}),n._x_refs[t]=r,e(()=>delete n._x_refs[t])};gt("ref",Ei);gt("if",(r,{expression:t},{effect:e,cleanup:n})=>{r.tagName.toLowerCase()!=="template"&&kt("x-if can only be used on a <template> tag",r);let i=vt(r,t),a=()=>{if(r._x_currentIfEl)return r._x_currentIfEl;let o=r.content.cloneNode(!0).firstElementChild;return he(o,{},r),ut(()=>{r.after(o),zt(()=>Nt(o))()}),r._x_currentIfEl=o,r._x_undoIf=()=>{ut(()=>{Jt(o),o.remove()}),delete r._x_currentIfEl},o},s=()=>{r._x_undoIf&&(r._x_undoIf(),delete r._x_undoIf)};e(()=>i(o=>{o?a():s()})),n(()=>r._x_undoIf&&r._x_undoIf())});gt("id",(r,{expression:t},{evaluate:e})=>{e(t).forEach(i=>zs(r,i))});Le((r,t)=>{r._x_ids&&(t._x_ids=r._x_ids)});Er(Bn("@",zn(qt("on:"))));gt("on",zt((r,{value:t,modifiers:e,expression:n},{cleanup:i})=>{let a=n?vt(r,n):()=>{};r.tagName.toLowerCase()==="template"&&(r._x_forwardEvents||(r._x_forwardEvents=[]),r._x_forwardEvents.includes(t)||r._x_forwardEvents.push(t));let s=mr(r,t,e,o=>{a(()=>{},{scope:{$event:o},params:[o]})});i(()=>s())}));We("Collapse","collapse","collapse");We("Intersect","intersect","intersect");We("Focus","trap","focus");We("Mask","mask","mask");function We(r,t,e){gt(t,n=>kt(`You can't use [x-${t}] without first installing the "${r}" plugin here: https://alpinejs.dev/plugins/${e}`,n))}fe.setEvaluator(Nn);fe.setReactivityEngine({reactive:Fr,effect:os,release:ls,raw:ct});var qs=fe,pe=qs;class Re{constructor(t,e,n,i){if(isNaN(t)||isNaN(e))throw new Error(`Point is invalid: (${t}, ${e})`);this.x=+t,this.y=+e,this.pressure=n||0,this.time=i||Date.now()}distanceTo(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}equals(t){return this.x===t.x&&this.y===t.y&&this.pressure===t.pressure&&this.time===t.time}velocityFrom(t){return this.time!==t.time?this.distanceTo(t)/(this.time-t.time):0}}class Lr{static fromPoints(t,e){const n=this.calculateControlPoints(t[0],t[1],t[2]).c2,i=this.calculateControlPoints(t[1],t[2],t[3]).c1;return new Lr(t[1],n,i,t[2],e.start,e.end)}static calculateControlPoints(t,e,n){const i=t.x-e.x,a=t.y-e.y,s=e.x-n.x,o=e.y-n.y,l={x:(t.x+e.x)/2,y:(t.y+e.y)/2},h={x:(e.x+n.x)/2,y:(e.y+n.y)/2},b=Math.sqrt(i*i+a*a),g=Math.sqrt(s*s+o*o),v=l.x-h.x,d=l.y-h.y,w=b+g==0?0:g/(b+g),f={x:h.x+v*w,y:h.y+d*w},p=e.x-f.x,m=e.y-f.y;return{c1:new Re(l.x+p,l.y+m),c2:new Re(h.x+p,h.y+m)}}constructor(t,e,n,i,a,s){this.startPoint=t,this.control2=e,this.control1=n,this.endPoint=i,this.startWidth=a,this.endWidth=s}length(){let e=0,n,i;for(let a=0;a<=10;a+=1){const s=a/10,o=this.point(s,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),l=this.point(s,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(a>0){const h=o-n,b=l-i;e+=Math.sqrt(h*h+b*b)}n=o,i=l}return e}point(t,e,n,i,a){return e*(1-t)*(1-t)*(1-t)+3*n*(1-t)*(1-t)*t+3*i*(1-t)*t*t+a*t*t*t}}class Ys{constructor(){try{this._et=new EventTarget}catch{this._et=document}}addEventListener(t,e,n){this._et.addEventListener(t,e,n)}dispatchEvent(t){return this._et.dispatchEvent(t)}removeEventListener(t,e,n){this._et.removeEventListener(t,e,n)}}function Js(r,t=250){let e=0,n=null,i,a,s;const o=()=>{e=Date.now(),n=null,i=r.apply(a,s),n||(a=null,s=[])};return function(...h){const b=Date.now(),g=t-(b-e);return a=this,s=h,g<=0||g>t?(n&&(clearTimeout(n),n=null),e=b,i=r.apply(a,s),n||(a=null,s=[])):n||(n=window.setTimeout(o,g)),i}}class Be extends Ys{constructor(t,e={}){var n,i,a;super(),this.canvas=t,this._drawingStroke=!1,this._isEmpty=!0,this._lastPoints=[],this._data=[],this._lastVelocity=0,this._lastWidth=0,this.velocityFilterWeight=e.velocityFilterWeight||.7,this.minWidth=e.minWidth||.5,this.maxWidth=e.maxWidth||2.5,this.throttle=(n=e.throttle)!==null&&n!==void 0?n:16,this.minDistance=(i=e.minDistance)!==null&&i!==void 0?i:5,this.dotSize=e.dotSize||0,this.penColor=e.penColor||"black",this.backgroundColor=e.backgroundColor||"rgba(0,0,0,0)",this.compositeOperation=e.compositeOperation||"source-over",this.canvasContextOptions=(a=e.canvasContextOptions)!==null&&a!==void 0?a:{},this._strokeMoveUpdate=this.throttle?Js(Be.prototype._strokeUpdate,this.throttle):Be.prototype._strokeUpdate,this._handleMouseDown=this._handleMouseDown.bind(this),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this._handleTouchStart=this._handleTouchStart.bind(this),this._handleTouchMove=this._handleTouchMove.bind(this),this._handleTouchEnd=this._handleTouchEnd.bind(this),this._handlePointerDown=this._handlePointerDown.bind(this),this._handlePointerMove=this._handlePointerMove.bind(this),this._handlePointerUp=this._handlePointerUp.bind(this),this._ctx=t.getContext("2d",this.canvasContextOptions),this.clear(),this.on()}clear(){const{_ctx:t,canvas:e}=this;t.fillStyle=this.backgroundColor,t.clearRect(0,0,e.width,e.height),t.fillRect(0,0,e.width,e.height),this._data=[],this._reset(this._getPointGroupOptions()),this._isEmpty=!0,this._strokePointerId=void 0}fromDataURL(t,e={}){return new Promise((n,i)=>{const a=new Image,s=e.ratio||window.devicePixelRatio||1,o=e.width||this.canvas.width/s,l=e.height||this.canvas.height/s,h=e.xOffset||0,b=e.yOffset||0;this._reset(this._getPointGroupOptions()),a.onload=()=>{this._ctx.drawImage(a,h,b,o,l),n()},a.onerror=g=>{i(g)},a.crossOrigin="anonymous",a.src=t,this._isEmpty=!1})}toDataURL(t="image/png",e){switch(t){case"image/svg+xml":return typeof e!="object"&&(e=void 0),`data:image/svg+xml;base64,${btoa(this.toSVG(e))}`;default:return typeof e!="number"&&(e=void 0),this.canvas.toDataURL(t,e)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",this.canvas.style.userSelect="none";const t=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!t?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.style.userSelect="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerDown),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this._removeMoveUpEventListeners()}_getListenerFunctions(){var t;const e=window.document===this.canvas.ownerDocument?window:(t=this.canvas.ownerDocument.defaultView)!==null&&t!==void 0?t:this.canvas.ownerDocument;return{addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e)}}_removeMoveUpEventListeners(){const{removeEventListener:t}=this._getListenerFunctions();t("pointermove",this._handlePointerMove),t("pointerup",this._handlePointerUp),t("mousemove",this._handleMouseMove),t("mouseup",this._handleMouseUp),t("touchmove",this._handleTouchMove),t("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(t,{clear:e=!0}={}){e&&this.clear(),this._fromData(t,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=this._data.concat(t)}toData(){return this._data}_isLeftButtonPressed(t,e){return e?t.buttons===1:(t.buttons&1)===1}_pointerEventToSignatureEvent(t){return{event:t,type:t.type,x:t.clientX,y:t.clientY,pressure:"pressure"in t?t.pressure:0}}_touchEventToSignatureEvent(t){const e=t.changedTouches[0];return{event:t,type:t.type,x:e.clientX,y:e.clientY,pressure:e.force}}_handleMouseDown(t){!this._isLeftButtonPressed(t,!0)||this._drawingStroke||this._strokeBegin(this._pointerEventToSignatureEvent(t))}_handleMouseMove(t){if(!this._isLeftButtonPressed(t,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(t),!1);return}this._strokeMoveUpdate(this._pointerEventToSignatureEvent(t))}_handleMouseUp(t){this._isLeftButtonPressed(t)||this._strokeEnd(this._pointerEventToSignatureEvent(t))}_handleTouchStart(t){t.targetTouches.length!==1||this._drawingStroke||(t.cancelable&&t.preventDefault(),this._strokeBegin(this._touchEventToSignatureEvent(t)))}_handleTouchMove(t){if(t.targetTouches.length===1){if(t.cancelable&&t.preventDefault(),!this._drawingStroke){this._strokeEnd(this._touchEventToSignatureEvent(t),!1);return}this._strokeMoveUpdate(this._touchEventToSignatureEvent(t))}}_handleTouchEnd(t){t.targetTouches.length===0&&(t.cancelable&&t.preventDefault(),this._strokeEnd(this._touchEventToSignatureEvent(t)))}_getPointerId(t){return t.persistentDeviceId||t.pointerId}_allowPointerId(t,e=!1){return typeof this._strokePointerId>"u"?e:this._getPointerId(t)===this._strokePointerId}_handlePointerDown(t){this._drawingStroke||!this._isLeftButtonPressed(t)||!this._allowPointerId(t,!0)||(this._strokePointerId=this._getPointerId(t),t.preventDefault(),this._strokeBegin(this._pointerEventToSignatureEvent(t)))}_handlePointerMove(t){if(this._allowPointerId(t)){if(!this._isLeftButtonPressed(t,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(t),!1);return}t.preventDefault(),this._strokeMoveUpdate(this._pointerEventToSignatureEvent(t))}}_handlePointerUp(t){this._isLeftButtonPressed(t)||!this._allowPointerId(t)||(t.preventDefault(),this._strokeEnd(this._pointerEventToSignatureEvent(t)))}_getPointGroupOptions(t){return{penColor:t&&"penColor"in t?t.penColor:this.penColor,dotSize:t&&"dotSize"in t?t.dotSize:this.dotSize,minWidth:t&&"minWidth"in t?t.minWidth:this.minWidth,maxWidth:t&&"maxWidth"in t?t.maxWidth:this.maxWidth,velocityFilterWeight:t&&"velocityFilterWeight"in t?t.velocityFilterWeight:this.velocityFilterWeight,compositeOperation:t&&"compositeOperation"in t?t.compositeOperation:this.compositeOperation}}_strokeBegin(t){if(!this.dispatchEvent(new CustomEvent("beginStroke",{detail:t,cancelable:!0})))return;const{addEventListener:n}=this._getListenerFunctions();switch(t.event.type){case"mousedown":n("mousemove",this._handleMouseMove,{passive:!1}),n("mouseup",this._handleMouseUp,{passive:!1});break;case"touchstart":n("touchmove",this._handleTouchMove,{passive:!1}),n("touchend",this._handleTouchEnd,{passive:!1});break;case"pointerdown":n("pointermove",this._handlePointerMove,{passive:!1}),n("pointerup",this._handlePointerUp,{passive:!1});break}this._drawingStroke=!0;const i=this._getPointGroupOptions(),a=Object.assign(Object.assign({},i),{points:[]});this._data.push(a),this._reset(i),this._strokeUpdate(t)}_strokeUpdate(t){if(!this._drawingStroke)return;if(this._data.length===0){this._strokeBegin(t);return}this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:t}));const e=this._createPoint(t.x,t.y,t.pressure),n=this._data[this._data.length-1],i=n.points,a=i.length>0&&i[i.length-1],s=a?e.distanceTo(a)<=this.minDistance:!1,o=this._getPointGroupOptions(n);if(!a||!(a&&s)){const l=this._addPoint(e,o);a?l&&this._drawCurve(l,o):this._drawDot(e,o),i.push({time:e.time,x:e.x,y:e.y,pressure:e.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:t}))}_strokeEnd(t,e=!0){this._removeMoveUpEventListeners(),this._drawingStroke&&(e&&this._strokeUpdate(t),this._drawingStroke=!1,this._strokePointerId=void 0,this.dispatchEvent(new CustomEvent("endStroke",{detail:t})))}_handlePointerEvents(){this._drawingStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerDown,{passive:!1})}_handleMouseEvents(){this._drawingStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown,{passive:!1})}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart,{passive:!1})}_reset(t){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(t.minWidth+t.maxWidth)/2,this._ctx.fillStyle=t.penColor,this._ctx.globalCompositeOperation=t.compositeOperation}_createPoint(t,e,n){const i=this.canvas.getBoundingClientRect();return new Re(t-i.left,e-i.top,n,new Date().getTime())}_addPoint(t,e){const{_lastPoints:n}=this;if(n.push(t),n.length>2){n.length===3&&n.unshift(n[0]);const i=this._calculateCurveWidths(n[1],n[2],e),a=Lr.fromPoints(n,i);return n.shift(),a}return null}_calculateCurveWidths(t,e,n){const i=n.velocityFilterWeight*e.velocityFrom(t)+(1-n.velocityFilterWeight)*this._lastVelocity,a=this._strokeWidth(i,n),s={end:a,start:this._lastWidth};return this._lastVelocity=i,this._lastWidth=a,s}_strokeWidth(t,e){return Math.max(e.maxWidth/(t+1),e.minWidth)}_drawCurveSegment(t,e,n){const i=this._ctx;i.moveTo(t,e),i.arc(t,e,n,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(t,e){const n=this._ctx,i=t.endWidth-t.startWidth,a=Math.ceil(t.length())*2;n.beginPath(),n.fillStyle=e.penColor;for(let s=0;s<a;s+=1){const o=s/a,l=o*o,h=l*o,b=1-o,g=b*b,v=g*b;let d=v*t.startPoint.x;d+=3*g*o*t.control1.x,d+=3*b*l*t.control2.x,d+=h*t.endPoint.x;let w=v*t.startPoint.y;w+=3*g*o*t.control1.y,w+=3*b*l*t.control2.y,w+=h*t.endPoint.y;const f=Math.min(t.startWidth+h*i,e.maxWidth);this._drawCurveSegment(d,w,f)}n.closePath(),n.fill()}_drawDot(t,e){const n=this._ctx,i=e.dotSize>0?e.dotSize:(e.minWidth+e.maxWidth)/2;n.beginPath(),this._drawCurveSegment(t.x,t.y,i),n.closePath(),n.fillStyle=e.penColor,n.fill()}_fromData(t,e,n){for(const i of t){const{points:a}=i,s=this._getPointGroupOptions(i);if(a.length>1)for(let o=0;o<a.length;o+=1){const l=a[o],h=new Re(l.x,l.y,l.pressure,l.time);o===0&&this._reset(s);const b=this._addPoint(h,s);b&&e(b,s)}else this._reset(s),n(a[0],s)}}toSVG({includeBackgroundColor:t=!1}={}){const e=this._data,n=Math.max(window.devicePixelRatio||1,1),i=0,a=0,s=this.canvas.width/n,o=this.canvas.height/n,l=document.createElementNS("http://www.w3.org/2000/svg","svg");if(l.setAttribute("xmlns","http://www.w3.org/2000/svg"),l.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),l.setAttribute("viewBox",`${i} ${a} ${s} ${o}`),l.setAttribute("width",s.toString()),l.setAttribute("height",o.toString()),t&&this.backgroundColor){const h=document.createElement("rect");h.setAttribute("width","100%"),h.setAttribute("height","100%"),h.setAttribute("fill",this.backgroundColor),l.appendChild(h)}return this._fromData(e,(h,{penColor:b})=>{const g=document.createElement("path");if(!isNaN(h.control1.x)&&!isNaN(h.control1.y)&&!isNaN(h.control2.x)&&!isNaN(h.control2.y)){const v=`M ${h.startPoint.x.toFixed(3)},${h.startPoint.y.toFixed(3)} C ${h.control1.x.toFixed(3)},${h.control1.y.toFixed(3)} ${h.control2.x.toFixed(3)},${h.control2.y.toFixed(3)} ${h.endPoint.x.toFixed(3)},${h.endPoint.y.toFixed(3)}`;g.setAttribute("d",v),g.setAttribute("stroke-width",(h.endWidth*2.25).toFixed(3)),g.setAttribute("stroke",b),g.setAttribute("fill","none"),g.setAttribute("stroke-linecap","round"),l.appendChild(g)}},(h,{penColor:b,dotSize:g,minWidth:v,maxWidth:d})=>{const w=document.createElement("circle"),f=g>0?g:(v+d)/2;w.setAttribute("r",f.toString()),w.setAttribute("cx",h.x.toString()),w.setAttribute("cy",h.y.toString()),w.setAttribute("fill",b),l.appendChild(w)}),l.outerHTML}}var ke=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qs(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function xe(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Xe={exports:{}};var an;function to(){return an||(an=1,(function(r,t){(function(e){r.exports=e()})(function(){return(function e(n,i,a){function s(h,b){if(!i[h]){if(!n[h]){var g=typeof xe=="function"&&xe;if(!b&&g)return g(h,!0);if(o)return o(h,!0);var v=new Error("Cannot find module '"+h+"'");throw v.code="MODULE_NOT_FOUND",v}var d=i[h]={exports:{}};n[h][0].call(d.exports,function(w){var f=n[h][1][w];return s(f||w)},d,d.exports,e,n,i,a)}return i[h].exports}for(var o=typeof xe=="function"&&xe,l=0;l<a.length;l++)s(a[l]);return s})({1:[function(e,n,i){var a=e("./utils"),s=e("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var h,b,g,v,d,w,f,p=[],m=0,y=l.length,x=y,P=a.getTypeOf(l)!=="string";m<l.length;)x=y-m,g=P?(h=l[m++],b=m<y?l[m++]:0,m<y?l[m++]:0):(h=l.charCodeAt(m++),b=m<y?l.charCodeAt(m++):0,m<y?l.charCodeAt(m++):0),v=h>>2,d=(3&h)<<4|b>>4,w=1<x?(15&b)<<2|g>>6:64,f=2<x?63&g:64,p.push(o.charAt(v)+o.charAt(d)+o.charAt(w)+o.charAt(f));return p.join("")},i.decode=function(l){var h,b,g,v,d,w,f=0,p=0,m="data:";if(l.substr(0,m.length)===m)throw new Error("Invalid base64 input, it looks like a data url.");var y,x=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&x--,l.charAt(l.length-2)===o.charAt(64)&&x--,x%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=s.uint8array?new Uint8Array(0|x):new Array(0|x);f<l.length;)h=o.indexOf(l.charAt(f++))<<2|(v=o.indexOf(l.charAt(f++)))>>4,b=(15&v)<<4|(d=o.indexOf(l.charAt(f++)))>>2,g=(3&d)<<6|(w=o.indexOf(l.charAt(f++))),y[p++]=h,d!==64&&(y[p++]=b),w!==64&&(y[p++]=g);return y}},{"./support":30,"./utils":32}],2:[function(e,n,i){var a=e("./external"),s=e("./stream/DataWorker"),o=e("./stream/Crc32Probe"),l=e("./stream/DataLengthProbe");function h(b,g,v,d,w){this.compressedSize=b,this.uncompressedSize=g,this.crc32=v,this.compression=d,this.compressedContent=w}h.prototype={getContentWorker:function(){var b=new s(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),g=this;return b.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),b},getCompressedWorker:function(){return new s(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(b,g,v){return b.pipe(new o).pipe(new l("uncompressedSize")).pipe(g.compressWorker(v)).pipe(new l("compressedSize")).withStreamInfo("compression",g)},n.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,n,i){var a=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,n,i){var a=e("./utils"),s=(function(){for(var o,l=[],h=0;h<256;h++){o=h;for(var b=0;b<8;b++)o=1&o?3988292384^o>>>1:o>>>1;l[h]=o}return l})();n.exports=function(o,l){return o!==void 0&&o.length?a.getTypeOf(o)!=="string"?(function(h,b,g,v){var d=s,w=v+g;h^=-1;for(var f=v;f<w;f++)h=h>>>8^d[255&(h^b[f])];return-1^h})(0|l,o,o.length,0):(function(h,b,g,v){var d=s,w=v+g;h^=-1;for(var f=v;f<w;f++)h=h>>>8^d[255&(h^b.charCodeAt(f))];return-1^h})(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(e,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,n,i){var a=null;a=typeof Promise<"u"?Promise:e("lie"),n.exports={Promise:a}},{lie:37}],7:[function(e,n,i){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=e("pako"),o=e("./utils"),l=e("./stream/GenericWorker"),h=a?"uint8array":"array";function b(g,v){l.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=v,this.meta={}}i.magic="\b\0",o.inherits(b,l),b.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(h,g.data),!1)},b.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},b.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},b.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(v){g.push({data:v,meta:g.meta})}},i.compressWorker=function(g){return new b("Deflate",g)},i.uncompressWorker=function(){return new b("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,n,i){function a(d,w){var f,p="";for(f=0;f<w;f++)p+=String.fromCharCode(255&d),d>>>=8;return p}function s(d,w,f,p,m,y){var x,P,A=d.file,F=d.compression,z=y!==h.utf8encode,W=o.transformTo("string",y(A.name)),B=o.transformTo("string",h.utf8encode(A.name)),Z=A.comment,Q=o.transformTo("string",y(Z)),S=o.transformTo("string",h.utf8encode(Z)),I=B.length!==A.name.length,u=S.length!==Z.length,D="",et="",U="",rt=A.dir,H=A.date,tt={crc32:0,compressedSize:0,uncompressedSize:0};w&&!f||(tt.crc32=d.crc32,tt.compressedSize=d.compressedSize,tt.uncompressedSize=d.uncompressedSize);var O=0;w&&(O|=8),z||!I&&!u||(O|=2048);var N=0,J=0;rt&&(N|=16),m==="UNIX"?(J=798,N|=(function(K,ht){var _t=K;return K||(_t=ht?16893:33204),(65535&_t)<<16})(A.unixPermissions,rt)):(J=20,N|=(function(K){return 63&(K||0)})(A.dosPermissions)),x=H.getUTCHours(),x<<=6,x|=H.getUTCMinutes(),x<<=5,x|=H.getUTCSeconds()/2,P=H.getUTCFullYear()-1980,P<<=4,P|=H.getUTCMonth()+1,P<<=5,P|=H.getUTCDate(),I&&(et=a(1,1)+a(b(W),4)+B,D+="up"+a(et.length,2)+et),u&&(U=a(1,1)+a(b(Q),4)+S,D+="uc"+a(U.length,2)+U);var X="";return X+=`
\0`,X+=a(O,2),X+=F.magic,X+=a(x,2),X+=a(P,2),X+=a(tt.crc32,4),X+=a(tt.compressedSize,4),X+=a(tt.uncompressedSize,4),X+=a(W.length,2),X+=a(D.length,2),{fileRecord:g.LOCAL_FILE_HEADER+X+W+D,dirRecord:g.CENTRAL_FILE_HEADER+a(J,2)+X+a(Q.length,2)+"\0\0\0\0"+a(N,4)+a(p,4)+W+D+Q}}var o=e("../utils"),l=e("../stream/GenericWorker"),h=e("../utf8"),b=e("../crc32"),g=e("../signature");function v(d,w,f,p){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=w,this.zipPlatform=f,this.encodeFileName=p,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(v,l),v.prototype.push=function(d){var w=d.meta.percent||0,f=this.entriesCount,p=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,l.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:f?(w+100*(f-p-1))/f:100}}))},v.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var w=this.streamFiles&&!d.file.dir;if(w){var f=s(d,w,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:f.fileRecord,meta:{percent:0}})}else this.accumulate=!0},v.prototype.closedSource=function(d){this.accumulate=!1;var w=this.streamFiles&&!d.file.dir,f=s(d,w,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(f.dirRecord),w)this.push({data:(function(p){return g.DATA_DESCRIPTOR+a(p.crc32,4)+a(p.compressedSize,4)+a(p.uncompressedSize,4)})(d),meta:{percent:100}});else for(this.push({data:f.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},v.prototype.flush=function(){for(var d=this.bytesWritten,w=0;w<this.dirRecords.length;w++)this.push({data:this.dirRecords[w],meta:{percent:100}});var f=this.bytesWritten-d,p=(function(m,y,x,P,A){var F=o.transformTo("string",A(P));return g.CENTRAL_DIRECTORY_END+"\0\0\0\0"+a(m,2)+a(m,2)+a(y,4)+a(x,4)+a(F.length,2)+F})(this.dirRecords.length,f,d,this.zipComment,this.encodeFileName);this.push({data:p,meta:{percent:100}})},v.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},v.prototype.registerPrevious=function(d){this._sources.push(d);var w=this;return d.on("data",function(f){w.processChunk(f)}),d.on("end",function(){w.closedSource(w.previous.streamInfo),w._sources.length?w.prepareNextSource():w.end()}),d.on("error",function(f){w.error(f)}),this},v.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},v.prototype.error=function(d){var w=this._sources;if(!l.prototype.error.call(this,d))return!1;for(var f=0;f<w.length;f++)try{w[f].error(d)}catch{}return!0},v.prototype.lock=function(){l.prototype.lock.call(this);for(var d=this._sources,w=0;w<d.length;w++)d[w].lock()},n.exports=v},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,n,i){var a=e("../compressions"),s=e("./ZipFileWorker");i.generateWorker=function(o,l,h){var b=new s(l.streamFiles,h,l.platform,l.encodeFileName),g=0;try{o.forEach(function(v,d){g++;var w=(function(y,x){var P=y||x,A=a[P];if(!A)throw new Error(P+" is not a valid compression method !");return A})(d.options.compression,l.compression),f=d.options.compressionOptions||l.compressionOptions||{},p=d.dir,m=d.date;d._compressWorker(w,f).withStreamInfo("file",{name:v,dir:p,date:m,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(b)}),b.entriesCount=g}catch(v){b.error(v)}return b}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,n,i){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new a;for(var o in this)typeof this[o]!="function"&&(s[o]=this[o]);return s}}(a.prototype=e("./object")).loadAsync=e("./load"),a.support=e("./support"),a.defaults=e("./defaults"),a.version="3.10.1",a.loadAsync=function(s,o){return new a().loadAsync(s,o)},a.external=e("./external"),n.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,n,i){var a=e("./utils"),s=e("./external"),o=e("./utf8"),l=e("./zipEntries"),h=e("./stream/Crc32Probe"),b=e("./nodejsUtils");function g(v){return new s.Promise(function(d,w){var f=v.decompressed.getContentWorker().pipe(new h);f.on("error",function(p){w(p)}).on("end",function(){f.streamInfo.crc32!==v.decompressed.crc32?w(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}n.exports=function(v,d){var w=this;return d=a.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),b.isNode&&b.isStream(v)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",v,!0,d.optimizedBinaryString,d.base64).then(function(f){var p=new l(d);return p.load(f),p}).then(function(f){var p=[s.Promise.resolve(f)],m=f.files;if(d.checkCRC32)for(var y=0;y<m.length;y++)p.push(g(m[y]));return s.Promise.all(p)}).then(function(f){for(var p=f.shift(),m=p.files,y=0;y<m.length;y++){var x=m[y],P=x.fileNameStr,A=a.resolve(x.fileNameStr);w.file(A,x.decompressed,{binary:!0,optimizedBinaryString:!0,date:x.date,dir:x.dir,comment:x.fileCommentStr.length?x.fileCommentStr:null,unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions,createFolders:d.createFolders}),x.dir||(w.file(A).unsafeOriginalName=P)}return p.zipComment.length&&(w.comment=p.zipComment),w})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,n,i){var a=e("../utils"),s=e("../stream/GenericWorker");function o(l,h){s.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(h)}a.inherits(o,s),o.prototype._bindStream=function(l){var h=this;(this._stream=l).pause(),l.on("data",function(b){h.push({data:b,meta:{percent:0}})}).on("error",function(b){h.isPaused?this.generatedError=b:h.error(b)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},o.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,n,i){var a=e("readable-stream").Readable;function s(o,l,h){a.call(this,l),this._helper=o;var b=this;o.on("data",function(g,v){b.push(g)||b._helper.pause(),h&&h(v)}).on("error",function(g){b.emit("error",g)}).on("end",function(){b.push(null)})}e("../utils").inherits(s,a),s.prototype._read=function(){this._helper.resume()},n.exports=s},{"../utils":32,"readable-stream":16}],14:[function(e,n,i){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(a,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(a,s);if(typeof a=="number")throw new Error('The "data" argument must not be a number');return new Buffer(a,s)},allocBuffer:function(a){if(Buffer.alloc)return Buffer.alloc(a);var s=new Buffer(a);return s.fill(0),s},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&typeof a.on=="function"&&typeof a.pause=="function"&&typeof a.resume=="function"}}},{}],15:[function(e,n,i){function a(A,F,z){var W,B=o.getTypeOf(F),Z=o.extend(z||{},b);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(A=m(A)),Z.createFolders&&(W=p(A))&&y.call(this,W,!0);var Q=B==="string"&&Z.binary===!1&&Z.base64===!1;z&&z.binary!==void 0||(Z.binary=!Q),(F instanceof g&&F.uncompressedSize===0||Z.dir||!F||F.length===0)&&(Z.base64=!1,Z.binary=!0,F="",Z.compression="STORE",B="string");var S=null;S=F instanceof g||F instanceof l?F:w.isNode&&w.isStream(F)?new f(A,F):o.prepareContent(A,F,Z.binary,Z.optimizedBinaryString,Z.base64);var I=new v(A,S,Z);this.files[A]=I}var s=e("./utf8"),o=e("./utils"),l=e("./stream/GenericWorker"),h=e("./stream/StreamHelper"),b=e("./defaults"),g=e("./compressedObject"),v=e("./zipObject"),d=e("./generate"),w=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),p=function(A){A.slice(-1)==="/"&&(A=A.substring(0,A.length-1));var F=A.lastIndexOf("/");return 0<F?A.substring(0,F):""},m=function(A){return A.slice(-1)!=="/"&&(A+="/"),A},y=function(A,F){return F=F!==void 0?F:b.createFolders,A=m(A),this.files[A]||a.call(this,A,null,{dir:!0,createFolders:F}),this.files[A]};function x(A){return Object.prototype.toString.call(A)==="[object RegExp]"}var P={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(A){var F,z,W;for(F in this.files)W=this.files[F],(z=F.slice(this.root.length,F.length))&&F.slice(0,this.root.length)===this.root&&A(z,W)},filter:function(A){var F=[];return this.forEach(function(z,W){A(z,W)&&F.push(W)}),F},file:function(A,F,z){if(arguments.length!==1)return A=this.root+A,a.call(this,A,F,z),this;if(x(A)){var W=A;return this.filter(function(Z,Q){return!Q.dir&&W.test(Z)})}var B=this.files[this.root+A];return B&&!B.dir?B:null},folder:function(A){if(!A)return this;if(x(A))return this.filter(function(B,Z){return Z.dir&&A.test(B)});var F=this.root+A,z=y.call(this,F),W=this.clone();return W.root=z.name,W},remove:function(A){A=this.root+A;var F=this.files[A];if(F||(A.slice(-1)!=="/"&&(A+="/"),F=this.files[A]),F&&!F.dir)delete this.files[A];else for(var z=this.filter(function(B,Z){return Z.name.slice(0,A.length)===A}),W=0;W<z.length;W++)delete this.files[z[W].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(A){var F,z={};try{if((z=o.extend(A||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=z.type.toLowerCase(),z.compression=z.compression.toUpperCase(),z.type==="binarystring"&&(z.type="string"),!z.type)throw new Error("No output type specified.");o.checkSupport(z.type),z.platform!=="darwin"&&z.platform!=="freebsd"&&z.platform!=="linux"&&z.platform!=="sunos"||(z.platform="UNIX"),z.platform==="win32"&&(z.platform="DOS");var W=z.comment||this.comment||"";F=d.generateWorker(this,z,W)}catch(B){(F=new l("error")).error(B)}return new h(F,z.type||"string",z.mimeType)},generateAsync:function(A,F){return this.generateInternalStream(A).accumulate(F)},generateNodeStream:function(A,F){return(A=A||{}).type||(A.type="nodebuffer"),this.generateInternalStream(A).toNodejsStream(F)}};n.exports=P},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,n,i){n.exports=e("stream")},{stream:void 0}],17:[function(e,n,i){var a=e("./DataReader");function s(o){a.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}e("../utils").inherits(s,a),s.prototype.byteAt=function(o){return this.data[this.zero+o]},s.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),h=o.charCodeAt(1),b=o.charCodeAt(2),g=o.charCodeAt(3),v=this.length-4;0<=v;--v)if(this.data[v]===l&&this.data[v+1]===h&&this.data[v+2]===b&&this.data[v+3]===g)return v-this.zero;return-1},s.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),h=o.charCodeAt(1),b=o.charCodeAt(2),g=o.charCodeAt(3),v=this.readData(4);return l===v[0]&&h===v[1]&&b===v[2]&&g===v[3]},s.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=s},{"../utils":32,"./DataReader":18}],18:[function(e,n,i){var a=e("../utils");function s(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,h=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)h=(h<<8)+this.byteAt(l);return this.index+=o,h},readString:function(o){return a.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},n.exports=s},{"../utils":32}],19:[function(e,n,i){var a=e("./Uint8ArrayReader");function s(o){a.call(this,o)}e("../utils").inherits(s,a),s.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,n,i){var a=e("./DataReader");function s(o){a.call(this,o)}e("../utils").inherits(s,a),s.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},s.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},s.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},s.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=s},{"../utils":32,"./DataReader":18}],21:[function(e,n,i){var a=e("./ArrayReader");function s(o){a.call(this,o)}e("../utils").inherits(s,a),s.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(e,n,i){var a=e("../utils"),s=e("../support"),o=e("./ArrayReader"),l=e("./StringReader"),h=e("./NodeBufferReader"),b=e("./Uint8ArrayReader");n.exports=function(g){var v=a.getTypeOf(g);return a.checkSupport(v),v!=="string"||s.uint8array?v==="nodebuffer"?new h(g):s.uint8array?new b(a.transformTo("uint8array",g)):new o(a.transformTo("array",g)):new l(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,n,i){var a=e("./GenericWorker"),s=e("../utils");function o(l){a.call(this,"ConvertWorker to "+l),this.destType=l}s.inherits(o,a),o.prototype.processChunk=function(l){this.push({data:s.transformTo(this.destType,l.data),meta:l.meta})},n.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(e,n,i){var a=e("./GenericWorker"),s=e("../crc32");function o(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(o,a),o.prototype.processChunk=function(l){this.streamInfo.crc32=s(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,n,i){var a=e("../utils"),s=e("./GenericWorker");function o(l){s.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}a.inherits(o,s),o.prototype.processChunk=function(l){if(l){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+l.data.length}s.prototype.processChunk.call(this,l)},n.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(e,n,i){var a=e("../utils"),s=e("./GenericWorker");function o(l){s.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(b){h.dataIsReady=!0,h.data=b,h.max=b&&b.length||0,h.type=a.getTypeOf(b),h.isPaused||h._tickAndRepeat()},function(b){h.error(b)})}a.inherits(o,s),o.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,h=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,h);break;case"uint8array":l=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":l=this.data.slice(this.index,h)}return this.index=h,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(e,n,i){function a(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,o){return this._listeners[s].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,o){if(this._listeners[s])for(var l=0;l<this._listeners[s].length;l++)this._listeners[s][l].call(this,o)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var o=this;return s.on("data",function(l){o.processChunk(l)}),s.on("end",function(){o.end()}),s.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,o){return this.extraStreamInfo[s]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},n.exports=a},{}],29:[function(e,n,i){var a=e("../utils"),s=e("./ConvertWorker"),o=e("./GenericWorker"),l=e("../base64"),h=e("../support"),b=e("../external"),g=null;if(h.nodestream)try{g=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function v(w,f){return new b.Promise(function(p,m){var y=[],x=w._internalType,P=w._outputType,A=w._mimeType;w.on("data",function(F,z){y.push(F),f&&f(z)}).on("error",function(F){y=[],m(F)}).on("end",function(){try{var F=(function(z,W,B){switch(z){case"blob":return a.newBlob(a.transformTo("arraybuffer",W),B);case"base64":return l.encode(W);default:return a.transformTo(z,W)}})(P,(function(z,W){var B,Z=0,Q=null,S=0;for(B=0;B<W.length;B++)S+=W[B].length;switch(z){case"string":return W.join("");case"array":return Array.prototype.concat.apply([],W);case"uint8array":for(Q=new Uint8Array(S),B=0;B<W.length;B++)Q.set(W[B],Z),Z+=W[B].length;return Q;case"nodebuffer":return Buffer.concat(W);default:throw new Error("concat : unsupported type '"+z+"'")}})(x,y),A);p(F)}catch(z){m(z)}y=[]}).resume()})}function d(w,f,p){var m=f;switch(f){case"blob":case"arraybuffer":m="uint8array";break;case"base64":m="string"}try{this._internalType=m,this._outputType=f,this._mimeType=p,a.checkSupport(m),this._worker=w.pipe(new s(m)),w.lock()}catch(y){this._worker=new o("error"),this._worker.error(y)}}d.prototype={accumulate:function(w){return v(this,w)},on:function(w,f){var p=this;return w==="data"?this._worker.on(w,function(m){f.call(p,m.data,m.meta)}):this._worker.on(w,function(){a.delay(f,arguments,p)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(w){if(a.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},w)}},n.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var a=new ArrayBuffer(0);try{i.blob=new Blob([a],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(a),i.blob=s.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(e,n,i){for(var a=e("./utils"),s=e("./support"),o=e("./nodejsUtils"),l=e("./stream/GenericWorker"),h=new Array(256),b=0;b<256;b++)h[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;h[254]=h[254]=1;function g(){l.call(this,"utf-8 decode"),this.leftOver=null}function v(){l.call(this,"utf-8 encode")}i.utf8encode=function(d){return s.nodebuffer?o.newBufferFrom(d,"utf-8"):(function(w){var f,p,m,y,x,P=w.length,A=0;for(y=0;y<P;y++)(64512&(p=w.charCodeAt(y)))==55296&&y+1<P&&(64512&(m=w.charCodeAt(y+1)))==56320&&(p=65536+(p-55296<<10)+(m-56320),y++),A+=p<128?1:p<2048?2:p<65536?3:4;for(f=s.uint8array?new Uint8Array(A):new Array(A),y=x=0;x<A;y++)(64512&(p=w.charCodeAt(y)))==55296&&y+1<P&&(64512&(m=w.charCodeAt(y+1)))==56320&&(p=65536+(p-55296<<10)+(m-56320),y++),p<128?f[x++]=p:(p<2048?f[x++]=192|p>>>6:(p<65536?f[x++]=224|p>>>12:(f[x++]=240|p>>>18,f[x++]=128|p>>>12&63),f[x++]=128|p>>>6&63),f[x++]=128|63&p);return f})(d)},i.utf8decode=function(d){return s.nodebuffer?a.transformTo("nodebuffer",d).toString("utf-8"):(function(w){var f,p,m,y,x=w.length,P=new Array(2*x);for(f=p=0;f<x;)if((m=w[f++])<128)P[p++]=m;else if(4<(y=h[m]))P[p++]=65533,f+=y-1;else{for(m&=y===2?31:y===3?15:7;1<y&&f<x;)m=m<<6|63&w[f++],y--;1<y?P[p++]=65533:m<65536?P[p++]=m:(m-=65536,P[p++]=55296|m>>10&1023,P[p++]=56320|1023&m)}return P.length!==p&&(P.subarray?P=P.subarray(0,p):P.length=p),a.applyFromCharCode(P)})(d=a.transformTo(s.uint8array?"uint8array":"array",d))},a.inherits(g,l),g.prototype.processChunk=function(d){var w=a.transformTo(s.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var f=w;(w=new Uint8Array(f.length+this.leftOver.length)).set(this.leftOver,0),w.set(f,this.leftOver.length)}else w=this.leftOver.concat(w);this.leftOver=null}var p=(function(y,x){var P;for((x=x||y.length)>y.length&&(x=y.length),P=x-1;0<=P&&(192&y[P])==128;)P--;return P<0||P===0?x:P+h[y[P]]>x?P:x})(w),m=w;p!==w.length&&(s.uint8array?(m=w.subarray(0,p),this.leftOver=w.subarray(p,w.length)):(m=w.slice(0,p),this.leftOver=w.slice(p,w.length))),this.push({data:i.utf8decode(m),meta:d.meta})},g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=g,a.inherits(v,l),v.prototype.processChunk=function(d){this.push({data:i.utf8encode(d.data),meta:d.meta})},i.Utf8EncodeWorker=v},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,n,i){var a=e("./support"),s=e("./base64"),o=e("./nodejsUtils"),l=e("./external");function h(f){return f}function b(f,p){for(var m=0;m<f.length;++m)p[m]=255&f.charCodeAt(m);return p}e("setimmediate"),i.newBlob=function(f,p){i.checkSupport("blob");try{return new Blob([f],{type:p})}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return m.append(f),m.getBlob(p)}catch{throw new Error("Bug : can't construct the Blob.")}}};var g={stringifyByChunk:function(f,p,m){var y=[],x=0,P=f.length;if(P<=m)return String.fromCharCode.apply(null,f);for(;x<P;)p==="array"||p==="nodebuffer"?y.push(String.fromCharCode.apply(null,f.slice(x,Math.min(x+m,P)))):y.push(String.fromCharCode.apply(null,f.subarray(x,Math.min(x+m,P)))),x+=m;return y.join("")},stringifyByChar:function(f){for(var p="",m=0;m<f.length;m++)p+=String.fromCharCode(f[m]);return p},applyCanBeUsed:{uint8array:(function(){try{return a.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return a.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}})()}};function v(f){var p=65536,m=i.getTypeOf(f),y=!0;if(m==="uint8array"?y=g.applyCanBeUsed.uint8array:m==="nodebuffer"&&(y=g.applyCanBeUsed.nodebuffer),y)for(;1<p;)try{return g.stringifyByChunk(f,m,p)}catch{p=Math.floor(p/2)}return g.stringifyByChar(f)}function d(f,p){for(var m=0;m<f.length;m++)p[m]=f[m];return p}i.applyFromCharCode=v;var w={};w.string={string:h,array:function(f){return b(f,new Array(f.length))},arraybuffer:function(f){return w.string.uint8array(f).buffer},uint8array:function(f){return b(f,new Uint8Array(f.length))},nodebuffer:function(f){return b(f,o.allocBuffer(f.length))}},w.array={string:v,array:h,arraybuffer:function(f){return new Uint8Array(f).buffer},uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return o.newBufferFrom(f)}},w.arraybuffer={string:function(f){return v(new Uint8Array(f))},array:function(f){return d(new Uint8Array(f),new Array(f.byteLength))},arraybuffer:h,uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return o.newBufferFrom(new Uint8Array(f))}},w.uint8array={string:v,array:function(f){return d(f,new Array(f.length))},arraybuffer:function(f){return f.buffer},uint8array:h,nodebuffer:function(f){return o.newBufferFrom(f)}},w.nodebuffer={string:v,array:function(f){return d(f,new Array(f.length))},arraybuffer:function(f){return w.nodebuffer.uint8array(f).buffer},uint8array:function(f){return d(f,new Uint8Array(f.length))},nodebuffer:h},i.transformTo=function(f,p){if(p=p||"",!f)return p;i.checkSupport(f);var m=i.getTypeOf(p);return w[m][f](p)},i.resolve=function(f){for(var p=f.split("/"),m=[],y=0;y<p.length;y++){var x=p[y];x==="."||x===""&&y!==0&&y!==p.length-1||(x===".."?m.pop():m.push(x))}return m.join("/")},i.getTypeOf=function(f){return typeof f=="string"?"string":Object.prototype.toString.call(f)==="[object Array]"?"array":a.nodebuffer&&o.isBuffer(f)?"nodebuffer":a.uint8array&&f instanceof Uint8Array?"uint8array":a.arraybuffer&&f instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(f){if(!a[f.toLowerCase()])throw new Error(f+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(f){var p,m,y="";for(m=0;m<(f||"").length;m++)y+="\\x"+((p=f.charCodeAt(m))<16?"0":"")+p.toString(16).toUpperCase();return y},i.delay=function(f,p,m){setImmediate(function(){f.apply(m||null,p||[])})},i.inherits=function(f,p){function m(){}m.prototype=p.prototype,f.prototype=new m},i.extend=function(){var f,p,m={};for(f=0;f<arguments.length;f++)for(p in arguments[f])Object.prototype.hasOwnProperty.call(arguments[f],p)&&m[p]===void 0&&(m[p]=arguments[f][p]);return m},i.prepareContent=function(f,p,m,y,x){return l.Promise.resolve(p).then(function(P){return a.blob&&(P instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(P))!==-1)&&typeof FileReader<"u"?new l.Promise(function(A,F){var z=new FileReader;z.onload=function(W){A(W.target.result)},z.onerror=function(W){F(W.target.error)},z.readAsArrayBuffer(P)}):P}).then(function(P){var A=i.getTypeOf(P);return A?(A==="arraybuffer"?P=i.transformTo("uint8array",P):A==="string"&&(x?P=s.decode(P):m&&y!==!0&&(P=(function(F){return b(F,a.uint8array?new Uint8Array(F.length):new Array(F.length))})(P))),P):l.Promise.reject(new Error("Can't read the data of '"+f+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,n,i){var a=e("./reader/readerFor"),s=e("./utils"),o=e("./signature"),l=e("./zipEntry"),h=e("./support");function b(g){this.files=[],this.loadOptions=g}b.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var v=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(v)+", expected "+s.pretty(g)+")")}},isSignature:function(g,v){var d=this.reader.index;this.reader.setIndex(g);var w=this.reader.readString(4)===v;return this.reader.setIndex(d),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),v=h.uint8array?"uint8array":"array",d=s.transformTo(v,g);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,v,d,w=this.zip64EndOfCentralSize-44;0<w;)g=this.reader.readInt(2),v=this.reader.readInt(4),d=this.reader.readData(v),this.zip64ExtensibleData[g]={id:g,length:v,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,v;for(g=0;g<this.files.length;g++)v=this.files[g],this.reader.setIndex(v.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),v.readLocalPart(this.reader),v.handleUTF8(),v.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(g=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var v=g;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var w=v-d;if(0<w)this.isSignature(v,o.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(g){this.reader=a(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=b},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,n,i){var a=e("./reader/readerFor"),s=e("./utils"),o=e("./compressedObject"),l=e("./crc32"),h=e("./utf8"),b=e("./compressions"),g=e("./support");function v(d,w){this.options=d,this.loadOptions=w}v.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(d){var w,f;if(d.skip(22),this.fileNameLength=d.readInt(2),f=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(f),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((w=(function(p){for(var m in b)if(Object.prototype.hasOwnProperty.call(b,m)&&b[m].magic===p)return b[m];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,w,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var w=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(w),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),d==0&&(this.dosPermissions=63&this.externalFileAttributes),d==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=a(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var w,f,p,m=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<m;)w=d.readInt(2),f=d.readInt(2),p=d.readData(f),this.extraFields[w]={id:w,length:f,value:p};d.setIndex(m)},handleUTF8:function(){var d=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var w=this.findExtraFieldUnicodePath();if(w!==null)this.fileNameStr=w;else{var f=s.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(f)}var p=this.findExtraFieldUnicodeComment();if(p!==null)this.fileCommentStr=p;else{var m=s.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(m)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var w=a(d.value);return w.readInt(1)!==1||l(this.fileName)!==w.readInt(4)?null:h.utf8decode(w.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var w=a(d.value);return w.readInt(1)!==1||l(this.fileComment)!==w.readInt(4)?null:h.utf8decode(w.readData(d.length-5))}return null}},n.exports=v},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,n,i){function a(w,f,p){this.name=w,this.dir=p.dir,this.date=p.date,this.comment=p.comment,this.unixPermissions=p.unixPermissions,this.dosPermissions=p.dosPermissions,this._data=f,this._dataBinary=p.binary,this.options={compression:p.compression,compressionOptions:p.compressionOptions}}var s=e("./stream/StreamHelper"),o=e("./stream/DataWorker"),l=e("./utf8"),h=e("./compressedObject"),b=e("./stream/GenericWorker");a.prototype={internalStream:function(w){var f=null,p="string";try{if(!w)throw new Error("No output type specified.");var m=(p=w.toLowerCase())==="string"||p==="text";p!=="binarystring"&&p!=="text"||(p="string"),f=this._decompressWorker();var y=!this._dataBinary;y&&!m&&(f=f.pipe(new l.Utf8EncodeWorker)),!y&&m&&(f=f.pipe(new l.Utf8DecodeWorker))}catch(x){(f=new b("error")).error(x)}return new s(f,p,"")},async:function(w,f){return this.internalStream(w).accumulate(f)},nodeStream:function(w,f){return this.internalStream(w||"nodebuffer").toNodejsStream(f)},_compressWorker:function(w,f){if(this._data instanceof h&&this._data.compression.magic===w.magic)return this._data.getCompressedWorker();var p=this._decompressWorker();return this._dataBinary||(p=p.pipe(new l.Utf8EncodeWorker)),h.createWorkerFrom(p,w,f)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof b?this._data:new o(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],v=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<g.length;d++)a.prototype[g[d]]=v;n.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,n,i){(function(a){var s,o,l=a.MutationObserver||a.WebKitMutationObserver;if(l){var h=0,b=new l(w),g=a.document.createTextNode("");b.observe(g,{characterData:!0}),s=function(){g.data=h=++h%2}}else if(a.setImmediate||a.MessageChannel===void 0)s="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var f=a.document.createElement("script");f.onreadystatechange=function(){w(),f.onreadystatechange=null,f.parentNode.removeChild(f),f=null},a.document.documentElement.appendChild(f)}:function(){setTimeout(w,0)};else{var v=new a.MessageChannel;v.port1.onmessage=w,s=function(){v.port2.postMessage(0)}}var d=[];function w(){var f,p;o=!0;for(var m=d.length;m;){for(p=d,d=[],f=-1;++f<m;)p[f]();m=d.length}o=!1}n.exports=function(f){d.push(f)!==1||o||s()}}).call(this,typeof ke<"u"?ke:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,n,i){var a=e("immediate");function s(){}var o={},l=["REJECTED"],h=["FULFILLED"],b=["PENDING"];function g(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=b,this.queue=[],this.outcome=void 0,m!==s&&f(this,m)}function v(m,y,x){this.promise=m,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof x=="function"&&(this.onRejected=x,this.callRejected=this.otherCallRejected)}function d(m,y,x){a(function(){var P;try{P=y(x)}catch(A){return o.reject(m,A)}P===m?o.reject(m,new TypeError("Cannot resolve promise with itself")):o.resolve(m,P)})}function w(m){var y=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof y=="function")return function(){y.apply(m,arguments)}}function f(m,y){var x=!1;function P(z){x||(x=!0,o.reject(m,z))}function A(z){x||(x=!0,o.resolve(m,z))}var F=p(function(){y(A,P)});F.status==="error"&&P(F.value)}function p(m,y){var x={};try{x.value=m(y),x.status="success"}catch(P){x.status="error",x.value=P}return x}(n.exports=g).prototype.finally=function(m){if(typeof m!="function")return this;var y=this.constructor;return this.then(function(x){return y.resolve(m()).then(function(){return x})},function(x){return y.resolve(m()).then(function(){throw x})})},g.prototype.catch=function(m){return this.then(null,m)},g.prototype.then=function(m,y){if(typeof m!="function"&&this.state===h||typeof y!="function"&&this.state===l)return this;var x=new this.constructor(s);return this.state!==b?d(x,this.state===h?m:y,this.outcome):this.queue.push(new v(x,m,y)),x},v.prototype.callFulfilled=function(m){o.resolve(this.promise,m)},v.prototype.otherCallFulfilled=function(m){d(this.promise,this.onFulfilled,m)},v.prototype.callRejected=function(m){o.reject(this.promise,m)},v.prototype.otherCallRejected=function(m){d(this.promise,this.onRejected,m)},o.resolve=function(m,y){var x=p(w,y);if(x.status==="error")return o.reject(m,x.value);var P=x.value;if(P)f(m,P);else{m.state=h,m.outcome=y;for(var A=-1,F=m.queue.length;++A<F;)m.queue[A].callFulfilled(y)}return m},o.reject=function(m,y){m.state=l,m.outcome=y;for(var x=-1,P=m.queue.length;++x<P;)m.queue[x].callRejected(y);return m},g.resolve=function(m){return m instanceof this?m:o.resolve(new this(s),m)},g.reject=function(m){var y=new this(s);return o.reject(y,m)},g.all=function(m){var y=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=m.length,P=!1;if(!x)return this.resolve([]);for(var A=new Array(x),F=0,z=-1,W=new this(s);++z<x;)B(m[z],z);return W;function B(Z,Q){y.resolve(Z).then(function(S){A[Q]=S,++F!==x||P||(P=!0,o.resolve(W,A))},function(S){P||(P=!0,o.reject(W,S))})}},g.race=function(m){var y=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=m.length,P=!1;if(!x)return this.resolve([]);for(var A=-1,F=new this(s);++A<x;)z=m[A],y.resolve(z).then(function(W){P||(P=!0,o.resolve(F,W))},function(W){P||(P=!0,o.reject(F,W))});var z;return F}},{immediate:36}],38:[function(e,n,i){var a={};(0,e("./lib/utils/common").assign)(a,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),n.exports=a},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,n,i){var a=e("./zlib/deflate"),s=e("./utils/common"),o=e("./utils/strings"),l=e("./zlib/messages"),h=e("./zlib/zstream"),b=Object.prototype.toString,g=0,v=-1,d=0,w=8;function f(m){if(!(this instanceof f))return new f(m);this.options=s.assign({level:v,method:w,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},m||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var x=a.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(x!==g)throw new Error(l[x]);if(y.header&&a.deflateSetHeader(this.strm,y.header),y.dictionary){var P;if(P=typeof y.dictionary=="string"?o.string2buf(y.dictionary):b.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(x=a.deflateSetDictionary(this.strm,P))!==g)throw new Error(l[x]);this._dict_set=!0}}function p(m,y){var x=new f(y);if(x.push(m,!0),x.err)throw x.msg||l[x.err];return x.result}f.prototype.push=function(m,y){var x,P,A=this.strm,F=this.options.chunkSize;if(this.ended)return!1;P=y===~~y?y:y===!0?4:0,typeof m=="string"?A.input=o.string2buf(m):b.call(m)==="[object ArrayBuffer]"?A.input=new Uint8Array(m):A.input=m,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new s.Buf8(F),A.next_out=0,A.avail_out=F),(x=a.deflate(A,P))!==1&&x!==g)return this.onEnd(x),!(this.ended=!0);A.avail_out!==0&&(A.avail_in!==0||P!==4&&P!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(s.shrinkBuf(A.output,A.next_out))):this.onData(s.shrinkBuf(A.output,A.next_out)))}while((0<A.avail_in||A.avail_out===0)&&x!==1);return P===4?(x=a.deflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===g):P!==2||(this.onEnd(g),!(A.avail_out=0))},f.prototype.onData=function(m){this.chunks.push(m)},f.prototype.onEnd=function(m){m===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},i.Deflate=f,i.deflate=p,i.deflateRaw=function(m,y){return(y=y||{}).raw=!0,p(m,y)},i.gzip=function(m,y){return(y=y||{}).gzip=!0,p(m,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,n,i){var a=e("./zlib/inflate"),s=e("./utils/common"),o=e("./utils/strings"),l=e("./zlib/constants"),h=e("./zlib/messages"),b=e("./zlib/zstream"),g=e("./zlib/gzheader"),v=Object.prototype.toString;function d(f){if(!(this instanceof d))return new d(f);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},f||{});var p=this.options;p.raw&&0<=p.windowBits&&p.windowBits<16&&(p.windowBits=-p.windowBits,p.windowBits===0&&(p.windowBits=-15)),!(0<=p.windowBits&&p.windowBits<16)||f&&f.windowBits||(p.windowBits+=32),15<p.windowBits&&p.windowBits<48&&(15&p.windowBits)==0&&(p.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var m=a.inflateInit2(this.strm,p.windowBits);if(m!==l.Z_OK)throw new Error(h[m]);this.header=new g,a.inflateGetHeader(this.strm,this.header)}function w(f,p){var m=new d(p);if(m.push(f,!0),m.err)throw m.msg||h[m.err];return m.result}d.prototype.push=function(f,p){var m,y,x,P,A,F,z=this.strm,W=this.options.chunkSize,B=this.options.dictionary,Z=!1;if(this.ended)return!1;y=p===~~p?p:p===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof f=="string"?z.input=o.binstring2buf(f):v.call(f)==="[object ArrayBuffer]"?z.input=new Uint8Array(f):z.input=f,z.next_in=0,z.avail_in=z.input.length;do{if(z.avail_out===0&&(z.output=new s.Buf8(W),z.next_out=0,z.avail_out=W),(m=a.inflate(z,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&B&&(F=typeof B=="string"?o.string2buf(B):v.call(B)==="[object ArrayBuffer]"?new Uint8Array(B):B,m=a.inflateSetDictionary(this.strm,F)),m===l.Z_BUF_ERROR&&Z===!0&&(m=l.Z_OK,Z=!1),m!==l.Z_STREAM_END&&m!==l.Z_OK)return this.onEnd(m),!(this.ended=!0);z.next_out&&(z.avail_out!==0&&m!==l.Z_STREAM_END&&(z.avail_in!==0||y!==l.Z_FINISH&&y!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(x=o.utf8border(z.output,z.next_out),P=z.next_out-x,A=o.buf2string(z.output,x),z.next_out=P,z.avail_out=W-P,P&&s.arraySet(z.output,z.output,x,P,0),this.onData(A)):this.onData(s.shrinkBuf(z.output,z.next_out)))),z.avail_in===0&&z.avail_out===0&&(Z=!0)}while((0<z.avail_in||z.avail_out===0)&&m!==l.Z_STREAM_END);return m===l.Z_STREAM_END&&(y=l.Z_FINISH),y===l.Z_FINISH?(m=a.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===l.Z_OK):y!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(z.avail_out=0))},d.prototype.onData=function(f){this.chunks.push(f)},d.prototype.onEnd=function(f){f===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},i.Inflate=d,i.inflate=w,i.inflateRaw=function(f,p){return(p=p||{}).raw=!0,w(f,p)},i.ungzip=w},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,n,i){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var b=h.shift();if(b){if(typeof b!="object")throw new TypeError(b+"must be non-object");for(var g in b)b.hasOwnProperty(g)&&(l[g]=b[g])}}return l},i.shrinkBuf=function(l,h){return l.length===h?l:l.subarray?l.subarray(0,h):(l.length=h,l)};var s={arraySet:function(l,h,b,g,v){if(h.subarray&&l.subarray)l.set(h.subarray(b,b+g),v);else for(var d=0;d<g;d++)l[v+d]=h[b+d]},flattenChunks:function(l){var h,b,g,v,d,w;for(h=g=0,b=l.length;h<b;h++)g+=l[h].length;for(w=new Uint8Array(g),h=v=0,b=l.length;h<b;h++)d=l[h],w.set(d,v),v+=d.length;return w}},o={arraySet:function(l,h,b,g,v){for(var d=0;d<g;d++)l[v+d]=h[b+d]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(a)},{}],42:[function(e,n,i){var a=e("./common"),s=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new a.Buf8(256),h=0;h<256;h++)l[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function b(g,v){if(v<65537&&(g.subarray&&o||!g.subarray&&s))return String.fromCharCode.apply(null,a.shrinkBuf(g,v));for(var d="",w=0;w<v;w++)d+=String.fromCharCode(g[w]);return d}l[254]=l[254]=1,i.string2buf=function(g){var v,d,w,f,p,m=g.length,y=0;for(f=0;f<m;f++)(64512&(d=g.charCodeAt(f)))==55296&&f+1<m&&(64512&(w=g.charCodeAt(f+1)))==56320&&(d=65536+(d-55296<<10)+(w-56320),f++),y+=d<128?1:d<2048?2:d<65536?3:4;for(v=new a.Buf8(y),f=p=0;p<y;f++)(64512&(d=g.charCodeAt(f)))==55296&&f+1<m&&(64512&(w=g.charCodeAt(f+1)))==56320&&(d=65536+(d-55296<<10)+(w-56320),f++),d<128?v[p++]=d:(d<2048?v[p++]=192|d>>>6:(d<65536?v[p++]=224|d>>>12:(v[p++]=240|d>>>18,v[p++]=128|d>>>12&63),v[p++]=128|d>>>6&63),v[p++]=128|63&d);return v},i.buf2binstring=function(g){return b(g,g.length)},i.binstring2buf=function(g){for(var v=new a.Buf8(g.length),d=0,w=v.length;d<w;d++)v[d]=g.charCodeAt(d);return v},i.buf2string=function(g,v){var d,w,f,p,m=v||g.length,y=new Array(2*m);for(d=w=0;d<m;)if((f=g[d++])<128)y[w++]=f;else if(4<(p=l[f]))y[w++]=65533,d+=p-1;else{for(f&=p===2?31:p===3?15:7;1<p&&d<m;)f=f<<6|63&g[d++],p--;1<p?y[w++]=65533:f<65536?y[w++]=f:(f-=65536,y[w++]=55296|f>>10&1023,y[w++]=56320|1023&f)}return b(y,w)},i.utf8border=function(g,v){var d;for((v=v||g.length)>g.length&&(v=g.length),d=v-1;0<=d&&(192&g[d])==128;)d--;return d<0||d===0?v:d+l[g[d]]>v?d:v}},{"./common":41}],43:[function(e,n,i){n.exports=function(a,s,o,l){for(var h=65535&a|0,b=a>>>16&65535|0,g=0;o!==0;){for(o-=g=2e3<o?2e3:o;b=b+(h=h+s[l++]|0)|0,--g;);h%=65521,b%=65521}return h|b<<16|0}},{}],44:[function(e,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,n,i){var a=(function(){for(var s,o=[],l=0;l<256;l++){s=l;for(var h=0;h<8;h++)s=1&s?3988292384^s>>>1:s>>>1;o[l]=s}return o})();n.exports=function(s,o,l,h){var b=a,g=h+l;s^=-1;for(var v=h;v<g;v++)s=s>>>8^b[255&(s^o[v])];return-1^s}},{}],46:[function(e,n,i){var a,s=e("../utils/common"),o=e("./trees"),l=e("./adler32"),h=e("./crc32"),b=e("./messages"),g=0,v=4,d=0,w=-2,f=-1,p=4,m=2,y=8,x=9,P=286,A=30,F=19,z=2*P+1,W=15,B=3,Z=258,Q=Z+B+1,S=42,I=113,u=1,D=2,et=3,U=4;function rt(c,L){return c.msg=b[L],L}function H(c){return(c<<1)-(4<c?9:0)}function tt(c){for(var L=c.length;0<=--L;)c[L]=0}function O(c){var L=c.state,R=L.pending;R>c.avail_out&&(R=c.avail_out),R!==0&&(s.arraySet(c.output,L.pending_buf,L.pending_out,R,c.next_out),c.next_out+=R,L.pending_out+=R,c.total_out+=R,c.avail_out-=R,L.pending-=R,L.pending===0&&(L.pending_out=0))}function N(c,L){o._tr_flush_block(c,0<=c.block_start?c.block_start:-1,c.strstart-c.block_start,L),c.block_start=c.strstart,O(c.strm)}function J(c,L){c.pending_buf[c.pending++]=L}function X(c,L){c.pending_buf[c.pending++]=L>>>8&255,c.pending_buf[c.pending++]=255&L}function K(c,L){var R,k,_=c.max_chain_length,C=c.strstart,$=c.prev_length,j=c.nice_match,M=c.strstart>c.w_size-Q?c.strstart-(c.w_size-Q):0,V=c.window,q=c.w_mask,G=c.prev,Y=c.strstart+Z,lt=V[C+$-1],at=V[C+$];c.prev_length>=c.good_match&&(_>>=2),j>c.lookahead&&(j=c.lookahead);do if(V[(R=L)+$]===at&&V[R+$-1]===lt&&V[R]===V[C]&&V[++R]===V[C+1]){C+=2,R++;do;while(V[++C]===V[++R]&&V[++C]===V[++R]&&V[++C]===V[++R]&&V[++C]===V[++R]&&V[++C]===V[++R]&&V[++C]===V[++R]&&V[++C]===V[++R]&&V[++C]===V[++R]&&C<Y);if(k=Z-(Y-C),C=Y-Z,$<k){if(c.match_start=L,j<=($=k))break;lt=V[C+$-1],at=V[C+$]}}while((L=G[L&q])>M&&--_!=0);return $<=c.lookahead?$:c.lookahead}function ht(c){var L,R,k,_,C,$,j,M,V,q,G=c.w_size;do{if(_=c.window_size-c.lookahead-c.strstart,c.strstart>=G+(G-Q)){for(s.arraySet(c.window,c.window,G,G,0),c.match_start-=G,c.strstart-=G,c.block_start-=G,L=R=c.hash_size;k=c.head[--L],c.head[L]=G<=k?k-G:0,--R;);for(L=R=G;k=c.prev[--L],c.prev[L]=G<=k?k-G:0,--R;);_+=G}if(c.strm.avail_in===0)break;if($=c.strm,j=c.window,M=c.strstart+c.lookahead,V=_,q=void 0,q=$.avail_in,V<q&&(q=V),R=q===0?0:($.avail_in-=q,s.arraySet(j,$.input,$.next_in,q,M),$.state.wrap===1?$.adler=l($.adler,j,q,M):$.state.wrap===2&&($.adler=h($.adler,j,q,M)),$.next_in+=q,$.total_in+=q,q),c.lookahead+=R,c.lookahead+c.insert>=B)for(C=c.strstart-c.insert,c.ins_h=c.window[C],c.ins_h=(c.ins_h<<c.hash_shift^c.window[C+1])&c.hash_mask;c.insert&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[C+B-1])&c.hash_mask,c.prev[C&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=C,C++,c.insert--,!(c.lookahead+c.insert<B)););}while(c.lookahead<Q&&c.strm.avail_in!==0)}function _t(c,L){for(var R,k;;){if(c.lookahead<Q){if(ht(c),c.lookahead<Q&&L===g)return u;if(c.lookahead===0)break}if(R=0,c.lookahead>=B&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+B-1])&c.hash_mask,R=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),R!==0&&c.strstart-R<=c.w_size-Q&&(c.match_length=K(c,R)),c.match_length>=B)if(k=o._tr_tally(c,c.strstart-c.match_start,c.match_length-B),c.lookahead-=c.match_length,c.match_length<=c.max_lazy_match&&c.lookahead>=B){for(c.match_length--;c.strstart++,c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+B-1])&c.hash_mask,R=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart,--c.match_length!=0;);c.strstart++}else c.strstart+=c.match_length,c.match_length=0,c.ins_h=c.window[c.strstart],c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+1])&c.hash_mask;else k=o._tr_tally(c,0,c.window[c.strstart]),c.lookahead--,c.strstart++;if(k&&(N(c,!1),c.strm.avail_out===0))return u}return c.insert=c.strstart<B-1?c.strstart:B-1,L===v?(N(c,!0),c.strm.avail_out===0?et:U):c.last_lit&&(N(c,!1),c.strm.avail_out===0)?u:D}function it(c,L){for(var R,k,_;;){if(c.lookahead<Q){if(ht(c),c.lookahead<Q&&L===g)return u;if(c.lookahead===0)break}if(R=0,c.lookahead>=B&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+B-1])&c.hash_mask,R=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),c.prev_length=c.match_length,c.prev_match=c.match_start,c.match_length=B-1,R!==0&&c.prev_length<c.max_lazy_match&&c.strstart-R<=c.w_size-Q&&(c.match_length=K(c,R),c.match_length<=5&&(c.strategy===1||c.match_length===B&&4096<c.strstart-c.match_start)&&(c.match_length=B-1)),c.prev_length>=B&&c.match_length<=c.prev_length){for(_=c.strstart+c.lookahead-B,k=o._tr_tally(c,c.strstart-1-c.prev_match,c.prev_length-B),c.lookahead-=c.prev_length-1,c.prev_length-=2;++c.strstart<=_&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+B-1])&c.hash_mask,R=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),--c.prev_length!=0;);if(c.match_available=0,c.match_length=B-1,c.strstart++,k&&(N(c,!1),c.strm.avail_out===0))return u}else if(c.match_available){if((k=o._tr_tally(c,0,c.window[c.strstart-1]))&&N(c,!1),c.strstart++,c.lookahead--,c.strm.avail_out===0)return u}else c.match_available=1,c.strstart++,c.lookahead--}return c.match_available&&(k=o._tr_tally(c,0,c.window[c.strstart-1]),c.match_available=0),c.insert=c.strstart<B-1?c.strstart:B-1,L===v?(N(c,!0),c.strm.avail_out===0?et:U):c.last_lit&&(N(c,!1),c.strm.avail_out===0)?u:D}function st(c,L,R,k,_){this.good_length=c,this.max_lazy=L,this.nice_length=R,this.max_chain=k,this.func=_}function bt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*z),this.dyn_dtree=new s.Buf16(2*(2*A+1)),this.bl_tree=new s.Buf16(2*(2*F+1)),tt(this.dyn_ltree),tt(this.dyn_dtree),tt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(W+1),this.heap=new s.Buf16(2*P+1),tt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*P+1),tt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function dt(c){var L;return c&&c.state?(c.total_in=c.total_out=0,c.data_type=m,(L=c.state).pending=0,L.pending_out=0,L.wrap<0&&(L.wrap=-L.wrap),L.status=L.wrap?S:I,c.adler=L.wrap===2?0:1,L.last_flush=g,o._tr_init(L),d):rt(c,w)}function Ct(c){var L=dt(c);return L===d&&(function(R){R.window_size=2*R.w_size,tt(R.head),R.max_lazy_match=a[R.level].max_lazy,R.good_match=a[R.level].good_length,R.nice_match=a[R.level].nice_length,R.max_chain_length=a[R.level].max_chain,R.strstart=0,R.block_start=0,R.lookahead=0,R.insert=0,R.match_length=R.prev_length=B-1,R.match_available=0,R.ins_h=0})(c.state),L}function xt(c,L,R,k,_,C){if(!c)return w;var $=1;if(L===f&&(L=6),k<0?($=0,k=-k):15<k&&($=2,k-=16),_<1||x<_||R!==y||k<8||15<k||L<0||9<L||C<0||p<C)return rt(c,w);k===8&&(k=9);var j=new bt;return(c.state=j).strm=c,j.wrap=$,j.gzhead=null,j.w_bits=k,j.w_size=1<<j.w_bits,j.w_mask=j.w_size-1,j.hash_bits=_+7,j.hash_size=1<<j.hash_bits,j.hash_mask=j.hash_size-1,j.hash_shift=~~((j.hash_bits+B-1)/B),j.window=new s.Buf8(2*j.w_size),j.head=new s.Buf16(j.hash_size),j.prev=new s.Buf16(j.w_size),j.lit_bufsize=1<<_+6,j.pending_buf_size=4*j.lit_bufsize,j.pending_buf=new s.Buf8(j.pending_buf_size),j.d_buf=1*j.lit_bufsize,j.l_buf=3*j.lit_bufsize,j.level=L,j.strategy=C,j.method=R,Ct(c)}a=[new st(0,0,0,0,function(c,L){var R=65535;for(R>c.pending_buf_size-5&&(R=c.pending_buf_size-5);;){if(c.lookahead<=1){if(ht(c),c.lookahead===0&&L===g)return u;if(c.lookahead===0)break}c.strstart+=c.lookahead,c.lookahead=0;var k=c.block_start+R;if((c.strstart===0||c.strstart>=k)&&(c.lookahead=c.strstart-k,c.strstart=k,N(c,!1),c.strm.avail_out===0)||c.strstart-c.block_start>=c.w_size-Q&&(N(c,!1),c.strm.avail_out===0))return u}return c.insert=0,L===v?(N(c,!0),c.strm.avail_out===0?et:U):(c.strstart>c.block_start&&(N(c,!1),c.strm.avail_out),u)}),new st(4,4,8,4,_t),new st(4,5,16,8,_t),new st(4,6,32,32,_t),new st(4,4,16,16,it),new st(8,16,32,32,it),new st(8,16,128,128,it),new st(8,32,128,256,it),new st(32,128,258,1024,it),new st(32,258,258,4096,it)],i.deflateInit=function(c,L){return xt(c,L,y,15,8,0)},i.deflateInit2=xt,i.deflateReset=Ct,i.deflateResetKeep=dt,i.deflateSetHeader=function(c,L){return c&&c.state?c.state.wrap!==2?w:(c.state.gzhead=L,d):w},i.deflate=function(c,L){var R,k,_,C;if(!c||!c.state||5<L||L<0)return c?rt(c,w):w;if(k=c.state,!c.output||!c.input&&c.avail_in!==0||k.status===666&&L!==v)return rt(c,c.avail_out===0?-5:w);if(k.strm=c,R=k.last_flush,k.last_flush=L,k.status===S)if(k.wrap===2)c.adler=0,J(k,31),J(k,139),J(k,8),k.gzhead?(J(k,(k.gzhead.text?1:0)+(k.gzhead.hcrc?2:0)+(k.gzhead.extra?4:0)+(k.gzhead.name?8:0)+(k.gzhead.comment?16:0)),J(k,255&k.gzhead.time),J(k,k.gzhead.time>>8&255),J(k,k.gzhead.time>>16&255),J(k,k.gzhead.time>>24&255),J(k,k.level===9?2:2<=k.strategy||k.level<2?4:0),J(k,255&k.gzhead.os),k.gzhead.extra&&k.gzhead.extra.length&&(J(k,255&k.gzhead.extra.length),J(k,k.gzhead.extra.length>>8&255)),k.gzhead.hcrc&&(c.adler=h(c.adler,k.pending_buf,k.pending,0)),k.gzindex=0,k.status=69):(J(k,0),J(k,0),J(k,0),J(k,0),J(k,0),J(k,k.level===9?2:2<=k.strategy||k.level<2?4:0),J(k,3),k.status=I);else{var $=y+(k.w_bits-8<<4)<<8;$|=(2<=k.strategy||k.level<2?0:k.level<6?1:k.level===6?2:3)<<6,k.strstart!==0&&($|=32),$+=31-$%31,k.status=I,X(k,$),k.strstart!==0&&(X(k,c.adler>>>16),X(k,65535&c.adler)),c.adler=1}if(k.status===69)if(k.gzhead.extra){for(_=k.pending;k.gzindex<(65535&k.gzhead.extra.length)&&(k.pending!==k.pending_buf_size||(k.gzhead.hcrc&&k.pending>_&&(c.adler=h(c.adler,k.pending_buf,k.pending-_,_)),O(c),_=k.pending,k.pending!==k.pending_buf_size));)J(k,255&k.gzhead.extra[k.gzindex]),k.gzindex++;k.gzhead.hcrc&&k.pending>_&&(c.adler=h(c.adler,k.pending_buf,k.pending-_,_)),k.gzindex===k.gzhead.extra.length&&(k.gzindex=0,k.status=73)}else k.status=73;if(k.status===73)if(k.gzhead.name){_=k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>_&&(c.adler=h(c.adler,k.pending_buf,k.pending-_,_)),O(c),_=k.pending,k.pending===k.pending_buf_size)){C=1;break}C=k.gzindex<k.gzhead.name.length?255&k.gzhead.name.charCodeAt(k.gzindex++):0,J(k,C)}while(C!==0);k.gzhead.hcrc&&k.pending>_&&(c.adler=h(c.adler,k.pending_buf,k.pending-_,_)),C===0&&(k.gzindex=0,k.status=91)}else k.status=91;if(k.status===91)if(k.gzhead.comment){_=k.pending;do{if(k.pending===k.pending_buf_size&&(k.gzhead.hcrc&&k.pending>_&&(c.adler=h(c.adler,k.pending_buf,k.pending-_,_)),O(c),_=k.pending,k.pending===k.pending_buf_size)){C=1;break}C=k.gzindex<k.gzhead.comment.length?255&k.gzhead.comment.charCodeAt(k.gzindex++):0,J(k,C)}while(C!==0);k.gzhead.hcrc&&k.pending>_&&(c.adler=h(c.adler,k.pending_buf,k.pending-_,_)),C===0&&(k.status=103)}else k.status=103;if(k.status===103&&(k.gzhead.hcrc?(k.pending+2>k.pending_buf_size&&O(c),k.pending+2<=k.pending_buf_size&&(J(k,255&c.adler),J(k,c.adler>>8&255),c.adler=0,k.status=I)):k.status=I),k.pending!==0){if(O(c),c.avail_out===0)return k.last_flush=-1,d}else if(c.avail_in===0&&H(L)<=H(R)&&L!==v)return rt(c,-5);if(k.status===666&&c.avail_in!==0)return rt(c,-5);if(c.avail_in!==0||k.lookahead!==0||L!==g&&k.status!==666){var j=k.strategy===2?(function(M,V){for(var q;;){if(M.lookahead===0&&(ht(M),M.lookahead===0)){if(V===g)return u;break}if(M.match_length=0,q=o._tr_tally(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++,q&&(N(M,!1),M.strm.avail_out===0))return u}return M.insert=0,V===v?(N(M,!0),M.strm.avail_out===0?et:U):M.last_lit&&(N(M,!1),M.strm.avail_out===0)?u:D})(k,L):k.strategy===3?(function(M,V){for(var q,G,Y,lt,at=M.window;;){if(M.lookahead<=Z){if(ht(M),M.lookahead<=Z&&V===g)return u;if(M.lookahead===0)break}if(M.match_length=0,M.lookahead>=B&&0<M.strstart&&(G=at[Y=M.strstart-1])===at[++Y]&&G===at[++Y]&&G===at[++Y]){lt=M.strstart+Z;do;while(G===at[++Y]&&G===at[++Y]&&G===at[++Y]&&G===at[++Y]&&G===at[++Y]&&G===at[++Y]&&G===at[++Y]&&G===at[++Y]&&Y<lt);M.match_length=Z-(lt-Y),M.match_length>M.lookahead&&(M.match_length=M.lookahead)}if(M.match_length>=B?(q=o._tr_tally(M,1,M.match_length-B),M.lookahead-=M.match_length,M.strstart+=M.match_length,M.match_length=0):(q=o._tr_tally(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++),q&&(N(M,!1),M.strm.avail_out===0))return u}return M.insert=0,V===v?(N(M,!0),M.strm.avail_out===0?et:U):M.last_lit&&(N(M,!1),M.strm.avail_out===0)?u:D})(k,L):a[k.level].func(k,L);if(j!==et&&j!==U||(k.status=666),j===u||j===et)return c.avail_out===0&&(k.last_flush=-1),d;if(j===D&&(L===1?o._tr_align(k):L!==5&&(o._tr_stored_block(k,0,0,!1),L===3&&(tt(k.head),k.lookahead===0&&(k.strstart=0,k.block_start=0,k.insert=0))),O(c),c.avail_out===0))return k.last_flush=-1,d}return L!==v?d:k.wrap<=0?1:(k.wrap===2?(J(k,255&c.adler),J(k,c.adler>>8&255),J(k,c.adler>>16&255),J(k,c.adler>>24&255),J(k,255&c.total_in),J(k,c.total_in>>8&255),J(k,c.total_in>>16&255),J(k,c.total_in>>24&255)):(X(k,c.adler>>>16),X(k,65535&c.adler)),O(c),0<k.wrap&&(k.wrap=-k.wrap),k.pending!==0?d:1)},i.deflateEnd=function(c){var L;return c&&c.state?(L=c.state.status)!==S&&L!==69&&L!==73&&L!==91&&L!==103&&L!==I&&L!==666?rt(c,w):(c.state=null,L===I?rt(c,-3):d):w},i.deflateSetDictionary=function(c,L){var R,k,_,C,$,j,M,V,q=L.length;if(!c||!c.state||(C=(R=c.state).wrap)===2||C===1&&R.status!==S||R.lookahead)return w;for(C===1&&(c.adler=l(c.adler,L,q,0)),R.wrap=0,q>=R.w_size&&(C===0&&(tt(R.head),R.strstart=0,R.block_start=0,R.insert=0),V=new s.Buf8(R.w_size),s.arraySet(V,L,q-R.w_size,R.w_size,0),L=V,q=R.w_size),$=c.avail_in,j=c.next_in,M=c.input,c.avail_in=q,c.next_in=0,c.input=L,ht(R);R.lookahead>=B;){for(k=R.strstart,_=R.lookahead-(B-1);R.ins_h=(R.ins_h<<R.hash_shift^R.window[k+B-1])&R.hash_mask,R.prev[k&R.w_mask]=R.head[R.ins_h],R.head[R.ins_h]=k,k++,--_;);R.strstart=k,R.lookahead=B-1,ht(R)}return R.strstart+=R.lookahead,R.block_start=R.strstart,R.insert=R.lookahead,R.lookahead=0,R.match_length=R.prev_length=B-1,R.match_available=0,c.next_in=j,c.input=M,c.avail_in=$,R.wrap=C,d},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,n,i){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,n,i){n.exports=function(a,s){var o,l,h,b,g,v,d,w,f,p,m,y,x,P,A,F,z,W,B,Z,Q,S,I,u,D;o=a.state,l=a.next_in,u=a.input,h=l+(a.avail_in-5),b=a.next_out,D=a.output,g=b-(s-a.avail_out),v=b+(a.avail_out-257),d=o.dmax,w=o.wsize,f=o.whave,p=o.wnext,m=o.window,y=o.hold,x=o.bits,P=o.lencode,A=o.distcode,F=(1<<o.lenbits)-1,z=(1<<o.distbits)-1;t:do{x<15&&(y+=u[l++]<<x,x+=8,y+=u[l++]<<x,x+=8),W=P[y&F];e:for(;;){if(y>>>=B=W>>>24,x-=B,(B=W>>>16&255)===0)D[b++]=65535&W;else{if(!(16&B)){if((64&B)==0){W=P[(65535&W)+(y&(1<<B)-1)];continue e}if(32&B){o.mode=12;break t}a.msg="invalid literal/length code",o.mode=30;break t}Z=65535&W,(B&=15)&&(x<B&&(y+=u[l++]<<x,x+=8),Z+=y&(1<<B)-1,y>>>=B,x-=B),x<15&&(y+=u[l++]<<x,x+=8,y+=u[l++]<<x,x+=8),W=A[y&z];r:for(;;){if(y>>>=B=W>>>24,x-=B,!(16&(B=W>>>16&255))){if((64&B)==0){W=A[(65535&W)+(y&(1<<B)-1)];continue r}a.msg="invalid distance code",o.mode=30;break t}if(Q=65535&W,x<(B&=15)&&(y+=u[l++]<<x,(x+=8)<B&&(y+=u[l++]<<x,x+=8)),d<(Q+=y&(1<<B)-1)){a.msg="invalid distance too far back",o.mode=30;break t}if(y>>>=B,x-=B,(B=b-g)<Q){if(f<(B=Q-B)&&o.sane){a.msg="invalid distance too far back",o.mode=30;break t}if(I=m,(S=0)===p){if(S+=w-B,B<Z){for(Z-=B;D[b++]=m[S++],--B;);S=b-Q,I=D}}else if(p<B){if(S+=w+p-B,(B-=p)<Z){for(Z-=B;D[b++]=m[S++],--B;);if(S=0,p<Z){for(Z-=B=p;D[b++]=m[S++],--B;);S=b-Q,I=D}}}else if(S+=p-B,B<Z){for(Z-=B;D[b++]=m[S++],--B;);S=b-Q,I=D}for(;2<Z;)D[b++]=I[S++],D[b++]=I[S++],D[b++]=I[S++],Z-=3;Z&&(D[b++]=I[S++],1<Z&&(D[b++]=I[S++]))}else{for(S=b-Q;D[b++]=D[S++],D[b++]=D[S++],D[b++]=D[S++],2<(Z-=3););Z&&(D[b++]=D[S++],1<Z&&(D[b++]=D[S++]))}break}}break}}while(l<h&&b<v);l-=Z=x>>3,y&=(1<<(x-=Z<<3))-1,a.next_in=l,a.next_out=b,a.avail_in=l<h?h-l+5:5-(l-h),a.avail_out=b<v?v-b+257:257-(b-v),o.hold=y,o.bits=x}},{}],49:[function(e,n,i){var a=e("../utils/common"),s=e("./adler32"),o=e("./crc32"),l=e("./inffast"),h=e("./inftrees"),b=1,g=2,v=0,d=-2,w=1,f=852,p=592;function m(S){return(S>>>24&255)+(S>>>8&65280)+((65280&S)<<8)+((255&S)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function x(S){var I;return S&&S.state?(I=S.state,S.total_in=S.total_out=I.total=0,S.msg="",I.wrap&&(S.adler=1&I.wrap),I.mode=w,I.last=0,I.havedict=0,I.dmax=32768,I.head=null,I.hold=0,I.bits=0,I.lencode=I.lendyn=new a.Buf32(f),I.distcode=I.distdyn=new a.Buf32(p),I.sane=1,I.back=-1,v):d}function P(S){var I;return S&&S.state?((I=S.state).wsize=0,I.whave=0,I.wnext=0,x(S)):d}function A(S,I){var u,D;return S&&S.state?(D=S.state,I<0?(u=0,I=-I):(u=1+(I>>4),I<48&&(I&=15)),I&&(I<8||15<I)?d:(D.window!==null&&D.wbits!==I&&(D.window=null),D.wrap=u,D.wbits=I,P(S))):d}function F(S,I){var u,D;return S?(D=new y,(S.state=D).window=null,(u=A(S,I))!==v&&(S.state=null),u):d}var z,W,B=!0;function Z(S){if(B){var I;for(z=new a.Buf32(512),W=new a.Buf32(32),I=0;I<144;)S.lens[I++]=8;for(;I<256;)S.lens[I++]=9;for(;I<280;)S.lens[I++]=7;for(;I<288;)S.lens[I++]=8;for(h(b,S.lens,0,288,z,0,S.work,{bits:9}),I=0;I<32;)S.lens[I++]=5;h(g,S.lens,0,32,W,0,S.work,{bits:5}),B=!1}S.lencode=z,S.lenbits=9,S.distcode=W,S.distbits=5}function Q(S,I,u,D){var et,U=S.state;return U.window===null&&(U.wsize=1<<U.wbits,U.wnext=0,U.whave=0,U.window=new a.Buf8(U.wsize)),D>=U.wsize?(a.arraySet(U.window,I,u-U.wsize,U.wsize,0),U.wnext=0,U.whave=U.wsize):(D<(et=U.wsize-U.wnext)&&(et=D),a.arraySet(U.window,I,u-D,et,U.wnext),(D-=et)?(a.arraySet(U.window,I,u-D,D,0),U.wnext=D,U.whave=U.wsize):(U.wnext+=et,U.wnext===U.wsize&&(U.wnext=0),U.whave<U.wsize&&(U.whave+=et))),0}i.inflateReset=P,i.inflateReset2=A,i.inflateResetKeep=x,i.inflateInit=function(S){return F(S,15)},i.inflateInit2=F,i.inflate=function(S,I){var u,D,et,U,rt,H,tt,O,N,J,X,K,ht,_t,it,st,bt,dt,Ct,xt,c,L,R,k,_=0,C=new a.Buf8(4),$=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!S||!S.state||!S.output||!S.input&&S.avail_in!==0)return d;(u=S.state).mode===12&&(u.mode=13),rt=S.next_out,et=S.output,tt=S.avail_out,U=S.next_in,D=S.input,H=S.avail_in,O=u.hold,N=u.bits,J=H,X=tt,L=v;t:for(;;)switch(u.mode){case w:if(u.wrap===0){u.mode=13;break}for(;N<16;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}if(2&u.wrap&&O===35615){C[u.check=0]=255&O,C[1]=O>>>8&255,u.check=o(u.check,C,2,0),N=O=0,u.mode=2;break}if(u.flags=0,u.head&&(u.head.done=!1),!(1&u.wrap)||(((255&O)<<8)+(O>>8))%31){S.msg="incorrect header check",u.mode=30;break}if((15&O)!=8){S.msg="unknown compression method",u.mode=30;break}if(N-=4,c=8+(15&(O>>>=4)),u.wbits===0)u.wbits=c;else if(c>u.wbits){S.msg="invalid window size",u.mode=30;break}u.dmax=1<<c,S.adler=u.check=1,u.mode=512&O?10:12,N=O=0;break;case 2:for(;N<16;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}if(u.flags=O,(255&u.flags)!=8){S.msg="unknown compression method",u.mode=30;break}if(57344&u.flags){S.msg="unknown header flags set",u.mode=30;break}u.head&&(u.head.text=O>>8&1),512&u.flags&&(C[0]=255&O,C[1]=O>>>8&255,u.check=o(u.check,C,2,0)),N=O=0,u.mode=3;case 3:for(;N<32;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}u.head&&(u.head.time=O),512&u.flags&&(C[0]=255&O,C[1]=O>>>8&255,C[2]=O>>>16&255,C[3]=O>>>24&255,u.check=o(u.check,C,4,0)),N=O=0,u.mode=4;case 4:for(;N<16;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}u.head&&(u.head.xflags=255&O,u.head.os=O>>8),512&u.flags&&(C[0]=255&O,C[1]=O>>>8&255,u.check=o(u.check,C,2,0)),N=O=0,u.mode=5;case 5:if(1024&u.flags){for(;N<16;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}u.length=O,u.head&&(u.head.extra_len=O),512&u.flags&&(C[0]=255&O,C[1]=O>>>8&255,u.check=o(u.check,C,2,0)),N=O=0}else u.head&&(u.head.extra=null);u.mode=6;case 6:if(1024&u.flags&&(H<(K=u.length)&&(K=H),K&&(u.head&&(c=u.head.extra_len-u.length,u.head.extra||(u.head.extra=new Array(u.head.extra_len)),a.arraySet(u.head.extra,D,U,K,c)),512&u.flags&&(u.check=o(u.check,D,K,U)),H-=K,U+=K,u.length-=K),u.length))break t;u.length=0,u.mode=7;case 7:if(2048&u.flags){if(H===0)break t;for(K=0;c=D[U+K++],u.head&&c&&u.length<65536&&(u.head.name+=String.fromCharCode(c)),c&&K<H;);if(512&u.flags&&(u.check=o(u.check,D,K,U)),H-=K,U+=K,c)break t}else u.head&&(u.head.name=null);u.length=0,u.mode=8;case 8:if(4096&u.flags){if(H===0)break t;for(K=0;c=D[U+K++],u.head&&c&&u.length<65536&&(u.head.comment+=String.fromCharCode(c)),c&&K<H;);if(512&u.flags&&(u.check=o(u.check,D,K,U)),H-=K,U+=K,c)break t}else u.head&&(u.head.comment=null);u.mode=9;case 9:if(512&u.flags){for(;N<16;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}if(O!==(65535&u.check)){S.msg="header crc mismatch",u.mode=30;break}N=O=0}u.head&&(u.head.hcrc=u.flags>>9&1,u.head.done=!0),S.adler=u.check=0,u.mode=12;break;case 10:for(;N<32;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}S.adler=u.check=m(O),N=O=0,u.mode=11;case 11:if(u.havedict===0)return S.next_out=rt,S.avail_out=tt,S.next_in=U,S.avail_in=H,u.hold=O,u.bits=N,2;S.adler=u.check=1,u.mode=12;case 12:if(I===5||I===6)break t;case 13:if(u.last){O>>>=7&N,N-=7&N,u.mode=27;break}for(;N<3;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}switch(u.last=1&O,N-=1,3&(O>>>=1)){case 0:u.mode=14;break;case 1:if(Z(u),u.mode=20,I!==6)break;O>>>=2,N-=2;break t;case 2:u.mode=17;break;case 3:S.msg="invalid block type",u.mode=30}O>>>=2,N-=2;break;case 14:for(O>>>=7&N,N-=7&N;N<32;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}if((65535&O)!=(O>>>16^65535)){S.msg="invalid stored block lengths",u.mode=30;break}if(u.length=65535&O,N=O=0,u.mode=15,I===6)break t;case 15:u.mode=16;case 16:if(K=u.length){if(H<K&&(K=H),tt<K&&(K=tt),K===0)break t;a.arraySet(et,D,U,K,rt),H-=K,U+=K,tt-=K,rt+=K,u.length-=K;break}u.mode=12;break;case 17:for(;N<14;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}if(u.nlen=257+(31&O),O>>>=5,N-=5,u.ndist=1+(31&O),O>>>=5,N-=5,u.ncode=4+(15&O),O>>>=4,N-=4,286<u.nlen||30<u.ndist){S.msg="too many length or distance symbols",u.mode=30;break}u.have=0,u.mode=18;case 18:for(;u.have<u.ncode;){for(;N<3;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}u.lens[$[u.have++]]=7&O,O>>>=3,N-=3}for(;u.have<19;)u.lens[$[u.have++]]=0;if(u.lencode=u.lendyn,u.lenbits=7,R={bits:u.lenbits},L=h(0,u.lens,0,19,u.lencode,0,u.work,R),u.lenbits=R.bits,L){S.msg="invalid code lengths set",u.mode=30;break}u.have=0,u.mode=19;case 19:for(;u.have<u.nlen+u.ndist;){for(;st=(_=u.lencode[O&(1<<u.lenbits)-1])>>>16&255,bt=65535&_,!((it=_>>>24)<=N);){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}if(bt<16)O>>>=it,N-=it,u.lens[u.have++]=bt;else{if(bt===16){for(k=it+2;N<k;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}if(O>>>=it,N-=it,u.have===0){S.msg="invalid bit length repeat",u.mode=30;break}c=u.lens[u.have-1],K=3+(3&O),O>>>=2,N-=2}else if(bt===17){for(k=it+3;N<k;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}N-=it,c=0,K=3+(7&(O>>>=it)),O>>>=3,N-=3}else{for(k=it+7;N<k;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}N-=it,c=0,K=11+(127&(O>>>=it)),O>>>=7,N-=7}if(u.have+K>u.nlen+u.ndist){S.msg="invalid bit length repeat",u.mode=30;break}for(;K--;)u.lens[u.have++]=c}}if(u.mode===30)break;if(u.lens[256]===0){S.msg="invalid code -- missing end-of-block",u.mode=30;break}if(u.lenbits=9,R={bits:u.lenbits},L=h(b,u.lens,0,u.nlen,u.lencode,0,u.work,R),u.lenbits=R.bits,L){S.msg="invalid literal/lengths set",u.mode=30;break}if(u.distbits=6,u.distcode=u.distdyn,R={bits:u.distbits},L=h(g,u.lens,u.nlen,u.ndist,u.distcode,0,u.work,R),u.distbits=R.bits,L){S.msg="invalid distances set",u.mode=30;break}if(u.mode=20,I===6)break t;case 20:u.mode=21;case 21:if(6<=H&&258<=tt){S.next_out=rt,S.avail_out=tt,S.next_in=U,S.avail_in=H,u.hold=O,u.bits=N,l(S,X),rt=S.next_out,et=S.output,tt=S.avail_out,U=S.next_in,D=S.input,H=S.avail_in,O=u.hold,N=u.bits,u.mode===12&&(u.back=-1);break}for(u.back=0;st=(_=u.lencode[O&(1<<u.lenbits)-1])>>>16&255,bt=65535&_,!((it=_>>>24)<=N);){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}if(st&&(240&st)==0){for(dt=it,Ct=st,xt=bt;st=(_=u.lencode[xt+((O&(1<<dt+Ct)-1)>>dt)])>>>16&255,bt=65535&_,!(dt+(it=_>>>24)<=N);){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}O>>>=dt,N-=dt,u.back+=dt}if(O>>>=it,N-=it,u.back+=it,u.length=bt,st===0){u.mode=26;break}if(32&st){u.back=-1,u.mode=12;break}if(64&st){S.msg="invalid literal/length code",u.mode=30;break}u.extra=15&st,u.mode=22;case 22:if(u.extra){for(k=u.extra;N<k;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}u.length+=O&(1<<u.extra)-1,O>>>=u.extra,N-=u.extra,u.back+=u.extra}u.was=u.length,u.mode=23;case 23:for(;st=(_=u.distcode[O&(1<<u.distbits)-1])>>>16&255,bt=65535&_,!((it=_>>>24)<=N);){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}if((240&st)==0){for(dt=it,Ct=st,xt=bt;st=(_=u.distcode[xt+((O&(1<<dt+Ct)-1)>>dt)])>>>16&255,bt=65535&_,!(dt+(it=_>>>24)<=N);){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}O>>>=dt,N-=dt,u.back+=dt}if(O>>>=it,N-=it,u.back+=it,64&st){S.msg="invalid distance code",u.mode=30;break}u.offset=bt,u.extra=15&st,u.mode=24;case 24:if(u.extra){for(k=u.extra;N<k;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}u.offset+=O&(1<<u.extra)-1,O>>>=u.extra,N-=u.extra,u.back+=u.extra}if(u.offset>u.dmax){S.msg="invalid distance too far back",u.mode=30;break}u.mode=25;case 25:if(tt===0)break t;if(K=X-tt,u.offset>K){if((K=u.offset-K)>u.whave&&u.sane){S.msg="invalid distance too far back",u.mode=30;break}ht=K>u.wnext?(K-=u.wnext,u.wsize-K):u.wnext-K,K>u.length&&(K=u.length),_t=u.window}else _t=et,ht=rt-u.offset,K=u.length;for(tt<K&&(K=tt),tt-=K,u.length-=K;et[rt++]=_t[ht++],--K;);u.length===0&&(u.mode=21);break;case 26:if(tt===0)break t;et[rt++]=u.length,tt--,u.mode=21;break;case 27:if(u.wrap){for(;N<32;){if(H===0)break t;H--,O|=D[U++]<<N,N+=8}if(X-=tt,S.total_out+=X,u.total+=X,X&&(S.adler=u.check=u.flags?o(u.check,et,X,rt-X):s(u.check,et,X,rt-X)),X=tt,(u.flags?O:m(O))!==u.check){S.msg="incorrect data check",u.mode=30;break}N=O=0}u.mode=28;case 28:if(u.wrap&&u.flags){for(;N<32;){if(H===0)break t;H--,O+=D[U++]<<N,N+=8}if(O!==(4294967295&u.total)){S.msg="incorrect length check",u.mode=30;break}N=O=0}u.mode=29;case 29:L=1;break t;case 30:L=-3;break t;case 31:return-4;case 32:default:return d}return S.next_out=rt,S.avail_out=tt,S.next_in=U,S.avail_in=H,u.hold=O,u.bits=N,(u.wsize||X!==S.avail_out&&u.mode<30&&(u.mode<27||I!==4))&&Q(S,S.output,S.next_out,X-S.avail_out)?(u.mode=31,-4):(J-=S.avail_in,X-=S.avail_out,S.total_in+=J,S.total_out+=X,u.total+=X,u.wrap&&X&&(S.adler=u.check=u.flags?o(u.check,et,X,S.next_out-X):s(u.check,et,X,S.next_out-X)),S.data_type=u.bits+(u.last?64:0)+(u.mode===12?128:0)+(u.mode===20||u.mode===15?256:0),(J==0&&X===0||I===4)&&L===v&&(L=-5),L)},i.inflateEnd=function(S){if(!S||!S.state)return d;var I=S.state;return I.window&&(I.window=null),S.state=null,v},i.inflateGetHeader=function(S,I){var u;return S&&S.state?(2&(u=S.state).wrap)==0?d:((u.head=I).done=!1,v):d},i.inflateSetDictionary=function(S,I){var u,D=I.length;return S&&S.state?(u=S.state).wrap!==0&&u.mode!==11?d:u.mode===11&&s(1,I,D,0)!==u.check?-3:Q(S,I,D,D)?(u.mode=31,-4):(u.havedict=1,v):d},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,n,i){var a=e("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(b,g,v,d,w,f,p,m){var y,x,P,A,F,z,W,B,Z,Q=m.bits,S=0,I=0,u=0,D=0,et=0,U=0,rt=0,H=0,tt=0,O=0,N=null,J=0,X=new a.Buf16(16),K=new a.Buf16(16),ht=null,_t=0;for(S=0;S<=15;S++)X[S]=0;for(I=0;I<d;I++)X[g[v+I]]++;for(et=Q,D=15;1<=D&&X[D]===0;D--);if(D<et&&(et=D),D===0)return w[f++]=20971520,w[f++]=20971520,m.bits=1,0;for(u=1;u<D&&X[u]===0;u++);for(et<u&&(et=u),S=H=1;S<=15;S++)if(H<<=1,(H-=X[S])<0)return-1;if(0<H&&(b===0||D!==1))return-1;for(K[1]=0,S=1;S<15;S++)K[S+1]=K[S]+X[S];for(I=0;I<d;I++)g[v+I]!==0&&(p[K[g[v+I]]++]=I);if(z=b===0?(N=ht=p,19):b===1?(N=s,J-=257,ht=o,_t-=257,256):(N=l,ht=h,-1),S=u,F=f,rt=I=O=0,P=-1,A=(tt=1<<(U=et))-1,b===1&&852<tt||b===2&&592<tt)return 1;for(;;){for(W=S-rt,Z=p[I]<z?(B=0,p[I]):p[I]>z?(B=ht[_t+p[I]],N[J+p[I]]):(B=96,0),y=1<<S-rt,u=x=1<<U;w[F+(O>>rt)+(x-=y)]=W<<24|B<<16|Z|0,x!==0;);for(y=1<<S-1;O&y;)y>>=1;if(y!==0?(O&=y-1,O+=y):O=0,I++,--X[S]==0){if(S===D)break;S=g[v+p[I]]}if(et<S&&(O&A)!==P){for(rt===0&&(rt=et),F+=u,H=1<<(U=S-rt);U+rt<D&&!((H-=X[U+rt])<=0);)U++,H<<=1;if(tt+=1<<U,b===1&&852<tt||b===2&&592<tt)return 1;w[P=O&A]=et<<24|U<<16|F-f|0}}return O!==0&&(w[F+O]=S-rt<<24|64<<16|0),m.bits=et,0}},{"../utils/common":41}],51:[function(e,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,n,i){var a=e("../utils/common"),s=0,o=1;function l(_){for(var C=_.length;0<=--C;)_[C]=0}var h=0,b=29,g=256,v=g+1+b,d=30,w=19,f=2*v+1,p=15,m=16,y=7,x=256,P=16,A=17,F=18,z=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],W=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=new Array(2*(v+2));l(Q);var S=new Array(2*d);l(S);var I=new Array(512);l(I);var u=new Array(256);l(u);var D=new Array(b);l(D);var et,U,rt,H=new Array(d);function tt(_,C,$,j,M){this.static_tree=_,this.extra_bits=C,this.extra_base=$,this.elems=j,this.max_length=M,this.has_stree=_&&_.length}function O(_,C){this.dyn_tree=_,this.max_code=0,this.stat_desc=C}function N(_){return _<256?I[_]:I[256+(_>>>7)]}function J(_,C){_.pending_buf[_.pending++]=255&C,_.pending_buf[_.pending++]=C>>>8&255}function X(_,C,$){_.bi_valid>m-$?(_.bi_buf|=C<<_.bi_valid&65535,J(_,_.bi_buf),_.bi_buf=C>>m-_.bi_valid,_.bi_valid+=$-m):(_.bi_buf|=C<<_.bi_valid&65535,_.bi_valid+=$)}function K(_,C,$){X(_,$[2*C],$[2*C+1])}function ht(_,C){for(var $=0;$|=1&_,_>>>=1,$<<=1,0<--C;);return $>>>1}function _t(_,C,$){var j,M,V=new Array(p+1),q=0;for(j=1;j<=p;j++)V[j]=q=q+$[j-1]<<1;for(M=0;M<=C;M++){var G=_[2*M+1];G!==0&&(_[2*M]=ht(V[G]++,G))}}function it(_){var C;for(C=0;C<v;C++)_.dyn_ltree[2*C]=0;for(C=0;C<d;C++)_.dyn_dtree[2*C]=0;for(C=0;C<w;C++)_.bl_tree[2*C]=0;_.dyn_ltree[2*x]=1,_.opt_len=_.static_len=0,_.last_lit=_.matches=0}function st(_){8<_.bi_valid?J(_,_.bi_buf):0<_.bi_valid&&(_.pending_buf[_.pending++]=_.bi_buf),_.bi_buf=0,_.bi_valid=0}function bt(_,C,$,j){var M=2*C,V=2*$;return _[M]<_[V]||_[M]===_[V]&&j[C]<=j[$]}function dt(_,C,$){for(var j=_.heap[$],M=$<<1;M<=_.heap_len&&(M<_.heap_len&&bt(C,_.heap[M+1],_.heap[M],_.depth)&&M++,!bt(C,j,_.heap[M],_.depth));)_.heap[$]=_.heap[M],$=M,M<<=1;_.heap[$]=j}function Ct(_,C,$){var j,M,V,q,G=0;if(_.last_lit!==0)for(;j=_.pending_buf[_.d_buf+2*G]<<8|_.pending_buf[_.d_buf+2*G+1],M=_.pending_buf[_.l_buf+G],G++,j===0?K(_,M,C):(K(_,(V=u[M])+g+1,C),(q=z[V])!==0&&X(_,M-=D[V],q),K(_,V=N(--j),$),(q=W[V])!==0&&X(_,j-=H[V],q)),G<_.last_lit;);K(_,x,C)}function xt(_,C){var $,j,M,V=C.dyn_tree,q=C.stat_desc.static_tree,G=C.stat_desc.has_stree,Y=C.stat_desc.elems,lt=-1;for(_.heap_len=0,_.heap_max=f,$=0;$<Y;$++)V[2*$]!==0?(_.heap[++_.heap_len]=lt=$,_.depth[$]=0):V[2*$+1]=0;for(;_.heap_len<2;)V[2*(M=_.heap[++_.heap_len]=lt<2?++lt:0)]=1,_.depth[M]=0,_.opt_len--,G&&(_.static_len-=q[2*M+1]);for(C.max_code=lt,$=_.heap_len>>1;1<=$;$--)dt(_,V,$);for(M=Y;$=_.heap[1],_.heap[1]=_.heap[_.heap_len--],dt(_,V,1),j=_.heap[1],_.heap[--_.heap_max]=$,_.heap[--_.heap_max]=j,V[2*M]=V[2*$]+V[2*j],_.depth[M]=(_.depth[$]>=_.depth[j]?_.depth[$]:_.depth[j])+1,V[2*$+1]=V[2*j+1]=M,_.heap[1]=M++,dt(_,V,1),2<=_.heap_len;);_.heap[--_.heap_max]=_.heap[1],(function(at,wt){var Qt,Pt,te,ft,me,Ue,Mt=wt.dyn_tree,Wr=wt.max_code,Di=wt.stat_desc.static_tree,$i=wt.stat_desc.has_stree,ji=wt.stat_desc.extra_bits,Ur=wt.stat_desc.extra_base,ee=wt.stat_desc.max_length,ge=0;for(ft=0;ft<=p;ft++)at.bl_count[ft]=0;for(Mt[2*at.heap[at.heap_max]+1]=0,Qt=at.heap_max+1;Qt<f;Qt++)ee<(ft=Mt[2*Mt[2*(Pt=at.heap[Qt])+1]+1]+1)&&(ft=ee,ge++),Mt[2*Pt+1]=ft,Wr<Pt||(at.bl_count[ft]++,me=0,Ur<=Pt&&(me=ji[Pt-Ur]),Ue=Mt[2*Pt],at.opt_len+=Ue*(ft+me),$i&&(at.static_len+=Ue*(Di[2*Pt+1]+me)));if(ge!==0){do{for(ft=ee-1;at.bl_count[ft]===0;)ft--;at.bl_count[ft]--,at.bl_count[ft+1]+=2,at.bl_count[ee]--,ge-=2}while(0<ge);for(ft=ee;ft!==0;ft--)for(Pt=at.bl_count[ft];Pt!==0;)Wr<(te=at.heap[--Qt])||(Mt[2*te+1]!==ft&&(at.opt_len+=(ft-Mt[2*te+1])*Mt[2*te],Mt[2*te+1]=ft),Pt--)}})(_,C),_t(V,lt,_.bl_count)}function c(_,C,$){var j,M,V=-1,q=C[1],G=0,Y=7,lt=4;for(q===0&&(Y=138,lt=3),C[2*($+1)+1]=65535,j=0;j<=$;j++)M=q,q=C[2*(j+1)+1],++G<Y&&M===q||(G<lt?_.bl_tree[2*M]+=G:M!==0?(M!==V&&_.bl_tree[2*M]++,_.bl_tree[2*P]++):G<=10?_.bl_tree[2*A]++:_.bl_tree[2*F]++,V=M,lt=(G=0)===q?(Y=138,3):M===q?(Y=6,3):(Y=7,4))}function L(_,C,$){var j,M,V=-1,q=C[1],G=0,Y=7,lt=4;for(q===0&&(Y=138,lt=3),j=0;j<=$;j++)if(M=q,q=C[2*(j+1)+1],!(++G<Y&&M===q)){if(G<lt)for(;K(_,M,_.bl_tree),--G!=0;);else M!==0?(M!==V&&(K(_,M,_.bl_tree),G--),K(_,P,_.bl_tree),X(_,G-3,2)):G<=10?(K(_,A,_.bl_tree),X(_,G-3,3)):(K(_,F,_.bl_tree),X(_,G-11,7));V=M,lt=(G=0)===q?(Y=138,3):M===q?(Y=6,3):(Y=7,4)}}l(H);var R=!1;function k(_,C,$,j){X(_,(h<<1)+(j?1:0),3),(function(M,V,q,G){st(M),J(M,q),J(M,~q),a.arraySet(M.pending_buf,M.window,V,q,M.pending),M.pending+=q})(_,C,$)}i._tr_init=function(_){R||((function(){var C,$,j,M,V,q=new Array(p+1);for(M=j=0;M<b-1;M++)for(D[M]=j,C=0;C<1<<z[M];C++)u[j++]=M;for(u[j-1]=M,M=V=0;M<16;M++)for(H[M]=V,C=0;C<1<<W[M];C++)I[V++]=M;for(V>>=7;M<d;M++)for(H[M]=V<<7,C=0;C<1<<W[M]-7;C++)I[256+V++]=M;for($=0;$<=p;$++)q[$]=0;for(C=0;C<=143;)Q[2*C+1]=8,C++,q[8]++;for(;C<=255;)Q[2*C+1]=9,C++,q[9]++;for(;C<=279;)Q[2*C+1]=7,C++,q[7]++;for(;C<=287;)Q[2*C+1]=8,C++,q[8]++;for(_t(Q,v+1,q),C=0;C<d;C++)S[2*C+1]=5,S[2*C]=ht(C,5);et=new tt(Q,z,g+1,v,p),U=new tt(S,W,0,d,p),rt=new tt(new Array(0),B,0,w,y)})(),R=!0),_.l_desc=new O(_.dyn_ltree,et),_.d_desc=new O(_.dyn_dtree,U),_.bl_desc=new O(_.bl_tree,rt),_.bi_buf=0,_.bi_valid=0,it(_)},i._tr_stored_block=k,i._tr_flush_block=function(_,C,$,j){var M,V,q=0;0<_.level?(_.strm.data_type===2&&(_.strm.data_type=(function(G){var Y,lt=4093624447;for(Y=0;Y<=31;Y++,lt>>>=1)if(1&lt&&G.dyn_ltree[2*Y]!==0)return s;if(G.dyn_ltree[18]!==0||G.dyn_ltree[20]!==0||G.dyn_ltree[26]!==0)return o;for(Y=32;Y<g;Y++)if(G.dyn_ltree[2*Y]!==0)return o;return s})(_)),xt(_,_.l_desc),xt(_,_.d_desc),q=(function(G){var Y;for(c(G,G.dyn_ltree,G.l_desc.max_code),c(G,G.dyn_dtree,G.d_desc.max_code),xt(G,G.bl_desc),Y=w-1;3<=Y&&G.bl_tree[2*Z[Y]+1]===0;Y--);return G.opt_len+=3*(Y+1)+5+5+4,Y})(_),M=_.opt_len+3+7>>>3,(V=_.static_len+3+7>>>3)<=M&&(M=V)):M=V=$+5,$+4<=M&&C!==-1?k(_,C,$,j):_.strategy===4||V===M?(X(_,2+(j?1:0),3),Ct(_,Q,S)):(X(_,4+(j?1:0),3),(function(G,Y,lt,at){var wt;for(X(G,Y-257,5),X(G,lt-1,5),X(G,at-4,4),wt=0;wt<at;wt++)X(G,G.bl_tree[2*Z[wt]+1],3);L(G,G.dyn_ltree,Y-1),L(G,G.dyn_dtree,lt-1)})(_,_.l_desc.max_code+1,_.d_desc.max_code+1,q+1),Ct(_,_.dyn_ltree,_.dyn_dtree)),it(_),j&&st(_)},i._tr_tally=function(_,C,$){return _.pending_buf[_.d_buf+2*_.last_lit]=C>>>8&255,_.pending_buf[_.d_buf+2*_.last_lit+1]=255&C,_.pending_buf[_.l_buf+_.last_lit]=255&$,_.last_lit++,C===0?_.dyn_ltree[2*$]++:(_.matches++,C--,_.dyn_ltree[2*(u[$]+g+1)]++,_.dyn_dtree[2*N(C)]++),_.last_lit===_.lit_bufsize-1},i._tr_align=function(_){X(_,2,3),K(_,x,Q),(function(C){C.bi_valid===16?(J(C,C.bi_buf),C.bi_buf=0,C.bi_valid=0):8<=C.bi_valid&&(C.pending_buf[C.pending++]=255&C.bi_buf,C.bi_buf>>=8,C.bi_valid-=8)})(_)}},{"../utils/common":41}],53:[function(e,n,i){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,n,i){(function(a){(function(s,o){if(!s.setImmediate){var l,h,b,g,v=1,d={},w=!1,f=s.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(s);p=p&&p.setTimeout?p:s,l={}.toString.call(s.process)==="[object process]"?function(P){process.nextTick(function(){y(P)})}:(function(){if(s.postMessage&&!s.importScripts){var P=!0,A=s.onmessage;return s.onmessage=function(){P=!1},s.postMessage("","*"),s.onmessage=A,P}})()?(g="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",x,!1):s.attachEvent("onmessage",x),function(P){s.postMessage(g+P,"*")}):s.MessageChannel?((b=new MessageChannel).port1.onmessage=function(P){y(P.data)},function(P){b.port2.postMessage(P)}):f&&"onreadystatechange"in f.createElement("script")?(h=f.documentElement,function(P){var A=f.createElement("script");A.onreadystatechange=function(){y(P),A.onreadystatechange=null,h.removeChild(A),A=null},h.appendChild(A)}):function(P){setTimeout(y,0,P)},p.setImmediate=function(P){typeof P!="function"&&(P=new Function(""+P));for(var A=new Array(arguments.length-1),F=0;F<A.length;F++)A[F]=arguments[F+1];var z={callback:P,args:A};return d[v]=z,l(v),v++},p.clearImmediate=m}function m(P){delete d[P]}function y(P){if(w)setTimeout(y,0,P);else{var A=d[P];if(A){w=!0;try{(function(F){var z=F.callback,W=F.args;switch(W.length){case 0:z();break;case 1:z(W[0]);break;case 2:z(W[0],W[1]);break;case 3:z(W[0],W[1],W[2]);break;default:z.apply(o,W)}})(A)}finally{m(P),w=!1}}}}function x(P){P.source===s&&typeof P.data=="string"&&P.data.indexOf(g)===0&&y(+P.data.slice(g.length))}})(typeof self>"u"?a===void 0?this:a:self)}).call(this,typeof ke<"u"?ke:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Xe)),Xe.exports}var eo=to();const ro=Qs(eo);var pt;(function(r){r.OfficeDocument="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",r.FontTable="http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable",r.Image="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",r.Numbering="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",r.Styles="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",r.StylesWithEffects="http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects",r.Theme="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",r.Settings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",r.WebSettings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings",r.Hyperlink="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",r.Footnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",r.Endnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",r.Footer="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",r.Header="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",r.ExtendedProperties="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",r.CoreProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",r.CustomProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties",r.Comments="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",r.CommentsExtended="http://schemas.microsoft.com/office/2011/relationships/commentsExtended",r.AltChunk="http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk"})(pt||(pt={}));function no(r,t){return t.elements(r).map(e=>({id:t.attr(e,"Id"),type:t.attr(e,"Type"),target:t.attr(e,"Target"),targetMode:t.attr(e,"TargetMode")}))}function io(r){return r?.replace(/[ .]+/g,"-").replace(/[&]+/g,"and").toLowerCase()}function gr(r){return/^[^"'].*\s.*[^"']$/.test(r)?`'${r}'`:r}function Pe(r){let t=r.lastIndexOf("/")+1,e=t==0?"":r.substring(0,t),n=t==0?r:r.substring(t);return[e,n]}function qe(r,t){try{const e="http://docx/";return new URL(r,e+t).toString().substring(e.length)}catch{return`${t}${r}`}}function Ot(r,t){return r.reduce((e,n)=>(e[t(n)]=n,e),{})}function ao(r){return new Promise((t,e)=>{const n=new FileReader;n.onloadend=()=>t(n.result),n.onerror=()=>e(),n.readAsDataURL(r)})}function Ye(r){return r&&typeof r=="object"&&!Array.isArray(r)}function so(r){return typeof r=="string"||r instanceof String}function ze(r,...t){if(!t.length)return r;const e=t.shift();if(Ye(r)&&Ye(e))for(const n in e)if(Ye(e[n])){const i=r[n]??(r[n]={});ze(i,e[n])}else r[n]=e[n];return ze(r,...t)}function ae(r){return Array.isArray(r)?r:[r]}function oo(r,t,e){return t>r?t:e<r?e:r}const Ci={wordml:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},mt={Dxa:{mul:.05,unit:"pt"},Emu:{mul:1/12700,unit:"pt"},FontSize:{mul:.5,unit:"pt"},Border:{mul:.125,unit:"pt",min:.25,max:12},Point:{mul:1,unit:"pt"},Percent:{mul:.02,unit:"%"}};function Pi(r,t=mt.Dxa){if(r==null||/.+(p[xt]|[%])$/.test(r))return r;var e=parseInt(r)*t.mul;return t.min&&t.max&&(e=oo(e,t.min,t.max)),`${e.toFixed(2)}${t.unit}`}function lo(r,t=!1){switch(r){case"1":return!0;case"0":return!1;case"on":return!0;case"off":return!1;case"true":return!0;case"false":return!1;default:return t}}function Ai(r,t,e){if(r.namespaceURI!=Ci.wordml)return!1;switch(r.localName){case"color":t.color=e.attr(r,"val");break;case"sz":t.fontSize=e.lengthAttr(r,"val",mt.FontSize);break;default:return!1}return!0}function co(r,t=!1){t&&(r=r.replace(/<[?].*[?]>/,"")),r=ho(r);const e=new DOMParser().parseFromString(r,"application/xml"),n=uo(e);if(n)throw new Error(n);return e}function uo(r){return r.getElementsByTagName("parsererror")[0]?.textContent}function ho(r){return r.charCodeAt(0)===65279?r.substring(1):r}function fo(r){return new XMLSerializer().serializeToString(r)}class Mi{elements(t,e=null){const n=[];for(let i=0,a=t.childNodes.length;i<a;i++){let s=t.childNodes.item(i);s.nodeType==Node.ELEMENT_NODE&&(e==null||s.localName==e)&&n.push(s)}return n}element(t,e){for(let n=0,i=t.childNodes.length;n<i;n++){let a=t.childNodes.item(n);if(a.nodeType==1&&a.localName==e)return a}return null}elementAttr(t,e,n){var i=this.element(t,e);return i?this.attr(i,n):void 0}attrs(t){return Array.from(t.attributes)}attr(t,e){for(let n=0,i=t.attributes.length;n<i;n++){let a=t.attributes.item(n);if(a.localName==e)return a.value}return null}intAttr(t,e,n=null){var i=this.attr(t,e);return i?parseInt(i):n}hexAttr(t,e,n=null){var i=this.attr(t,e);return i?parseInt(i,16):n}floatAttr(t,e,n=null){var i=this.attr(t,e);return i?parseFloat(i):n}boolAttr(t,e,n=null){return lo(this.attr(t,e),n)}lengthAttr(t,e,n=mt.Dxa){return Pi(this.attr(t,e),n)}}const E=new Mi;class yt{constructor(t,e){this._package=t,this.path=e}async load(){this.rels=await this._package.loadRelationships(this.path);const t=await this._package.load(this.path),e=this._package.parseXmlDocument(t);this._package.options.keepOrigin&&(this._xmlDocument=e),this.parseXml(e.firstElementChild)}save(){this._package.update(this.path,fo(this._xmlDocument))}parseXml(t){}}const po={embedRegular:"regular",embedBold:"bold",embedItalic:"italic",embedBoldItalic:"boldItalic"};function mo(r,t){return t.elements(r).map(e=>go(e,t))}function go(r,t){let e={name:t.attr(r,"name"),embedFontRefs:[]};for(let n of t.elements(r))switch(n.localName){case"family":e.family=t.attr(n,"val");break;case"altName":e.altName=t.attr(n,"val");break;case"embedRegular":case"embedBold":case"embedItalic":case"embedBoldItalic":e.embedFontRefs.push(bo(n,t));break}return e}function bo(r,t){return{id:t.attr(r,"id"),key:t.attr(r,"fontKey"),type:po[r.localName]}}class _o extends yt{parseXml(t){this.fonts=mo(t,this._package.xmlParser)}}class Dr{constructor(t,e){this._zip=t,this.options=e,this.xmlParser=new Mi}get(t){const e=vo(t);return this._zip.files[e]??this._zip.files[e.replace(/\//g,"\\")]}update(t,e){this._zip.file(t,e)}static async load(t,e){const n=await ro.loadAsync(t);return new Dr(n,e)}save(t="blob"){return this._zip.generateAsync({type:t})}load(t,e="string"){return this.get(t)?.async(e)??Promise.resolve(null)}async loadRelationships(t=null){let e="_rels/.rels";if(t!=null){const[i,a]=Pe(t);e=`${i}_rels/${a}.rels`}const n=await this.load(e);return n?no(this.parseXmlDocument(n).firstElementChild,this.xmlParser):null}parseXmlDocument(t){return co(t,this.options.trimXmlDeclaration)}}function vo(r){return r.startsWith("/")?r.substr(1):r}class yo extends yt{constructor(t,e,n){super(t,e),this._documentParser=n}parseXml(t){this.body=this._documentParser.parseDocumentFile(t)}}function Se(r,t){return{type:t.attr(r,"val"),color:t.attr(r,"color"),size:t.lengthAttr(r,"sz",mt.Border),offset:t.lengthAttr(r,"space",mt.Point),frame:t.boolAttr(r,"frame"),shadow:t.boolAttr(r,"shadow")}}function wo(r,t){var e={};for(let n of t.elements(r))switch(n.localName){case"left":e.left=Se(n,t);break;case"top":e.top=Se(n,t);break;case"right":e.right=Se(n,t);break;case"bottom":e.bottom=Se(n,t);break}return e}var sn;(function(r){r.Continuous="continuous",r.NextPage="nextPage",r.NextColumn="nextColumn",r.EvenPage="evenPage",r.OddPage="oddPage"})(sn||(sn={}));function Ni(r,t=E){var e={};for(let n of t.elements(r))switch(n.localName){case"pgSz":e.pageSize={width:t.lengthAttr(n,"w"),height:t.lengthAttr(n,"h"),orientation:t.attr(n,"orient")};break;case"type":e.type=t.attr(n,"val");break;case"pgMar":e.pageMargins={left:t.lengthAttr(n,"left"),right:t.lengthAttr(n,"right"),top:t.lengthAttr(n,"top"),bottom:t.lengthAttr(n,"bottom"),header:t.lengthAttr(n,"header"),footer:t.lengthAttr(n,"footer"),gutter:t.lengthAttr(n,"gutter")};break;case"cols":e.columns=ko(n,t);break;case"headerReference":(e.headerRefs??(e.headerRefs=[])).push(on(n,t));break;case"footerReference":(e.footerRefs??(e.footerRefs=[])).push(on(n,t));break;case"titlePg":e.titlePage=t.boolAttr(n,"val",!0);break;case"pgBorders":e.pageBorders=wo(n,t);break;case"pgNumType":e.pageNumber=xo(n,t);break}return e}function ko(r,t){return{numberOfColumns:t.intAttr(r,"num"),space:t.lengthAttr(r,"space"),separator:t.boolAttr(r,"sep"),equalWidth:t.boolAttr(r,"equalWidth",!0),columns:t.elements(r,"col").map(e=>({width:t.lengthAttr(e,"w"),space:t.lengthAttr(e,"space")}))}}function xo(r,t){return{chapSep:t.attr(r,"chapSep"),chapStyle:t.attr(r,"chapStyle"),format:t.attr(r,"fmt"),start:t.intAttr(r,"start")}}function on(r,t){return{id:t.attr(r,"id"),type:t.attr(r,"type")}}function So(r,t){return{before:t.lengthAttr(r,"before"),after:t.lengthAttr(r,"after"),line:t.intAttr(r,"line"),lineRule:t.attr(r,"lineRule")}}function $r(r,t){let e={};for(let n of t.elements(r))Eo(n,e,t);return e}function Eo(r,t,e){return!!Ai(r,t,e)}function Ti(r,t){let e={};for(let n of t.elements(r))Oi(n,e,t);return e}function Oi(r,t,e){if(r.namespaceURI!=Ci.wordml)return!1;if(Ai(r,t,e))return!0;switch(r.localName){case"tabs":t.tabs=Co(r,e);break;case"sectPr":t.sectionProps=Ni(r,e);break;case"numPr":t.numbering=Po(r,e);break;case"spacing":return t.lineSpacing=So(r,e),!1;case"textAlignment":return t.textAlignment=e.attr(r,"val"),!1;case"keepLines":t.keepLines=e.boolAttr(r,"val",!0);break;case"keepNext":t.keepNext=e.boolAttr(r,"val",!0);break;case"pageBreakBefore":t.pageBreakBefore=e.boolAttr(r,"val",!0);break;case"outlineLvl":t.outlineLevel=e.intAttr(r,"val");break;case"pStyle":t.styleName=e.attr(r,"val");break;case"rPr":t.runProps=$r(r,e);break;default:return!1}return!0}function Co(r,t){return t.elements(r,"tab").map(e=>({position:t.lengthAttr(e,"pos"),leader:t.attr(e,"leader"),style:t.attr(e,"val")}))}function Po(r,t){var e={};for(let n of t.elements(r))switch(n.localName){case"numId":e.id=t.attr(n,"val");break;case"ilvl":e.level=t.intAttr(n,"val");break}return e}function Ao(r,t){let e={numberings:[],abstractNumberings:[],bulletPictures:[]};for(let n of t.elements(r))switch(n.localName){case"num":e.numberings.push(Mo(n,t));break;case"abstractNum":e.abstractNumberings.push(No(n,t));break;case"numPicBullet":e.bulletPictures.push(Oo(n,t));break}return e}function Mo(r,t){let e={id:t.attr(r,"numId"),overrides:[]};for(let n of t.elements(r))switch(n.localName){case"abstractNumId":e.abstractId=t.attr(n,"val");break;case"lvlOverride":e.overrides.push(To(n,t));break}return e}function No(r,t){let e={id:t.attr(r,"abstractNumId"),levels:[]};for(let n of t.elements(r))switch(n.localName){case"name":e.name=t.attr(n,"val");break;case"multiLevelType":e.multiLevelType=t.attr(n,"val");break;case"numStyleLink":e.numberingStyleLink=t.attr(n,"val");break;case"styleLink":e.styleLink=t.attr(n,"val");break;case"lvl":e.levels.push(Ri(n,t));break}return e}function Ri(r,t){let e={level:t.intAttr(r,"ilvl")};for(let n of t.elements(r))switch(n.localName){case"start":e.start=t.attr(n,"val");break;case"lvlRestart":e.restart=t.intAttr(n,"val");break;case"numFmt":e.format=t.attr(n,"val");break;case"lvlText":e.text=t.attr(n,"val");break;case"lvlJc":e.justification=t.attr(n,"val");break;case"lvlPicBulletId":e.bulletPictureId=t.attr(n,"val");break;case"pStyle":e.paragraphStyle=t.attr(n,"val");break;case"pPr":e.paragraphProps=Ti(n,t);break;case"rPr":e.runProps=$r(n,t);break}return e}function To(r,t){let e={level:t.intAttr(r,"ilvl")};for(let n of t.elements(r))switch(n.localName){case"startOverride":e.start=t.intAttr(n,"val");break;case"lvl":e.numberingLevel=Ri(n,t);break}return e}function Oo(r,t){var e=t.element(r,"pict"),n=e&&t.element(e,"shape"),i=n&&t.element(n,"imagedata");return i?{id:t.attr(r,"numPicBulletId"),referenceId:t.attr(i,"id"),style:t.attr(n,"style")}:null}class Ro extends yt{constructor(t,e,n){super(t,e),this._documentParser=n}parseXml(t){Object.assign(this,Ao(t,this._package.xmlParser)),this.domNumberings=this._documentParser.parseNumberingFile(t)}}class Bo extends yt{constructor(t,e,n){super(t,e),this._documentParser=n}parseXml(t){this.styles=this._documentParser.parseStylesFile(t)}}var T;(function(r){r.Document="document",r.Paragraph="paragraph",r.Run="run",r.Break="break",r.NoBreakHyphen="noBreakHyphen",r.Table="table",r.Row="row",r.Cell="cell",r.Hyperlink="hyperlink",r.SmartTag="smartTag",r.Drawing="drawing",r.Image="image",r.Text="text",r.Tab="tab",r.Symbol="symbol",r.BookmarkStart="bookmarkStart",r.BookmarkEnd="bookmarkEnd",r.Footer="footer",r.Header="header",r.FootnoteReference="footnoteReference",r.EndnoteReference="endnoteReference",r.Footnote="footnote",r.Endnote="endnote",r.SimpleField="simpleField",r.ComplexField="complexField",r.Instruction="instruction",r.VmlPicture="vmlPicture",r.MmlMath="mmlMath",r.MmlMathParagraph="mmlMathParagraph",r.MmlFraction="mmlFraction",r.MmlFunction="mmlFunction",r.MmlFunctionName="mmlFunctionName",r.MmlNumerator="mmlNumerator",r.MmlDenominator="mmlDenominator",r.MmlRadical="mmlRadical",r.MmlBase="mmlBase",r.MmlDegree="mmlDegree",r.MmlSuperscript="mmlSuperscript",r.MmlSubscript="mmlSubscript",r.MmlPreSubSuper="mmlPreSubSuper",r.MmlSubArgument="mmlSubArgument",r.MmlSuperArgument="mmlSuperArgument",r.MmlNary="mmlNary",r.MmlDelimiter="mmlDelimiter",r.MmlRun="mmlRun",r.MmlEquationArray="mmlEquationArray",r.MmlLimit="mmlLimit",r.MmlLimitLower="mmlLimitLower",r.MmlMatrix="mmlMatrix",r.MmlMatrixRow="mmlMatrixRow",r.MmlBox="mmlBox",r.MmlBar="mmlBar",r.MmlGroupChar="mmlGroupChar",r.VmlElement="vmlElement",r.Inserted="inserted",r.Deleted="deleted",r.DeletedText="deletedText",r.Comment="comment",r.CommentReference="commentReference",r.CommentRangeStart="commentRangeStart",r.CommentRangeEnd="commentRangeEnd",r.AltChunk="altChunk"})(T||(T={}));class Ht{constructor(){this.children=[],this.cssStyle={}}}class zo extends Ht{constructor(){super(...arguments),this.type=T.Header}}class Io extends Ht{constructor(){super(...arguments),this.type=T.Footer}}class Bi extends yt{constructor(t,e,n){super(t,e),this._documentParser=n}parseXml(t){this.rootElement=this.createRootElement(),this.rootElement.children=this._documentParser.parseBodyElements(t)}}class Fo extends Bi{createRootElement(){return new zo}}class Lo extends Bi{createRootElement(){return new Io}}function Do(r,t){const e={};for(let n of t.elements(r))switch(n.localName){case"Template":e.template=n.textContent;break;case"Pages":e.pages=se(n.textContent);break;case"Words":e.words=se(n.textContent);break;case"Characters":e.characters=se(n.textContent);break;case"Application":e.application=n.textContent;break;case"Lines":e.lines=se(n.textContent);break;case"Paragraphs":e.paragraphs=se(n.textContent);break;case"Company":e.company=n.textContent;break;case"AppVersion":e.appVersion=n.textContent;break}return e}function se(r){if(!(typeof r>"u"))return parseInt(r)}class $o extends yt{parseXml(t){this.props=Do(t,this._package.xmlParser)}}function jo(r,t){const e={};for(let n of t.elements(r))switch(n.localName){case"title":e.title=n.textContent;break;case"description":e.description=n.textContent;break;case"subject":e.subject=n.textContent;break;case"creator":e.creator=n.textContent;break;case"keywords":e.keywords=n.textContent;break;case"language":e.language=n.textContent;break;case"lastModifiedBy":e.lastModifiedBy=n.textContent;break;case"revision":n.textContent&&(e.revision=parseInt(n.textContent));break}return e}class Wo extends yt{parseXml(t){this.props=jo(t,this._package.xmlParser)}}class Uo{}function Ho(r,t){var e=new Uo,n=t.element(r,"themeElements");for(let i of t.elements(n))switch(i.localName){case"clrScheme":e.colorScheme=Vo(i,t);break;case"fontScheme":e.fontScheme=Zo(i,t);break}return e}function Vo(r,t){var e={name:t.attr(r,"name"),colors:{}};for(let a of t.elements(r)){var n=t.element(a,"srgbClr"),i=t.element(a,"sysClr");n?e.colors[a.localName]=t.attr(n,"val"):i&&(e.colors[a.localName]=t.attr(i,"lastClr"))}return e}function Zo(r,t){var e={name:t.attr(r,"name")};for(let n of t.elements(r))switch(n.localName){case"majorFont":e.majorFont=ln(n,t);break;case"minorFont":e.minorFont=ln(n,t);break}return e}function ln(r,t){return{latinTypeface:t.elementAttr(r,"latin","typeface"),eaTypeface:t.elementAttr(r,"ea","typeface"),csTypeface:t.elementAttr(r,"cs","typeface")}}class Go extends yt{constructor(t,e){super(t,e)}parseXml(t){this.theme=Ho(t,this._package.xmlParser)}}class zi{}class Ko extends zi{constructor(){super(...arguments),this.type=T.Footnote}}class Xo extends zi{constructor(){super(...arguments),this.type=T.Endnote}}class Ii extends yt{constructor(t,e,n){super(t,e),this._documentParser=n}}class qo extends Ii{constructor(t,e,n){super(t,e,n)}parseXml(t){this.notes=this._documentParser.parseNotes(t,"footnote",Ko)}}class Yo extends Ii{constructor(t,e,n){super(t,e,n)}parseXml(t){this.notes=this._documentParser.parseNotes(t,"endnote",Xo)}}function Jo(r,t){var e={};for(let n of t.elements(r))switch(n.localName){case"defaultTabStop":e.defaultTabStop=t.lengthAttr(n,"val");break;case"footnotePr":e.footnoteProps=cn(n,t);break;case"endnotePr":e.endnoteProps=cn(n,t);break;case"autoHyphenation":e.autoHyphenation=t.boolAttr(n,"val");break}return e}function cn(r,t){var e={defaultNoteIds:[]};for(let n of t.elements(r))switch(n.localName){case"numFmt":e.nummeringFormat=t.attr(n,"val");break;case"footnote":case"endnote":e.defaultNoteIds.push(t.attr(n,"id"));break}return e}class Qo extends yt{constructor(t,e){super(t,e)}parseXml(t){this.settings=Jo(t,this._package.xmlParser)}}function tl(r,t){return t.elements(r,"property").map(e=>{const n=e.firstChild;return{formatId:t.attr(e,"fmtid"),name:t.attr(e,"name"),type:n.nodeName,value:n.textContent}})}class el extends yt{parseXml(t){this.props=tl(t,this._package.xmlParser)}}class rl extends yt{constructor(t,e,n){super(t,e),this._documentParser=n}parseXml(t){this.comments=this._documentParser.parseComments(t),this.commentMap=Ot(this.comments,e=>e.id)}}class nl extends yt{constructor(t,e){super(t,e),this.comments=[]}parseXml(t){const e=this._package.xmlParser;for(let n of e.elements(t,"commentEx"))this.comments.push({paraId:e.attr(n,"paraId"),paraIdParent:e.attr(n,"paraIdParent"),done:e.boolAttr(n,"done")});this.commentMap=Ot(this.comments,n=>n.paraId)}}const il=[{type:pt.OfficeDocument,target:"word/document.xml"},{type:pt.ExtendedProperties,target:"docProps/app.xml"},{type:pt.CoreProperties,target:"docProps/core.xml"},{type:pt.CustomProperties,target:"docProps/custom.xml"}];class jr{constructor(){this.parts=[],this.partsMap={}}static async load(t,e,n){var i=new jr;return i._options=n,i._parser=e,i._package=await Dr.load(t,n),i.rels=await i._package.loadRelationships(),await Promise.all(il.map(a=>{const s=i.rels.find(o=>o.type===a.type)??a;return i.loadRelationshipPart(s.target,s.type)})),i}save(t="blob"){return this._package.save(t)}async loadRelationshipPart(t,e){if(this.partsMap[t])return this.partsMap[t];if(!this._package.get(t))return null;let n=null;switch(e){case pt.OfficeDocument:this.documentPart=n=new yo(this._package,t,this._parser);break;case pt.FontTable:this.fontTablePart=n=new _o(this._package,t);break;case pt.Numbering:this.numberingPart=n=new Ro(this._package,t,this._parser);break;case pt.Styles:this.stylesPart=n=new Bo(this._package,t,this._parser);break;case pt.Theme:this.themePart=n=new Go(this._package,t);break;case pt.Footnotes:this.footnotesPart=n=new qo(this._package,t,this._parser);break;case pt.Endnotes:this.endnotesPart=n=new Yo(this._package,t,this._parser);break;case pt.Footer:n=new Lo(this._package,t,this._parser);break;case pt.Header:n=new Fo(this._package,t,this._parser);break;case pt.CoreProperties:this.corePropsPart=n=new Wo(this._package,t);break;case pt.ExtendedProperties:this.extendedPropsPart=n=new $o(this._package,t);break;case pt.CustomProperties:n=new el(this._package,t);break;case pt.Settings:this.settingsPart=n=new Qo(this._package,t);break;case pt.Comments:this.commentsPart=n=new rl(this._package,t,this._parser);break;case pt.CommentsExtended:this.commentsExtendedPart=n=new nl(this._package,t);break}if(n==null)return Promise.resolve(null);if(this.partsMap[t]=n,this.parts.push(n),await n.load(),n.rels?.length>0){const[i]=Pe(n.path);await Promise.all(n.rels.map(a=>this.loadRelationshipPart(qe(a.target,i),a.type)))}return n}async loadDocumentImage(t,e){const n=await this.loadResource(e??this.documentPart,t,"blob");return this.blobToURL(n)}async loadNumberingImage(t){const e=await this.loadResource(this.numberingPart,t,"blob");return this.blobToURL(e)}async loadFont(t,e){const n=await this.loadResource(this.fontTablePart,t,"uint8array");return n&&this.blobToURL(new Blob([al(n,e)]))}async loadAltChunk(t,e){return await this.loadResource(e??this.documentPart,t,"string")}blobToURL(t){return t?this._options.useBase64URL?ao(t):URL.createObjectURL(t):null}findPartByRelId(t,e=null){var n=(e.rels??this.rels).find(a=>a.id==t);const i=e?Pe(e.path)[0]:"";return n?this.partsMap[qe(n.target,i)]:null}getPathById(t,e){const n=t.rels.find(a=>a.id==e),[i]=Pe(t.path);return n?qe(n.target,i):null}loadResource(t,e,n){const i=this.getPathById(t,e);return i?this._package.load(i,n):Promise.resolve(null)}}function al(r,t){const n=t.replace(/{|}|-/g,""),i=new Array(16);for(let a=0;a<16;a++)i[16-a-1]=parseInt(n.substring(a*2,a*2+2),16);for(let a=0;a<32;a++)r[a]=r[a]^i[a%16];return r}function sl(r,t){return{type:T.BookmarkStart,id:t.attr(r,"id"),name:t.attr(r,"name"),colFirst:t.intAttr(r,"colFirst"),colLast:t.intAttr(r,"colLast")}}function ol(r,t){return{type:T.BookmarkEnd,id:t.attr(r,"id")}}class ll extends Ht{constructor(){super(...arguments),this.type=T.VmlElement,this.attrs={}}}function Fi(r,t){var e=new ll;switch(r.localName){case"rect":e.tagName="rect",Object.assign(e.attrs,{width:"100%",height:"100%"});break;case"oval":e.tagName="ellipse",Object.assign(e.attrs,{cx:"50%",cy:"50%",rx:"50%",ry:"50%"});break;case"line":e.tagName="line";break;case"shape":e.tagName="g";break;case"textbox":e.tagName="foreignObject",Object.assign(e.attrs,{width:"100%",height:"100%"});break;default:return null}for(const n of E.attrs(r))switch(n.localName){case"style":e.cssStyleText=n.value;break;case"fillcolor":e.attrs.fill=n.value;break;case"from":const[i,a]=un(n.value);Object.assign(e.attrs,{x1:i,y1:a});break;case"to":const[s,o]=un(n.value);Object.assign(e.attrs,{x2:s,y2:o});break}for(const n of E.elements(r))switch(n.localName){case"stroke":Object.assign(e.attrs,cl(n));break;case"fill":Object.assign(e.attrs,ul());break;case"imagedata":e.tagName="image",Object.assign(e.attrs,{width:"100%",height:"100%"}),e.imageHref={id:E.attr(n,"id"),title:E.attr(n,"title")};break;case"txbxContent":e.children.push(...t.parseBodyElements(n));break;default:const i=Fi(n,t);i&&e.children.push(i);break}return e}function cl(r){return{stroke:E.attr(r,"color"),"stroke-width":E.lengthAttr(r,"weight",mt.Emu)??"1px"}}function ul(r){return{}}function un(r){return r.split(",")}class hl extends Ht{constructor(){super(...arguments),this.type=T.Comment}}class dl extends Ht{constructor(t){super(),this.id=t,this.type=T.CommentReference}}class fl extends Ht{constructor(t){super(),this.id=t,this.type=T.CommentRangeStart}}class pl extends Ht{constructor(t){super(),this.id=t,this.type=T.CommentRangeEnd}}var Ae={shd:"inherit",color:"black",borderColor:"black",highlight:"transparent"};const ml=[],hn={oMath:T.MmlMath,oMathPara:T.MmlMathParagraph,f:T.MmlFraction,func:T.MmlFunction,fName:T.MmlFunctionName,num:T.MmlNumerator,den:T.MmlDenominator,rad:T.MmlRadical,deg:T.MmlDegree,e:T.MmlBase,sSup:T.MmlSuperscript,sSub:T.MmlSubscript,sPre:T.MmlPreSubSuper,sup:T.MmlSuperArgument,sub:T.MmlSubArgument,d:T.MmlDelimiter,nary:T.MmlNary,eqArr:T.MmlEquationArray,lim:T.MmlLimit,limLow:T.MmlLimitLower,m:T.MmlMatrix,mr:T.MmlMatrixRow,box:T.MmlBox,bar:T.MmlBar,groupChr:T.MmlGroupChar};class gl{constructor(t){this.options={ignoreWidth:!1,debug:!1,...t}}parseNotes(t,e,n){var i=[];for(let a of E.elements(t,e)){const s=new n;s.id=E.attr(a,"id"),s.noteType=E.attr(a,"type"),s.children=this.parseBodyElements(a),i.push(s)}return i}parseComments(t){var e=[];for(let n of E.elements(t,"comment")){const i=new hl;i.id=E.attr(n,"id"),i.author=E.attr(n,"author"),i.initials=E.attr(n,"initials"),i.date=E.attr(n,"date"),i.children=this.parseBodyElements(n),e.push(i)}return e}parseDocumentFile(t){var e=E.element(t,"body"),n=E.element(t,"background"),i=E.element(e,"sectPr");return{type:T.Document,children:this.parseBodyElements(e),props:i?Ni(i,E):{},cssStyle:n?this.parseBackground(n):{}}}parseBackground(t){var e={},n=Vt.colorAttr(t,"color");return n&&(e["background-color"]=n),e}parseBodyElements(t){var e=[];for(const n of E.elements(t))switch(n.localName){case"p":e.push(this.parseParagraph(n));break;case"altChunk":e.push(this.parseAltChunk(n));break;case"tbl":e.push(this.parseTable(n));break;case"sdt":e.push(...this.parseSdt(n,i=>this.parseBodyElements(i)));break}return e}parseStylesFile(t){var e=[];for(const n of E.elements(t))switch(n.localName){case"style":e.push(this.parseStyle(n));break;case"docDefaults":e.push(this.parseDefaultStyles(n));break}return e}parseDefaultStyles(t){var e={id:null,name:null,target:null,basedOn:null,styles:[]};for(const a of E.elements(t))switch(a.localName){case"rPrDefault":var n=E.element(a,"rPr");n&&e.styles.push({target:"span",values:this.parseDefaultProperties(n,{})});break;case"pPrDefault":var i=E.element(a,"pPr");i&&e.styles.push({target:"p",values:this.parseDefaultProperties(i,{})});break}return e}parseStyle(t){var e={id:E.attr(t,"styleId"),isDefault:E.boolAttr(t,"default"),name:null,target:null,basedOn:null,styles:[],linked:null};switch(E.attr(t,"type")){case"paragraph":e.target="p";break;case"table":e.target="table";break;case"character":e.target="span";break}for(const n of E.elements(t))switch(n.localName){case"basedOn":e.basedOn=E.attr(n,"val");break;case"name":e.name=E.attr(n,"val");break;case"link":e.linked=E.attr(n,"val");break;case"next":e.next=E.attr(n,"val");break;case"aliases":e.aliases=E.attr(n,"val").split(",");break;case"pPr":e.styles.push({target:"p",values:this.parseDefaultProperties(n,{})}),e.paragraphProps=Ti(n,E);break;case"rPr":e.styles.push({target:"span",values:this.parseDefaultProperties(n,{})}),e.runProps=$r(n,E);break;case"tblPr":case"tcPr":e.styles.push({target:"td",values:this.parseDefaultProperties(n,{})});break;case"tblStylePr":for(let i of this.parseTableStyle(n))e.styles.push(i);break;case"rsid":case"qFormat":case"hidden":case"semiHidden":case"unhideWhenUsed":case"autoRedefine":case"uiPriority":break;default:this.options.debug&&console.warn(`DOCX: Unknown style element: ${n.localName}`)}return e}parseTableStyle(t){var e=[],n=E.attr(t,"type"),i="",a="";switch(n){case"firstRow":a=".first-row",i="tr.first-row td";break;case"lastRow":a=".last-row",i="tr.last-row td";break;case"firstCol":a=".first-col",i="td.first-col";break;case"lastCol":a=".last-col",i="td.last-col";break;case"band1Vert":a=":not(.no-vband)",i="td.odd-col";break;case"band2Vert":a=":not(.no-vband)",i="td.even-col";break;case"band1Horz":a=":not(.no-hband)",i="tr.odd-row";break;case"band2Horz":a=":not(.no-hband)",i="tr.even-row";break;default:return[]}for(const s of E.elements(t))switch(s.localName){case"pPr":e.push({target:`${i} p`,mod:a,values:this.parseDefaultProperties(s,{})});break;case"rPr":e.push({target:`${i} span`,mod:a,values:this.parseDefaultProperties(s,{})});break;case"tblPr":case"tcPr":e.push({target:i,mod:a,values:this.parseDefaultProperties(s,{})});break}return e}parseNumberingFile(t){var e=[],n={},i=[];for(const o of E.elements(t))switch(o.localName){case"abstractNum":this.parseAbstractNumbering(o,i).forEach(l=>e.push(l));break;case"numPicBullet":i.push(this.parseNumberingPicBullet(o));break;case"num":var a=E.attr(o,"numId"),s=E.elementAttr(o,"abstractNumId","val");n[s]=a;break}return e.forEach(o=>o.id=n[o.id]),e}parseNumberingPicBullet(t){var e=E.element(t,"pict"),n=e&&E.element(e,"shape"),i=n&&E.element(n,"imagedata");return i?{id:E.intAttr(t,"numPicBulletId"),src:E.attr(i,"id"),style:E.attr(n,"style")}:null}parseAbstractNumbering(t,e){var n=[],i=E.attr(t,"abstractNumId");for(const a of E.elements(t))switch(a.localName){case"lvl":n.push(this.parseNumberingLevel(i,a,e));break}return n}parseNumberingLevel(t,e,n){var i={id:t,level:E.intAttr(e,"ilvl"),start:1,pStyleName:void 0,pStyle:{},rStyle:{},suff:"tab"};for(const s of E.elements(e))switch(s.localName){case"start":i.start=E.intAttr(s,"val");break;case"pPr":this.parseDefaultProperties(s,i.pStyle);break;case"rPr":this.parseDefaultProperties(s,i.rStyle);break;case"lvlPicBulletId":var a=E.intAttr(s,"val");i.bullet=n.find(o=>o?.id==a);break;case"lvlText":i.levelText=E.attr(s,"val");break;case"pStyle":i.pStyleName=E.attr(s,"val");break;case"numFmt":i.format=E.attr(s,"val");break;case"suff":i.suff=E.attr(s,"val");break}return i}parseSdt(t,e){const n=E.element(t,"sdtContent");return n?e(n):[]}parseInserted(t,e){return{type:T.Inserted,children:e(t)?.children??[]}}parseDeleted(t,e){return{type:T.Deleted,children:e(t)?.children??[]}}parseAltChunk(t){return{type:T.AltChunk,children:[],id:E.attr(t,"id")}}parseParagraph(t){var e={type:T.Paragraph,children:[]};for(let n of E.elements(t))switch(n.localName){case"pPr":this.parseParagraphProperties(n,e);break;case"r":e.children.push(this.parseRun(n,e));break;case"hyperlink":e.children.push(this.parseHyperlink(n,e));break;case"smartTag":e.children.push(this.parseSmartTag(n,e));break;case"bookmarkStart":e.children.push(sl(n,E));break;case"bookmarkEnd":e.children.push(ol(n,E));break;case"commentRangeStart":e.children.push(new fl(E.attr(n,"id")));break;case"commentRangeEnd":e.children.push(new pl(E.attr(n,"id")));break;case"oMath":case"oMathPara":e.children.push(this.parseMathElement(n));break;case"sdt":e.children.push(...this.parseSdt(n,i=>this.parseParagraph(i).children));break;case"ins":e.children.push(this.parseInserted(n,i=>this.parseParagraph(i)));break;case"del":e.children.push(this.parseDeleted(n,i=>this.parseParagraph(i)));break}return e}parseParagraphProperties(t,e){this.parseDefaultProperties(t,e.cssStyle={},null,n=>{if(Oi(n,e,E))return!0;switch(n.localName){case"pStyle":e.styleName=E.attr(n,"val");break;case"cnfStyle":e.className=ot.classNameOfCnfStyle(n);break;case"framePr":this.parseFrame(n,e);break;case"rPr":break;default:return!1}return!0})}parseFrame(t,e){var n=E.attr(t,"dropCap");n=="drop"&&(e.cssStyle.float="left")}parseHyperlink(t,e){var n={type:T.Hyperlink,parent:e,children:[]};n.anchor=E.attr(t,"anchor"),n.id=E.attr(t,"id");for(const i of E.elements(t))switch(i.localName){case"r":n.children.push(this.parseRun(i,n));break}return n}parseSmartTag(t,e){var n={type:T.SmartTag,parent:e,children:[]},i=E.attr(t,"uri"),a=E.attr(t,"element");i&&(n.uri=i),a&&(n.element=a);for(const s of E.elements(t))switch(s.localName){case"r":n.children.push(this.parseRun(s,n));break}return n}parseRun(t,e){var n={type:T.Run,parent:e,children:[]};for(let i of E.elements(t))switch(i=this.checkAlternateContent(i),i.localName){case"t":n.children.push({type:T.Text,text:i.textContent});break;case"delText":n.children.push({type:T.DeletedText,text:i.textContent});break;case"commentReference":n.children.push(new dl(E.attr(i,"id")));break;case"fldSimple":n.children.push({type:T.SimpleField,instruction:E.attr(i,"instr"),lock:E.boolAttr(i,"lock",!1),dirty:E.boolAttr(i,"dirty",!1)});break;case"instrText":n.fieldRun=!0,n.children.push({type:T.Instruction,text:i.textContent});break;case"fldChar":n.fieldRun=!0,n.children.push({type:T.ComplexField,charType:E.attr(i,"fldCharType"),lock:E.boolAttr(i,"lock",!1),dirty:E.boolAttr(i,"dirty",!1)});break;case"noBreakHyphen":n.children.push({type:T.NoBreakHyphen});break;case"br":n.children.push({type:T.Break,break:E.attr(i,"type")||"textWrapping"});break;case"lastRenderedPageBreak":n.children.push({type:T.Break,break:"lastRenderedPageBreak"});break;case"sym":n.children.push({type:T.Symbol,font:gr(E.attr(i,"font")),char:E.attr(i,"char")});break;case"tab":n.children.push({type:T.Tab});break;case"footnoteReference":n.children.push({type:T.FootnoteReference,id:E.attr(i,"id")});break;case"endnoteReference":n.children.push({type:T.EndnoteReference,id:E.attr(i,"id")});break;case"drawing":let a=this.parseDrawing(i);a&&(n.children=[a]);break;case"pict":n.children.push(this.parseVmlPicture(i));break;case"rPr":this.parseRunProperties(i,n);break}return n}parseMathElement(t){const e=`${t.localName}Pr`,n={type:hn[t.localName],children:[]};for(const a of E.elements(t))if(hn[a.localName])n.children.push(this.parseMathElement(a));else if(a.localName=="r"){var i=this.parseRun(a);i.type=T.MmlRun,n.children.push(i)}else a.localName==e&&(n.props=this.parseMathProperies(a));return n}parseMathProperies(t){const e={};for(const n of E.elements(t))switch(n.localName){case"chr":e.char=E.attr(n,"val");break;case"vertJc":e.verticalJustification=E.attr(n,"val");break;case"pos":e.position=E.attr(n,"val");break;case"degHide":e.hideDegree=E.boolAttr(n,"val");break;case"begChr":e.beginChar=E.attr(n,"val");break;case"endChr":e.endChar=E.attr(n,"val");break}return e}parseRunProperties(t,e){this.parseDefaultProperties(t,e.cssStyle={},null,n=>{switch(n.localName){case"rStyle":e.styleName=E.attr(n,"val");break;case"vertAlign":e.verticalAlign=ot.valueOfVertAlign(n,!0);break;default:return!1}return!0})}parseVmlPicture(t){const e={type:T.VmlPicture,children:[]};for(const n of E.elements(t)){const i=Fi(n,this);i&&e.children.push(i)}return e}checkAlternateContent(t){if(t.localName!="AlternateContent")return t;var e=E.element(t,"Choice");if(e){var n=E.attr(e,"Requires"),i=t.lookupNamespaceURI(n);if(ml.includes(i))return e.firstElementChild}return E.element(t,"Fallback")?.firstElementChild}parseDrawing(t){for(var e of E.elements(t))switch(e.localName){case"inline":case"anchor":return this.parseDrawingWrapper(e)}}parseDrawingWrapper(t){var e={type:T.Drawing,children:[],cssStyle:{}},n=t.localName=="anchor";let i=null,a=E.boolAttr(t,"simplePos");E.boolAttr(t,"behindDoc");let s={relative:"page",align:"left",offset:"0"},o={relative:"page",align:"top",offset:"0"};for(var l of E.elements(t))switch(l.localName){case"simplePos":a&&(s.offset=E.lengthAttr(l,"x",mt.Emu),o.offset=E.lengthAttr(l,"y",mt.Emu));break;case"extent":e.cssStyle.width=E.lengthAttr(l,"cx",mt.Emu),e.cssStyle.height=E.lengthAttr(l,"cy",mt.Emu);break;case"positionH":case"positionV":if(!a){let v=l.localName=="positionH"?s:o;var h=E.element(l,"align"),b=E.element(l,"posOffset");v.relative=E.attr(l,"relativeFrom")??v.relative,h&&(v.align=h.textContent),b&&(v.offset=Pi(b.textContent,mt.Emu))}break;case"wrapTopAndBottom":i="wrapTopAndBottom";break;case"wrapNone":i="wrapNone";break;case"graphic":var g=this.parseGraphic(l);g&&e.children.push(g);break}return i=="wrapTopAndBottom"?(e.cssStyle.display="block",s.align&&(e.cssStyle["text-align"]=s.align,e.cssStyle.width="100%")):i=="wrapNone"?(e.cssStyle.display="block",e.cssStyle.position="relative",e.cssStyle.width="0px",e.cssStyle.height="0px",s.offset&&(e.cssStyle.left=s.offset),o.offset&&(e.cssStyle.top=o.offset)):n&&(s.align=="left"||s.align=="right")&&(e.cssStyle.float=s.align),e}parseGraphic(t){var e=E.element(t,"graphicData");for(let n of E.elements(e))switch(n.localName){case"pic":return this.parsePicture(n)}return null}parsePicture(t){var e={type:T.Image,src:"",cssStyle:{}},n=E.element(t,"blipFill"),i=E.element(n,"blip"),a=E.element(n,"srcRect");e.src=E.attr(i,"embed"),a&&(e.srcRect=[E.intAttr(a,"l",0)/1e5,E.intAttr(a,"t",0)/1e5,E.intAttr(a,"r",0)/1e5,E.intAttr(a,"b",0)/1e5]);var s=E.element(t,"spPr"),o=E.element(s,"xfrm");if(e.cssStyle.position="relative",o){e.rotation=E.intAttr(o,"rot",0)/6e4;for(var l of E.elements(o))switch(l.localName){case"ext":e.cssStyle.width=E.lengthAttr(l,"cx",mt.Emu),e.cssStyle.height=E.lengthAttr(l,"cy",mt.Emu);break;case"off":e.cssStyle.left=E.lengthAttr(l,"x",mt.Emu),e.cssStyle.top=E.lengthAttr(l,"y",mt.Emu);break}}return e}parseTable(t){var e={type:T.Table,children:[]};for(const n of E.elements(t))switch(n.localName){case"tr":e.children.push(this.parseTableRow(n));break;case"tblGrid":e.columns=this.parseTableColumns(n);break;case"tblPr":this.parseTableProperties(n,e);break}return e}parseTableColumns(t){var e=[];for(const n of E.elements(t))switch(n.localName){case"gridCol":e.push({width:E.lengthAttr(n,"w")});break}return e}parseTableProperties(t,e){switch(e.cssStyle={},e.cellStyle={},this.parseDefaultProperties(t,e.cssStyle,e.cellStyle,n=>{switch(n.localName){case"tblStyle":e.styleName=E.attr(n,"val");break;case"tblLook":e.className=ot.classNameOftblLook(n);break;case"tblpPr":this.parseTablePosition(n,e);break;case"tblStyleColBandSize":e.colBandSize=E.intAttr(n,"val");break;case"tblStyleRowBandSize":e.rowBandSize=E.intAttr(n,"val");break;case"hidden":e.cssStyle.display="none";break;default:return!1}return!0}),e.cssStyle["text-align"]){case"center":delete e.cssStyle["text-align"],e.cssStyle["margin-left"]="auto",e.cssStyle["margin-right"]="auto";break;case"right":delete e.cssStyle["text-align"],e.cssStyle["margin-left"]="auto";break}}parseTablePosition(t,e){var n=E.lengthAttr(t,"topFromText"),i=E.lengthAttr(t,"bottomFromText"),a=E.lengthAttr(t,"rightFromText"),s=E.lengthAttr(t,"leftFromText");e.cssStyle.float="left",e.cssStyle["margin-bottom"]=ot.addSize(e.cssStyle["margin-bottom"],i),e.cssStyle["margin-left"]=ot.addSize(e.cssStyle["margin-left"],s),e.cssStyle["margin-right"]=ot.addSize(e.cssStyle["margin-right"],a),e.cssStyle["margin-top"]=ot.addSize(e.cssStyle["margin-top"],n)}parseTableRow(t){var e={type:T.Row,children:[]};for(const n of E.elements(t))switch(n.localName){case"tc":e.children.push(this.parseTableCell(n));break;case"trPr":case"tblPrEx":this.parseTableRowProperties(n,e);break}return e}parseTableRowProperties(t,e){e.cssStyle=this.parseDefaultProperties(t,{},null,n=>{switch(n.localName){case"cnfStyle":e.className=ot.classNameOfCnfStyle(n);break;case"tblHeader":e.isHeader=E.boolAttr(n,"val");break;case"gridBefore":e.gridBefore=E.intAttr(n,"val");break;case"gridAfter":e.gridAfter=E.intAttr(n,"val");break;default:return!1}return!0})}parseTableCell(t){var e={type:T.Cell,children:[]};for(const n of E.elements(t))switch(n.localName){case"tbl":e.children.push(this.parseTable(n));break;case"p":e.children.push(this.parseParagraph(n));break;case"tcPr":this.parseTableCellProperties(n,e);break}return e}parseTableCellProperties(t,e){e.cssStyle=this.parseDefaultProperties(t,{},null,n=>{switch(n.localName){case"gridSpan":e.span=E.intAttr(n,"val",null);break;case"vMerge":e.verticalMerge=E.attr(n,"val")??"continue";break;case"cnfStyle":e.className=ot.classNameOfCnfStyle(n);break;default:return!1}return!0}),this.parseTableCellVerticalText(t,e)}parseTableCellVerticalText(t,e){const n={btLr:{writingMode:"vertical-rl",transform:"rotate(180deg)"},lrTb:{writingMode:"vertical-lr",transform:"none"},tbRl:{writingMode:"vertical-rl",transform:"none"}};for(const i of E.elements(t))if(i.localName==="textDirection"){const a=E.attr(i,"val"),s=n[a]||{writingMode:"horizontal-tb"};e.cssStyle["writing-mode"]=s.writingMode,e.cssStyle.transform=s.transform}}parseDefaultProperties(t,e=null,n=null,i=null){e=e||{};for(const a of E.elements(t))if(!i?.(a))switch(a.localName){case"jc":e["text-align"]=ot.valueOfJc(a);break;case"textAlignment":e["vertical-align"]=ot.valueOfTextAlignment(a);break;case"color":e.color=Vt.colorAttr(a,"val",null,Ae.color);break;case"sz":e["font-size"]=e["min-height"]=E.lengthAttr(a,"val",mt.FontSize);break;case"shd":e["background-color"]=Vt.colorAttr(a,"fill",null,Ae.shd);break;case"highlight":e["background-color"]=Vt.colorAttr(a,"val",null,Ae.highlight);break;case"vertAlign":break;case"position":e.verticalAlign=E.lengthAttr(a,"val",mt.FontSize);break;case"tcW":if(this.options.ignoreWidth)break;case"tblW":e.width=ot.valueOfSize(a,"w");break;case"trHeight":this.parseTrHeight(a,e);break;case"strike":e["text-decoration"]=E.boolAttr(a,"val",!0)?"line-through":"none";break;case"b":e["font-weight"]=E.boolAttr(a,"val",!0)?"bold":"normal";break;case"i":e["font-style"]=E.boolAttr(a,"val",!0)?"italic":"normal";break;case"caps":e["text-transform"]=E.boolAttr(a,"val",!0)?"uppercase":"none";break;case"smallCaps":e["font-variant"]=E.boolAttr(a,"val",!0)?"small-caps":"none";break;case"u":this.parseUnderline(a,e);break;case"ind":case"tblInd":this.parseIndentation(a,e);break;case"rFonts":this.parseFont(a,e);break;case"tblBorders":this.parseBorderProperties(a,n||e);break;case"tblCellSpacing":e["border-spacing"]=ot.valueOfMargin(a),e["border-collapse"]="separate";break;case"pBdr":this.parseBorderProperties(a,e);break;case"bdr":e.border=ot.valueOfBorder(a);break;case"tcBorders":this.parseBorderProperties(a,e);break;case"vanish":E.boolAttr(a,"val",!0)&&(e.display="none");break;case"kern":break;case"noWrap":break;case"tblCellMar":case"tcMar":this.parseMarginProperties(a,n||e);break;case"tblLayout":e["table-layout"]=ot.valueOfTblLayout(a);break;case"vAlign":e["vertical-align"]=ot.valueOfTextAlignment(a);break;case"spacing":t.localName=="pPr"&&this.parseSpacing(a,e);break;case"wordWrap":E.boolAttr(a,"val")&&(e["overflow-wrap"]="break-word");break;case"suppressAutoHyphens":e.hyphens=E.boolAttr(a,"val",!0)?"none":"auto";break;case"lang":e.$lang=E.attr(a,"val");break;case"rtl":case"bidi":E.boolAttr(a,"val",!0)&&(e.direction="rtl");break;case"bCs":case"iCs":case"szCs":case"tabs":case"outlineLvl":case"contextualSpacing":case"tblStyleColBandSize":case"tblStyleRowBandSize":case"webHidden":case"pageBreakBefore":case"suppressLineNumbers":case"keepLines":case"keepNext":case"widowControl":case"bidi":case"rtl":case"noProof":break;default:this.options.debug&&console.warn(`DOCX: Unknown document element: ${t.localName}.${a.localName}`);break}return e}parseUnderline(t,e){var n=E.attr(t,"val");if(n!=null){switch(n){case"dash":case"dashDotDotHeavy":case"dashDotHeavy":case"dashedHeavy":case"dashLong":case"dashLongHeavy":case"dotDash":case"dotDotDash":e["text-decoration"]="underline dashed";break;case"dotted":case"dottedHeavy":e["text-decoration"]="underline dotted";break;case"double":e["text-decoration"]="underline double";break;case"single":case"thick":e["text-decoration"]="underline";break;case"wave":case"wavyDouble":case"wavyHeavy":e["text-decoration"]="underline wavy";break;case"words":e["text-decoration"]="underline";break;case"none":e["text-decoration"]="none";break}var i=Vt.colorAttr(t,"color");i&&(e["text-decoration-color"]=i)}}parseFont(t,e){var n=E.attr(t,"ascii"),i=ot.themeValue(t,"asciiTheme"),a=E.attr(t,"eastAsia"),s=[n,i,a].filter(o=>o).map(o=>gr(o));s.length>0&&(e["font-family"]=[...new Set(s)].join(", "))}parseIndentation(t,e){var n=E.lengthAttr(t,"firstLine"),i=E.lengthAttr(t,"hanging"),a=E.lengthAttr(t,"left"),s=E.lengthAttr(t,"start"),o=E.lengthAttr(t,"right"),l=E.lengthAttr(t,"end");n&&(e["text-indent"]=n),i&&(e["text-indent"]=`-${i}`),(a||s)&&(e["margin-inline-start"]=a||s),(o||l)&&(e["margin-inline-end"]=o||l)}parseSpacing(t,e){var n=E.lengthAttr(t,"before"),i=E.lengthAttr(t,"after"),a=E.intAttr(t,"line",null),s=E.attr(t,"lineRule");if(n&&(e["margin-top"]=n),i&&(e["margin-bottom"]=i),a!==null)switch(s){case"auto":e["line-height"]=`${(a/240).toFixed(2)}`;break;case"atLeast":e["line-height"]=`calc(100% + ${a/20}pt)`;break;default:e["line-height"]=e["min-height"]=`${a/20}pt`;break}}parseMarginProperties(t,e){for(const n of E.elements(t))switch(n.localName){case"left":e["padding-left"]=ot.valueOfMargin(n);break;case"right":e["padding-right"]=ot.valueOfMargin(n);break;case"top":e["padding-top"]=ot.valueOfMargin(n);break;case"bottom":e["padding-bottom"]=ot.valueOfMargin(n);break}}parseTrHeight(t,e){switch(E.attr(t,"hRule")){case"exact":e.height=E.lengthAttr(t,"val");break;case"atLeast":default:e.height=E.lengthAttr(t,"val");break}}parseBorderProperties(t,e){for(const n of E.elements(t))switch(n.localName){case"start":case"left":e["border-left"]=ot.valueOfBorder(n);break;case"end":case"right":e["border-right"]=ot.valueOfBorder(n);break;case"top":e["border-top"]=ot.valueOfBorder(n);break;case"bottom":e["border-bottom"]=ot.valueOfBorder(n);break}}}const bl=["black","blue","cyan","darkBlue","darkCyan","darkGray","darkGreen","darkMagenta","darkRed","darkYellow","green","lightGray","magenta","none","red","white","yellow"];class Vt{static colorAttr(t,e,n=null,i="black"){var a=E.attr(t,e);if(a)return a=="auto"?i:bl.includes(a)?a:`#${a}`;var s=E.attr(t,"themeColor");return s?`var(--docx-${s}-color)`:n}}class ot{static themeValue(t,e){var n=E.attr(t,e);return n?`var(--docx-${n}-font)`:null}static valueOfSize(t,e){var n=mt.Dxa;switch(E.attr(t,"type")){case"dxa":break;case"pct":n=mt.Percent;break;case"auto":return"auto"}return E.lengthAttr(t,e,n)}static valueOfMargin(t){return E.lengthAttr(t,"w")}static valueOfBorder(t){var e=ot.parseBorderType(E.attr(t,"val"));if(e=="none")return"none";var n=Vt.colorAttr(t,"color"),i=E.lengthAttr(t,"sz",mt.Border);return`${i} ${e} ${n=="auto"?Ae.borderColor:n}`}static parseBorderType(t){switch(t){case"single":return"solid";case"dashDotStroked":return"solid";case"dashed":return"dashed";case"dashSmallGap":return"dashed";case"dotDash":return"dotted";case"dotDotDash":return"dotted";case"dotted":return"dotted";case"double":return"double";case"doubleWave":return"double";case"inset":return"inset";case"nil":return"none";case"none":return"none";case"outset":return"outset";case"thick":return"solid";case"thickThinLargeGap":return"solid";case"thickThinMediumGap":return"solid";case"thickThinSmallGap":return"solid";case"thinThickLargeGap":return"solid";case"thinThickMediumGap":return"solid";case"thinThickSmallGap":return"solid";case"thinThickThinLargeGap":return"solid";case"thinThickThinMediumGap":return"solid";case"thinThickThinSmallGap":return"solid";case"threeDEmboss":return"solid";case"threeDEngrave":return"solid";case"triple":return"double";case"wave":return"solid"}return"solid"}static valueOfTblLayout(t){var e=E.attr(t,"val");return e=="fixed"?"fixed":"auto"}static classNameOfCnfStyle(t){const e=E.attr(t,"val");return["first-row","last-row","first-col","last-col","odd-col","even-col","odd-row","even-row","ne-cell","nw-cell","se-cell","sw-cell"].filter((i,a)=>e[a]=="1").join(" ")}static valueOfJc(t){var e=E.attr(t,"val");switch(e){case"start":case"left":return"left";case"center":return"center";case"end":case"right":return"right";case"both":return"justify"}return e}static valueOfVertAlign(t,e=!1){var n=E.attr(t,"val");switch(n){case"subscript":return"sub";case"superscript":return e?"sup":"super"}return e?null:n}static valueOfTextAlignment(t){var e=E.attr(t,"val");switch(e){case"auto":case"baseline":return"baseline";case"top":return"top";case"center":return"middle";case"bottom":return"bottom"}return e}static addSize(t,e){return t==null?e:e==null?t:`calc(${t} + ${e})`}static classNameOftblLook(t){const e=E.hexAttr(t,"val",0);let n="";return(E.boolAttr(t,"firstRow")||e&32)&&(n+=" first-row"),(E.boolAttr(t,"lastRow")||e&64)&&(n+=" last-row"),(E.boolAttr(t,"firstColumn")||e&128)&&(n+=" first-col"),(E.boolAttr(t,"lastColumn")||e&256)&&(n+=" last-col"),(E.boolAttr(t,"noHBand")||e&512)&&(n+=" no-hband"),(E.boolAttr(t,"noVBand")||e&1024)&&(n+=" no-vband"),n.trim()}}const dn={pos:0,leader:"none",style:"left"},_l=50;function vl(r=document.body){const t=document.createElement("div");t.style.width="100pt",r.appendChild(t);const e=100/t.offsetWidth;return r.removeChild(t),e}function yl(r,t,e,n=72/96){const i=r.closest("p"),a=r.getBoundingClientRect(),s=i.getBoundingClientRect(),o=getComputedStyle(i),l=t?.length>0?t.map(y=>({pos:fn(y.position),leader:y.leader,style:y.style})).sort((y,x)=>y.pos-x.pos):[dn],h=l[l.length-1],b=s.width*n,g=fn(e);let v=h.pos+g;if(v<b)for(;v<b&&l.length<_l;v+=g)l.push({...dn,pos:v});const d=parseFloat(o.marginLeft),w=s.left+d,f=(a.left-w)*n,p=l.find(y=>y.style!="clear"&&y.pos>f);if(p==null)return;let m=1;if(p.style=="right"||p.style=="center"){const y=Array.from(i.querySelectorAll(`.${r.className}`)),x=y.indexOf(r)+1,P=document.createRange();P.setStart(r,1),x<y.length?P.setEndBefore(y[x]):P.setEndAfter(i);const A=p.style=="center"?.5:1,F=P.getBoundingClientRect(),z=F.left+A*F.width-(s.left-d);m=p.pos-z*n}else m=p.pos-f;switch(r.innerHTML="&nbsp;",r.style.textDecoration="inherit",r.style.wordSpacing=`${m.toFixed(0)}pt`,p.leader){case"dot":case"middleDot":r.style.textDecoration="underline",r.style.textDecorationStyle="dotted";break;case"hyphen":case"heavy":case"underscore":r.style.textDecoration="underline";break}}function fn(r){return parseFloat(r)}const nt={svg:"http://www.w3.org/2000/svg",mathML:"http://www.w3.org/1998/Math/MathML"};class wl{constructor(t){this.htmlDocument=t,this.className="docx",this.styleMap={},this.currentPart=null,this.tableVerticalMerges=[],this.currentVerticalMerge=null,this.tableCellPositions=[],this.currentCellPosition=null,this.footnoteMap={},this.endnoteMap={},this.currentEndnoteIds=[],this.usedHederFooterParts=[],this.currentTabs=[],this.commentMap={},this.tasks=[],this.postRenderTasks=[]}async render(t,e,n=null,i){this.document=t,this.options=i,this.className=i.className,this.rootSelector=i.inWrapper?`.${this.className}-wrapper`:":root",this.styleMap=null,this.tasks=[],this.options.renderComments&&globalThis.Highlight&&(this.commentHighlight=new Highlight),n=n||e,pn(n),pn(e),n.appendChild(this.createComment("docxjs library predefined styles")),n.appendChild(this.renderDefaultStyle()),t.themePart&&(n.appendChild(this.createComment("docxjs document theme values")),this.renderTheme(t.themePart,n)),t.stylesPart!=null&&(this.styleMap=this.processStyles(t.stylesPart.styles),n.appendChild(this.createComment("docxjs document styles")),n.appendChild(this.renderStyles(t.stylesPart.styles))),t.numberingPart&&(this.prodessNumberings(t.numberingPart.domNumberings),n.appendChild(this.createComment("docxjs document numbering styles")),n.appendChild(this.renderNumbering(t.numberingPart.domNumberings,n))),t.footnotesPart&&(this.footnoteMap=Ot(t.footnotesPart.notes,s=>s.id)),t.endnotesPart&&(this.endnoteMap=Ot(t.endnotesPart.notes,s=>s.id)),t.settingsPart&&(this.defaultTabSize=t.settingsPart.settings?.defaultTabStop),!i.ignoreFonts&&t.fontTablePart&&this.renderFontTable(t.fontTablePart,n);var a=this.renderSections(t.documentPart.body);this.options.inWrapper?e.appendChild(this.renderWrapper(a)):Je(e,a),this.commentHighlight&&i.renderComments&&CSS.highlights.set(`${this.className}-comments`,this.commentHighlight),this.postRenderTasks.forEach(s=>s()),await Promise.allSettled(this.tasks),this.refreshTabStops()}renderTheme(t,e){const n={},i=t.theme?.fontScheme;i&&(i.majorFont&&(n["--docx-majorHAnsi-font"]=i.majorFont.latinTypeface),i.minorFont&&(n["--docx-minorHAnsi-font"]=i.minorFont.latinTypeface));const a=t.theme?.colorScheme;if(a)for(let[o,l]of Object.entries(a.colors))n[`--docx-${o}-color`]=`#${l}`;const s=this.styleToString(`.${this.className}`,n);e.appendChild(this.createStyleElement(s))}renderFontTable(t,e){for(let n of t.fonts)for(let i of n.embedFontRefs)this.tasks.push(this.document.loadFont(i.id,i.key).then(a=>{const s={"font-family":gr(n.name),src:`url(${a})`};(i.type=="bold"||i.type=="boldItalic")&&(s["font-weight"]="bold"),(i.type=="italic"||i.type=="boldItalic")&&(s["font-style"]="italic");const o=this.styleToString("@font-face",s);e.appendChild(this.createComment(`docxjs ${n.name} font`)),e.appendChild(this.createStyleElement(o))}))}processStyleName(t){return t?`${this.className}_${io(t)}`:this.className}processStyles(t){const e=Ot(t.filter(i=>i.id!=null),i=>i.id);for(const i of t.filter(a=>a.basedOn)){var n=e[i.basedOn];if(n){i.paragraphProps=ze(i.paragraphProps,n.paragraphProps),i.runProps=ze(i.runProps,n.runProps);for(const a of n.styles){const s=i.styles.find(o=>o.target==a.target);s?this.copyStyleProperties(a.values,s.values):i.styles.push({...a,values:{...a.values}})}}else this.options.debug&&console.warn(`Can't find base style ${i.basedOn}`)}for(let i of t)i.cssName=this.processStyleName(i.id);return e}prodessNumberings(t){for(let e of t.filter(n=>n.pStyleName)){const n=this.findStyle(e.pStyleName);n?.paragraphProps?.numbering&&(n.paragraphProps.numbering.level=e.level)}}processElement(t){if(t.children)for(var e of t.children)e.parent=t,e.type==T.Table?this.processTable(e):this.processElement(e)}processTable(t){for(var e of t.children)for(var n of e.children)n.cssStyle=this.copyStyleProperties(t.cellStyle,n.cssStyle,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]),this.processElement(n)}copyStyleProperties(t,e,n=null){if(!t)return e;e==null&&(e={}),n==null&&(n=Object.getOwnPropertyNames(t));for(var i of n)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i]);return e}createPageElement(t,e){var n=this.createElement("section",{className:t});return e&&(e.pageMargins&&(n.style.paddingLeft=e.pageMargins.left,n.style.paddingRight=e.pageMargins.right,n.style.paddingTop=e.pageMargins.top,n.style.paddingBottom=e.pageMargins.bottom),e.pageSize&&(this.options.ignoreWidth||(n.style.width=e.pageSize.width),this.options.ignoreHeight||(n.style.minHeight=e.pageSize.height))),n}createSectionContent(t){var e=this.createElement("article");return t.columns&&t.columns.numberOfColumns&&(e.style.columnCount=`${t.columns.numberOfColumns}`,e.style.columnGap=t.columns.space,t.columns.separator&&(e.style.columnRule="1px solid black")),e}renderSections(t){const e=[];this.processElement(t);const n=this.splitBySection(t.children,t.props),i=this.groupByPageBreaks(n);let a=null;for(let o=0,l=i.length;o<l;o++){this.currentFootnoteIds=[];let b=i[o][0].sectProps;const g=this.createPageElement(this.className,b);this.renderStyleValues(t.cssStyle,g),this.options.renderHeaders&&this.renderHeaderFooter(b.headerRefs,b,e.length,a!=b,g);for(const v of i[o]){var s=this.createSectionContent(v.sectProps);this.renderElements(v.elements,s),g.appendChild(s),b=v.sectProps}this.options.renderFootnotes&&this.renderNotes(this.currentFootnoteIds,this.footnoteMap,g),this.options.renderEndnotes&&o==l-1&&this.renderNotes(this.currentEndnoteIds,this.endnoteMap,g),this.options.renderFooters&&this.renderHeaderFooter(b.footerRefs,b,e.length,a!=b,g),e.push(g),a=b}return e}renderHeaderFooter(t,e,n,i,a){if(t){var s=(e.titlePage&&i?t.find(l=>l.type=="first"):null)??(n%2==1?t.find(l=>l.type=="even"):null)??t.find(l=>l.type=="default"),o=s&&this.document.findPartByRelId(s.id,this.document.documentPart);if(o){this.currentPart=o,this.usedHederFooterParts.includes(o.path)||(this.processElement(o.rootElement),this.usedHederFooterParts.push(o.path));const[l]=this.renderElements([o.rootElement],a);e?.pageMargins&&(o.rootElement.type===T.Header?(l.style.marginTop=`calc(${e.pageMargins.header} - ${e.pageMargins.top})`,l.style.minHeight=`calc(${e.pageMargins.top} - ${e.pageMargins.header})`):o.rootElement.type===T.Footer&&(l.style.marginBottom=`calc(${e.pageMargins.footer} - ${e.pageMargins.bottom})`,l.style.minHeight=`calc(${e.pageMargins.bottom} - ${e.pageMargins.footer})`)),this.currentPart=null}}}isPageBreakElement(t){return t.type!=T.Break?!1:t.break=="lastRenderedPageBreak"?!this.options.ignoreLastRenderedPageBreak:t.break=="page"}isPageBreakSection(t,e){return!t||!e?!1:t.pageSize?.orientation!=e.pageSize?.orientation||t.pageSize?.width!=e.pageSize?.width||t.pageSize?.height!=e.pageSize?.height}splitBySection(t,e){var n={sectProps:null,elements:[],pageBreak:!1},i=[n];for(let g of t)if(g.type==T.Paragraph&&this.findStyle(g.styleName)?.paragraphProps?.pageBreakBefore&&(n.sectProps=a,n.pageBreak=!0,n={sectProps:null,elements:[],pageBreak:!1},i.push(n)),n.elements.push(g),g.type==T.Paragraph){const v=g;var a=v.sectionProps,s=-1,o=-1;if(this.options.breakPages&&v.children&&(s=v.children.findIndex(d=>(o=d.children?.findIndex(this.isPageBreakElement.bind(this))??-1,o!=-1))),(a||s!=-1)&&(n.sectProps=a,n.pageBreak=s!=-1,n={sectProps:null,elements:[],pageBreak:!1},i.push(n)),s!=-1){let d=v.children[s],w=o<d.children.length-1;if(s<v.children.length-1||w){var l=g.children,h={...g,children:l.slice(s)};if(g.children=l.slice(0,s),n.elements.push(h),w){let f=d.children,p={...d,children:f.slice(0,o)};g.children.push(p),d.children=f.slice(o)}}}}let b=null;for(let g=i.length-1;g>=0;g--)i[g].sectProps==null?i[g].sectProps=b??e:b=i[g].sectProps;return i}groupByPageBreaks(t){let e=[],n;const i=[e];for(let a of t)e.push(a),(this.options.ignoreLastRenderedPageBreak||a.pageBreak||this.isPageBreakSection(n,a.sectProps))&&i.push(e=[]),n=a.sectProps;return i.filter(a=>a.length>0)}renderWrapper(t){return this.createElement("div",{className:`${this.className}-wrapper`},t)}renderDefaultStyle(){var t=this.className,e=`
.${t}-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; } 
.${t}-wrapper>section.${t} { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }`;this.options.hideWrapperOnPrint&&(e=`@media not print { ${e} }`);var n=`${e}
.${t} { color: black; hyphens: auto; text-underline-position: from-font; }
section.${t} { box-sizing: border-box; display: flex; flex-flow: column nowrap; position: relative; overflow: hidden; }
section.${t}>article { margin-bottom: auto; z-index: 1; }
section.${t}>footer { z-index: 1; }
.${t} table { border-collapse: collapse; }
.${t} table td, .${t} table th { vertical-align: top; }
.${t} p { margin: 0pt; min-height: 1em; }
.${t} span { white-space: pre-wrap; overflow-wrap: break-word; }
.${t} a { color: inherit; text-decoration: inherit; }
.${t} svg { fill: transparent; }
`;return this.options.renderComments&&(n+=`
.${t}-comment-ref { cursor: default; }
.${t}-comment-popover { display: none; z-index: 1000; padding: 0.5rem; background: white; position: absolute; box-shadow: 0 0 0.25rem rgba(0, 0, 0, 0.25); width: 30ch; }
.${t}-comment-ref:hover~.${t}-comment-popover { display: block; }
.${t}-comment-author,.${t}-comment-date { font-size: 0.875rem; color: #888; }
`),this.createStyleElement(n)}renderNumbering(t,e){var n="",i=[];for(var a of t){var s=`p.${this.numberingClass(a.id,a.level)}`,o="none";if(a.bullet){let l=`--${this.className}-${a.bullet.src}`.toLowerCase();n+=this.styleToString(`${s}:before`,{content:"' '",display:"inline-block",background:`var(${l})`},a.bullet.style),this.tasks.push(this.document.loadNumberingImage(a.bullet.src).then(h=>{var b=`${this.rootSelector} { ${l}: url(${h}) }`;e.appendChild(this.createStyleElement(b))}))}else if(a.levelText){let l=this.numberingCounter(a.id,a.level);const h=l+" "+(a.start-1);a.level>0&&(n+=this.styleToString(`p.${this.numberingClass(a.id,a.level-1)}`,{"counter-set":h})),i.push(h),n+=this.styleToString(`${s}:before`,{content:this.levelTextToContent(a.levelText,a.suff,a.id,this.numFormatToCssValue(a.format)),"counter-increment":l,...a.rStyle})}else o=this.numFormatToCssValue(a.format);n+=this.styleToString(s,{display:"list-item","list-style-position":"inside","list-style-type":o,...a.pStyle})}return i.length>0&&(n+=this.styleToString(this.rootSelector,{"counter-reset":i.join(" ")})),this.createStyleElement(n)}renderStyles(t){var e="";const n=this.styleMap,i=Ot(t.filter(l=>l.isDefault),l=>l.target);for(const l of t){var a=l.styles;if(l.linked){var s=l.linked&&n[l.linked];s?a=a.concat(s.styles):this.options.debug&&console.warn(`Can't find linked style ${l.linked}`)}for(const h of a){var o=`${l.target??""}.${l.cssName}`;l.target!=h.target&&(o+=` ${h.target}`),i[l.target]==l&&(o=`.${this.className} ${l.target}, `+o),e+=this.styleToString(o,h.values)}}return this.createStyleElement(e)}renderNotes(t,e,n){var i=t.map(s=>e[s]).filter(s=>s);if(i.length>0){var a=this.createElement("ol",null,this.renderElements(i));n.appendChild(a)}}renderElement(t){switch(t.type){case T.Paragraph:return this.renderParagraph(t);case T.BookmarkStart:return this.renderBookmarkStart(t);case T.BookmarkEnd:return null;case T.Run:return this.renderRun(t);case T.Table:return this.renderTable(t);case T.Row:return this.renderTableRow(t);case T.Cell:return this.renderTableCell(t);case T.Hyperlink:return this.renderHyperlink(t);case T.SmartTag:return this.renderSmartTag(t);case T.Drawing:return this.renderDrawing(t);case T.Image:return this.renderImage(t);case T.Text:return this.renderText(t);case T.Text:return this.renderText(t);case T.DeletedText:return this.renderDeletedText(t);case T.Tab:return this.renderTab(t);case T.Symbol:return this.renderSymbol(t);case T.Break:return this.renderBreak(t);case T.Footer:return this.renderContainer(t,"footer");case T.Header:return this.renderContainer(t,"header");case T.Footnote:case T.Endnote:return this.renderContainer(t,"li");case T.FootnoteReference:return this.renderFootnoteReference(t);case T.EndnoteReference:return this.renderEndnoteReference(t);case T.NoBreakHyphen:return this.createElement("wbr");case T.VmlPicture:return this.renderVmlPicture(t);case T.VmlElement:return this.renderVmlElement(t);case T.MmlMath:return this.renderContainerNS(t,nt.mathML,"math",{xmlns:nt.mathML});case T.MmlMathParagraph:return this.renderContainer(t,"span");case T.MmlFraction:return this.renderContainerNS(t,nt.mathML,"mfrac");case T.MmlBase:return this.renderContainerNS(t,nt.mathML,t.parent.type==T.MmlMatrixRow?"mtd":"mrow");case T.MmlNumerator:case T.MmlDenominator:case T.MmlFunction:case T.MmlLimit:case T.MmlBox:return this.renderContainerNS(t,nt.mathML,"mrow");case T.MmlGroupChar:return this.renderMmlGroupChar(t);case T.MmlLimitLower:return this.renderContainerNS(t,nt.mathML,"munder");case T.MmlMatrix:return this.renderContainerNS(t,nt.mathML,"mtable");case T.MmlMatrixRow:return this.renderContainerNS(t,nt.mathML,"mtr");case T.MmlRadical:return this.renderMmlRadical(t);case T.MmlSuperscript:return this.renderContainerNS(t,nt.mathML,"msup");case T.MmlSubscript:return this.renderContainerNS(t,nt.mathML,"msub");case T.MmlDegree:case T.MmlSuperArgument:case T.MmlSubArgument:return this.renderContainerNS(t,nt.mathML,"mn");case T.MmlFunctionName:return this.renderContainerNS(t,nt.mathML,"ms");case T.MmlDelimiter:return this.renderMmlDelimiter(t);case T.MmlRun:return this.renderMmlRun(t);case T.MmlNary:return this.renderMmlNary(t);case T.MmlPreSubSuper:return this.renderMmlPreSubSuper(t);case T.MmlBar:return this.renderMmlBar(t);case T.MmlEquationArray:return this.renderMllList(t);case T.Inserted:return this.renderInserted(t);case T.Deleted:return this.renderDeleted(t);case T.CommentRangeStart:return this.renderCommentRangeStart(t);case T.CommentRangeEnd:return this.renderCommentRangeEnd(t);case T.CommentReference:return this.renderCommentReference(t);case T.AltChunk:return this.renderAltChunk(t)}return null}renderElements(t,e){if(t==null)return null;var n=t.flatMap(i=>this.renderElement(i)).filter(i=>i!=null);return e&&Je(e,n),n}renderContainer(t,e,n){return this.createElement(e,n,this.renderElements(t.children))}renderContainerNS(t,e,n,i){return this.createElementNS(e,n,i,this.renderElements(t.children))}renderParagraph(t){var e=this.renderContainer(t,"p");const n=this.findStyle(t.styleName);t.tabs??(t.tabs=n?.paragraphProps?.tabs),this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e),this.renderCommonProperties(e.style,t);const i=t.numbering??n?.paragraphProps?.numbering;return i&&e.classList.add(this.numberingClass(i.id,i.level)),e}renderRunProperties(t,e){this.renderCommonProperties(t,e)}renderCommonProperties(t,e){e!=null&&(e.color&&(t.color=e.color),e.fontSize&&(t["font-size"]=e.fontSize))}renderHyperlink(t){var e=this.renderContainer(t,"a");this.renderStyleValues(t.cssStyle,e);let n="";return t.id&&(n=this.document.documentPart.rels.find(a=>a.id==t.id&&a.targetMode==="External")?.target??n),t.anchor&&(n+=`#${t.anchor}`),e.href=n,e}renderSmartTag(t){return this.renderContainer(t,"span")}renderCommentRangeStart(t){if(!this.options.renderComments)return null;const e=new Range;this.commentHighlight?.add(e);const n=this.createComment(`start of comment #${t.id}`);return this.later(()=>e.setStart(n,0)),this.commentMap[t.id]=e,n}renderCommentRangeEnd(t){if(!this.options.renderComments)return null;const e=this.commentMap[t.id],n=this.createComment(`end of comment #${t.id}`);return this.later(()=>e?.setEnd(n,0)),n}renderCommentReference(t){if(!this.options.renderComments)return null;var e=this.document.commentsPart?.commentMap[t.id];if(!e)return null;const n=new DocumentFragment,i=this.createElement("span",{className:`${this.className}-comment-ref`},[""]),a=this.createElement("div",{className:`${this.className}-comment-popover`});return this.renderCommentContent(e,a),n.appendChild(this.createComment(`comment #${e.id} by ${e.author} on ${e.date}`)),n.appendChild(i),n.appendChild(a),n}renderAltChunk(t){if(!this.options.renderAltChunks)return null;var e=this.createElement("iframe");return this.tasks.push(this.document.loadAltChunk(t.id,this.currentPart).then(n=>{e.srcdoc=n})),e}renderCommentContent(t,e){e.appendChild(this.createElement("div",{className:`${this.className}-comment-author`},[t.author])),e.appendChild(this.createElement("div",{className:`${this.className}-comment-date`},[new Date(t.date).toLocaleString()])),this.renderElements(t.children,e)}renderDrawing(t){var e=this.renderContainer(t,"div");return e.style.display="inline-block",e.style.position="relative",e.style.textIndent="0px",this.renderStyleValues(t.cssStyle,e),e}renderImage(t){let e=this.createElement("img"),n=t.cssStyle?.transform;if(this.renderStyleValues(t.cssStyle,e),t.srcRect&&t.srcRect.some(l=>l!=0)){var[i,a,s,o]=t.srcRect;n=`scale(${1/(1-i-s)}, ${1/(1-a-o)})`,e.style["clip-path"]=`rect(${(100*a).toFixed(2)}% ${(100*(1-s)).toFixed(2)}% ${(100*(1-o)).toFixed(2)}% ${(100*i).toFixed(2)}%)`}return t.rotation&&(n=`rotate(${t.rotation}deg) ${n??""}`),e.style.transform=n?.trim(),this.document&&this.tasks.push(this.document.loadDocumentImage(t.src,this.currentPart).then(l=>{e.src=l})),e}renderText(t){return this.htmlDocument.createTextNode(t.text)}renderDeletedText(t){return this.options.renderChanges?this.renderText(t):null}renderBreak(t){return t.break=="textWrapping"?this.createElement("br"):null}renderInserted(t){return this.options.renderChanges?this.renderContainer(t,"ins"):this.renderElements(t.children)}renderDeleted(t){return this.options.renderChanges?this.renderContainer(t,"del"):null}renderSymbol(t){var e=this.createElement("span");return e.style.fontFamily=t.font,e.innerHTML=`&#x${t.char};`,e}renderFootnoteReference(t){var e=this.createElement("sup");return this.currentFootnoteIds.push(t.id),e.textContent=`${this.currentFootnoteIds.length}`,e}renderEndnoteReference(t){var e=this.createElement("sup");return this.currentEndnoteIds.push(t.id),e.textContent=`${this.currentEndnoteIds.length}`,e}renderTab(t){var e=this.createElement("span");if(e.innerHTML="&emsp;",this.options.experimental){e.className=this.tabStopClass();var n=kl(t,T.Paragraph)?.tabs;this.currentTabs.push({stops:n,span:e})}return e}renderBookmarkStart(t){return this.createElement("span",{id:t.name})}renderRun(t){if(t.fieldRun)return null;const e=this.createElement("span");if(t.id&&(e.id=t.id),this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e),t.verticalAlign){const n=this.createElement(t.verticalAlign);this.renderElements(t.children,n),e.appendChild(n)}else this.renderElements(t.children,e);return e}renderTable(t){let e=this.createElement("table");return this.tableCellPositions.push(this.currentCellPosition),this.tableVerticalMerges.push(this.currentVerticalMerge),this.currentVerticalMerge={},this.currentCellPosition={col:0,row:0},t.columns&&e.appendChild(this.renderTableColumns(t.columns)),this.renderClass(t,e),this.renderElements(t.children,e),this.renderStyleValues(t.cssStyle,e),this.currentVerticalMerge=this.tableVerticalMerges.pop(),this.currentCellPosition=this.tableCellPositions.pop(),e}renderTableColumns(t){let e=this.createElement("colgroup");for(let n of t){let i=this.createElement("col");n.width&&(i.style.width=n.width),e.appendChild(i)}return e}renderTableRow(t){let e=this.createElement("tr");return this.currentCellPosition.col=0,t.gridBefore&&e.appendChild(this.renderTableCellPlaceholder(t.gridBefore)),this.renderClass(t,e),this.renderElements(t.children,e),this.renderStyleValues(t.cssStyle,e),t.gridAfter&&e.appendChild(this.renderTableCellPlaceholder(t.gridAfter)),this.currentCellPosition.row++,e}renderTableCellPlaceholder(t){const e=this.createElement("td",{colSpan:t});return e.style.border="none",e}renderTableCell(t){let e=this.renderContainer(t,"td");const n=this.currentCellPosition.col;return t.verticalMerge?t.verticalMerge=="restart"?(this.currentVerticalMerge[n]=e,e.rowSpan=1):this.currentVerticalMerge[n]&&(this.currentVerticalMerge[n].rowSpan+=1,e.style.display="none"):this.currentVerticalMerge[n]=null,this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e),t.span&&(e.colSpan=t.span),this.currentCellPosition.col+=e.colSpan,e}renderVmlPicture(t){return this.renderContainer(t,"div")}renderVmlElement(t){var e=this.createSvgElement("svg");e.setAttribute("style",t.cssStyleText);const n=this.renderVmlChildElement(t);return t.imageHref?.id&&this.tasks.push(this.document?.loadDocumentImage(t.imageHref.id,this.currentPart).then(i=>n.setAttribute("href",i))),e.appendChild(n),requestAnimationFrame(()=>{const i=e.firstElementChild.getBBox();e.setAttribute("width",`${Math.ceil(i.x+i.width)}`),e.setAttribute("height",`${Math.ceil(i.y+i.height)}`)}),e}renderVmlChildElement(t){const e=this.createSvgElement(t.tagName);Object.entries(t.attrs).forEach(([n,i])=>e.setAttribute(n,i));for(let n of t.children)n.type==T.VmlElement?e.appendChild(this.renderVmlChildElement(n)):e.appendChild(...ae(this.renderElement(n)));return e}renderMmlRadical(t){const e=t.children.find(i=>i.type==T.MmlBase);if(t.props?.hideDegree)return this.createElementNS(nt.mathML,"msqrt",null,this.renderElements([e]));const n=t.children.find(i=>i.type==T.MmlDegree);return this.createElementNS(nt.mathML,"mroot",null,this.renderElements([e,n]))}renderMmlDelimiter(t){const e=[];return e.push(this.createElementNS(nt.mathML,"mo",null,[t.props.beginChar??"("])),e.push(...this.renderElements(t.children)),e.push(this.createElementNS(nt.mathML,"mo",null,[t.props.endChar??")"])),this.createElementNS(nt.mathML,"mrow",null,e)}renderMmlNary(t){const e=[],n=Ot(t.children,h=>h.type),i=n[T.MmlSuperArgument],a=n[T.MmlSubArgument],s=i?this.createElementNS(nt.mathML,"mo",null,ae(this.renderElement(i))):null,o=a?this.createElementNS(nt.mathML,"mo",null,ae(this.renderElement(a))):null,l=this.createElementNS(nt.mathML,"mo",null,[t.props?.char??""]);return s||o?e.push(this.createElementNS(nt.mathML,"munderover",null,[l,o,s])):s?e.push(this.createElementNS(nt.mathML,"mover",null,[l,s])):o?e.push(this.createElementNS(nt.mathML,"munder",null,[l,o])):e.push(l),e.push(...this.renderElements(n[T.MmlBase].children)),this.createElementNS(nt.mathML,"mrow",null,e)}renderMmlPreSubSuper(t){const e=[],n=Ot(t.children,h=>h.type),i=n[T.MmlSuperArgument],a=n[T.MmlSubArgument],s=i?this.createElementNS(nt.mathML,"mo",null,ae(this.renderElement(i))):null,o=a?this.createElementNS(nt.mathML,"mo",null,ae(this.renderElement(a))):null,l=this.createElementNS(nt.mathML,"mo",null);return e.push(this.createElementNS(nt.mathML,"msubsup",null,[l,o,s])),e.push(...this.renderElements(n[T.MmlBase].children)),this.createElementNS(nt.mathML,"mrow",null,e)}renderMmlGroupChar(t){const e=t.props.verticalJustification==="bot"?"mover":"munder",n=this.renderContainerNS(t,nt.mathML,e);return t.props.char&&n.appendChild(this.createElementNS(nt.mathML,"mo",null,[t.props.char])),n}renderMmlBar(t){const e=this.renderContainerNS(t,nt.mathML,"mrow");switch(t.props.position){case"top":e.style.textDecoration="overline";break;case"bottom":e.style.textDecoration="underline";break}return e}renderMmlRun(t){const e=this.createElementNS(nt.mathML,"ms",null,this.renderElements(t.children));return this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e),e}renderMllList(t){const e=this.createElementNS(nt.mathML,"mtable");this.renderClass(t,e),this.renderStyleValues(t.cssStyle,e);for(let n of this.renderElements(t.children))e.appendChild(this.createElementNS(nt.mathML,"mtr",null,[this.createElementNS(nt.mathML,"mtd",null,[n])]));return e}renderStyleValues(t,e){for(let n in t)n.startsWith("$")?e.setAttribute(n.slice(1),t[n]):e.style[n]=t[n]}renderClass(t,e){t.className&&(e.className=t.className),t.styleName&&e.classList.add(this.processStyleName(t.styleName))}findStyle(t){return t&&this.styleMap?.[t]}numberingClass(t,e){return`${this.className}-num-${t}-${e}`}tabStopClass(){return`${this.className}-tab-stop`}styleToString(t,e,n=null){let i=`${t} {\r
`;for(const a in e)a.startsWith("$")||(i+=`  ${a}: ${e[a]};\r
`);return n&&(i+=n),i+`}\r
`}numberingCounter(t,e){return`${this.className}-num-${t}-${e}`}levelTextToContent(t,e,n,i){const a={tab:"\\9",space:"\\a0"};var s=t.replace(/%\d*/g,o=>{let l=parseInt(o.substring(1),10)-1;return`"counter(${this.numberingCounter(n,l)}, ${i})"`});return`"${s}${a[e]??""}"`}numFormatToCssValue(t){var e={none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman",decimalZero:"decimal-leading-zero",aiueo:"katakana",aiueoFullWidth:"katakana",chineseCounting:"simp-chinese-informal",chineseCountingThousand:"simp-chinese-informal",chineseLegalSimplified:"simp-chinese-formal",chosung:"hangul-consonant",ideographDigital:"cjk-ideographic",ideographTraditional:"cjk-heavenly-stem",ideographLegalTraditional:"trad-chinese-formal",ideographZodiac:"cjk-earthly-branch",iroha:"katakana-iroha",irohaFullWidth:"katakana-iroha",japaneseCounting:"japanese-informal",japaneseDigitalTenThousand:"cjk-decimal",japaneseLegal:"japanese-formal",thaiNumbers:"thai",koreanCounting:"korean-hangul-formal",koreanDigital:"korean-hangul-formal",koreanDigital2:"korean-hanja-informal",hebrew1:"hebrew",hebrew2:"hebrew",hindiNumbers:"devanagari",ganada:"hangul",taiwaneseCounting:"cjk-ideographic",taiwaneseCountingThousand:"cjk-ideographic",taiwaneseDigital:"cjk-decimal"};return e[t]??t}refreshTabStops(){this.options.experimental&&setTimeout(()=>{const t=vl();for(let e of this.currentTabs)yl(e.span,e.stops,this.defaultTabSize,t)},500)}createElementNS(t,e,n,i){var a=t?this.htmlDocument.createElementNS(t,e):this.htmlDocument.createElement(e);return Object.assign(a,n),i&&Je(a,i),a}createElement(t,e,n){return this.createElementNS(void 0,t,e,n)}createSvgElement(t,e,n){return this.createElementNS(nt.svg,t,e,n)}createStyleElement(t){return this.createElement("style",{innerHTML:t})}createComment(t){return this.htmlDocument.createComment(t)}later(t){this.postRenderTasks.push(t)}}function pn(r){r.innerHTML=""}function Je(r,t){t.forEach(e=>r.appendChild(so(e)?document.createTextNode(e):e))}function kl(r,t){for(var e=r.parent;e!=null&&e.type!=t;)e=e.parent;return e}const Li={ignoreHeight:!1,ignoreWidth:!1,ignoreFonts:!1,breakPages:!0,debug:!1,experimental:!1,className:"docx",inWrapper:!0,hideWrapperOnPrint:!1,trimXmlDeclaration:!0,ignoreLastRenderedPageBreak:!0,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0,useBase64URL:!1,renderChanges:!1,renderComments:!1,renderAltChunks:!0};function xl(r,t){const e={...Li,...t};return jr.load(r,new gl(e),e)}async function Sl(r,t,e,n){const i={...Li,...n};return await new wl(window.document).render(r,t,e,i)}async function El(r,t,e,n){const i=await xl(r,n);return await Sl(i,t,e,n),i}function Cl(r=[{note:"",name:""}]){return console.log(r),{rows:r,addRow(){this.rows.push({note:"",name:""})},removeRow(t){this.rows.splice(t,1)}}}function Pl(r){return{user:null,kode:null,errors:{},open:!1,signaturePad:null,isEmpty:!0,savedUrl:null,init(){this.$nextTick(()=>{const t=this.$refs.canvas;t.style.touchAction="none",this.signaturePad=new Be(t,{backgroundColor:"rgba(255,255,255,0)",penColor:"black"}),this.open&&this.$nextTick(()=>this.resizeCanvas(t)),window.addEventListener("resize",()=>this.resizeCanvas(t)),t.addEventListener("pointerup",()=>{this.isEmpty=this.signaturePad.isEmpty()}),this.$watch("open",e=>{e&&this.$nextTick(()=>{this.resizeCanvas(t)})})})},resizeCanvas(t){const e=Math.max(window.devicePixelRatio||1,1),n=t.getBoundingClientRect();if(!(n.width===0||n.height===0)&&(t.width=n.width*e,t.height=n.height*e,t.getContext("2d").scale(e,e),this.signaturePad)){const i=this.signaturePad.toData();this.signaturePad.clear(),this.signaturePad.fromData(i||[])}},clear(){this.signaturePad?.clear(),this.isEmpty=!0},undo(){if(!this.signaturePad)return;const t=this.signaturePad.toData();t.length&&(t.pop(),this.signaturePad.fromData(t),this.isEmpty=this.signaturePad.isEmpty())},close(){this.open=!1},async save(){if(this.errors={},!this.signaturePad||this.signaturePad.isEmpty()){alert("Tanda tangan kosong!");return}const t=this.signaturePad.toDataURL("image/png");try{const e=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),n=await fetch("/sign/"+r,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":e,Accept:"application/json"},body:JSON.stringify({data_url:t,kode:this.kode})}),i=await n.json();if(!n.ok)throw i;this.savedUrl=i.url,this.open=!1,alert("Tanda tangan tersimpan!"),window.location.reload()}catch(e){e.errors?this.errors=e.errors:(console.error(e),alert(e.message||"Gagal menyimpan tanda tangan."))}}}}function Al(r){return{isLoading:!0,init(){this.loadDoc()},async loadDoc(){try{const t=await fetch(r);if(!t.ok)throw new Error("Network response was not ok");const e=await t.blob(),n=this.$refs.docContainer;n.innerHTML="",await El(e,n,n,{className:"docx",inWrapper:!0,ignoreWidth:!1,ignoreHeight:!1,breakPages:!0,useBase64URL:!0,experimental:!0}),this.isLoading=!1}catch(t){console.error("Error loading document:",t),this.$refs.docContainer.innerHTML='<div class="text-red-500 p-4 text-center">Gagal memuat dokumen.</div>',this.isLoading=!1}}}}window.Alpine=pe;pe.data("userForm",Cl);pe.data("ttd",Pl);pe.data("docViewer",Al);pe.start();
